import{V as W,aU as Ar,v as yi,u as Or,M as Cr,l as Pr,D as gi,a_ as Tr,aj as ln,aK as bi,aL as Wn,c as cn,g as hn,aE as Si,m as Dr,bg as $r,d as Qe,bc as Ir,bh as jr,au as Nn,bi as kr,bj as Fr,x as mt,P as Rr,aZ as zr,B as Lr,aQ as Ur,a2 as Wr,a6 as Vn,ad as Bn}from"./index-85b64ddc.js";var et=Object.freeze({Linear:Object.freeze({None:function(t){return t},In:function(t){return this.None(t)},Out:function(t){return this.None(t)},InOut:function(t){return this.None(t)}}),Quadratic:Object.freeze({In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}}),Cubic:Object.freeze({In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}}),Quartic:Object.freeze({In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}}),Quintic:Object.freeze({In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}}),Sinusoidal:Object.freeze({In:function(t){return 1-Math.sin((1-t)*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return .5*(1-Math.sin(Math.PI*(.5-t)))}}),Exponential:Object.freeze({In:function(t){return t===0?0:Math.pow(1024,t-1)},Out:function(t){return t===1?1:1-Math.pow(2,-10*t)},InOut:function(t){return t===0?0:t===1?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}}),Circular:Object.freeze({In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}}),Elastic:Object.freeze({In:function(t){return t===0?0:t===1?1:-Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI)},Out:function(t){return t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t-.1)*5*Math.PI)+1},InOut:function(t){return t===0?0:t===1?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin((t-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(t){var e=1.70158;return t===1?1:t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return t===0?0:--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)}}),Bounce:Object.freeze({In:function(t){return 1-et.Bounce.Out(1-t)},Out:function(t){return t<.36363636363636365?7.5625*t*t:t<.7272727272727273?7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?7.5625*(t-=.8181818181818182)*t+.9375:7.5625*(t-=.9545454545454546)*t+.984375},InOut:function(t){return t<.5?et.Bounce.In(t*2)*.5:et.Bounce.Out(t*2-1)*.5+.5}}),generatePow:function(t){return t===void 0&&(t=4),t=t<Number.EPSILON?Number.EPSILON:t,t=t>1e4?1e4:t,{In:function(e){return Math.pow(e,t)},Out:function(e){return 1-Math.pow(1-e,t)},InOut:function(e){return e<.5?Math.pow(e*2,t)/2:(1-Math.pow(2-e*2,t))/2+.5}}}}),Je=function(){return performance.now()},Nr=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},t.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},t.prototype.update=function(e,n){e===void 0&&(e=Je()),n===void 0&&(n=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var l=this._tweens[i[r]],c=!n;l&&l.update(e,c)===!1&&!n&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),Re={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),l=Re.Utils.Linear;return e<0?l(t[0],t[1],i):e>1?l(t[n],t[n-1],n-i):l(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){for(var n=0,i=t.length-1,r=Math.pow,l=Re.Utils.Bernstein,c=0;c<=i;c++)n+=r(1-e,i-c)*r(e,c)*t[c]*l(i,c);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),l=Re.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(i=n*(1+e))),l(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):e<0?t[0]-(l(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(l(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):l(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=Re.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var i=e;i>1;i--)n*=i;return t[e]=n,n}}(),CatmullRom:function(t,e,n,i,r){var l=(n-t)*.5,c=(i-e)*.5,u=r*r,a=r*u;return(2*e-2*n+l+c)*a+(-3*e+3*n-2*l-c)*u+l*r+e}}},Vr=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),Xt=new Nr,la=function(){function t(e,n){n===void 0&&(n=Xt),this._object=e,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=et.Linear.None,this._interpolationFunction=Re.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Vr.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.getDuration=function(){return this._duration},t.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},t.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},t.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},t.prototype.start=function(e,n){if(e===void 0&&(e=Je()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var l in this._valuesEnd)r[l]=this._valuesEnd[l];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},t.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},t.prototype._setupProperties=function(e,n,i,r,l){for(var c in i){var u=e[c],a=Array.isArray(u),p=a?"array":typeof u,d=!a&&Array.isArray(i[c]);if(!(p==="undefined"||p==="function")){if(d){var v=i[c];if(v.length===0)continue;for(var b=[u],x=0,_=v.length;x<_;x+=1){var m=this._handleRelativeValue(u,v[x]);if(isNaN(m)){d=!1,console.warn("Found invalid interpolation list. Skipping.");break}b.push(m)}d&&(i[c]=b)}if((p==="object"||a)&&u&&!d){n[c]=a?[]:{};var g=u;for(var w in g)n[c][w]=g[w];r[c]=a?[]:{};var v=i[c];if(!this._isDynamic){var S={};for(var w in v)S[w]=v[w];i[c]=v=S}this._setupProperties(g,n[c],v,r[c],l)}else(typeof n[c]>"u"||l)&&(n[c]=u),a||(n[c]*=1),d?r[c]=i[c].slice().reverse():r[c]=n[c]||0}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(e){return e===void 0&&(e=Je()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},t.prototype.resume=function(e){return e===void 0&&(e=Je()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},t.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},t.prototype.group=function(e){return e===void 0&&(e=Xt),this._group=e,this},t.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},t.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},t.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},t.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},t.prototype.easing=function(e){return e===void 0&&(e=et.Linear.None),this._easingFunction=e,this},t.prototype.interpolation=function(e){return e===void 0&&(e=Re.Linear),this._interpolationFunction=e,this},t.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},t.prototype.onStart=function(e){return this._onStartCallback=e,this},t.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},t.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},t.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},t.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},t.prototype.onStop=function(e){return this._onStopCallback=e,this},t.prototype.update=function(e,n){var i=this,r;if(e===void 0&&(e=Je()),n===void 0&&(n=!0),this._isPaused)return!0;var l,c=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>c)return!1;n&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var u=e-this._startTime,a=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),p=this._duration+this._repeat*a,d=function(){if(i._duration===0||u>p)return 1;var g=Math.trunc(u/a),w=u-g*a,S=Math.min(w/i._duration,1);return S===0&&u===i._duration?1:S},v=d(),b=this._easingFunction(v);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,b),this._onUpdateCallback&&this._onUpdateCallback(this._object,v),this._duration===0||u>=this._duration)if(this._repeat>0){var x=Math.min(Math.trunc((u-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=x);for(l in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[l]=="string"&&(this._valuesStartRepeat[l]=this._valuesStartRepeat[l]+parseFloat(this._valuesEnd[l])),this._yoyo&&this._swapEndStartRepeatValues(l),this._valuesStart[l]=this._valuesStartRepeat[l];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*x,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var _=0,m=this._chainedTweens.length;_<m;_++)this._chainedTweens[_].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(e,n,i,r){for(var l in i)if(n[l]!==void 0){var c=n[l]||0,u=i[l],a=Array.isArray(e[l]),p=Array.isArray(u),d=!a&&p;d?e[l]=this._interpolationFunction(u,r):typeof u=="object"&&u?this._updateProperties(e[l],c,u,r):(u=this._handleRelativeValue(c,u),typeof u=="number"&&(e[l]=c+(u-c)*r))}},t.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},t.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},t}(),de=Xt;de.getAll.bind(de);de.removeAll.bind(de);de.add.bind(de);var ca=de.remove.bind(de);de.update.bind(de);function Br(t){return typeof Symbol>"u"?`$Symbol<${t}>$`:Symbol(t)}const tt=Br("$$EVENT$$");function vt(t){return t[tt]||(t[tt]={}),t[tt]}function Hr(t){t[tt]&&delete t[tt]}let un=class{hasListener(e){const n=vt(this);return!!(n!=null&&n[e]&&n[e].length>0)}on(e,n,i){const r=vt(this);return r[e]||(r[e]=[]),r[e].push([n,i||!1]),()=>this.off(e,n)}once(e,n){return this.on(e,n,!0)}off(e,n){if(e===void 0){Hr(this);return}const i=vt(this);if(i[e]||(i[e]=[]),n===void 0){i[e].length=0;return}let r=0;for(;r<i[e].length&&i[e][r][0]!==n;r++);r<i[e].length&&i[e].splice(r,1)}emit(e,...n){let i=!1;const r=vt(this)[e]||[];for(let l of r.slice()){const[c,u=!1]=l,a=c(...n);u&&this.off(e,c),a===!1&&(i=!0)}return i}};const Gr=({x:t,y:e,z:n})=>new W(t,e,n),qr=t=>new W().fromArray(t),ae=t=>{if(t)return t instanceof W?t:Array.isArray(t)?qr(t):Gr(t)};function ua(t){if(t)return Array.isArray(t)?typeof t[0]=="number"?ae(t):t.map(ae):ae(t)}function Vt(t,e,n){const{x:i,y:r,z:l}=e.clone().project(t);return l>1?void 0:{leftPx:(i+1)/2*n.x,topPx:(-r+1)/2*n.y}}function Ct(t){var e;return((e=t.models)==null?void 0:e.filter(n=>n.name===t.state.workCode)[0])||t.model}var Yr=Object.defineProperty,Xr=(t,e,n)=>e in t?Yr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Qr=(t,e,n)=>(Xr(t,typeof e!="symbol"?e+"":e,n),n);let wi=class extends un{constructor(e){super(),Qr(this,"five"),this.five=e}};const Hn=(t,e)=>{if(!e)return t;const n=new W,i=new Ar,r=new W;return e.decompose(n,i,r),t.clone().multiply(r).applyQuaternion(i).add(n)};var Zr=Object.defineProperty,Jr=(t,e,n)=>e in t?Zr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Kr=(t,e,n)=>(Jr(t,typeof e!="symbol"?e+"":e,n),n);const Bt=new Map;let es=class extends wi{constructor(e){super(e),Kr(this,"_workCode")}get fromType(){var e,n;const i=this.workCode;if(Bt.has(i))return Bt.get(i);const r=(n=(e=JSON.parse(this.work.raw.works[0]))==null?void 0:e.from_type)!=null?n:"vr";return Bt.set(i,r),r}set workCode(e){this._workCode=e}get workCode(){var e;return(e=this._workCode)!=null?e:this.five.state.workCode}get work(){var e,n;return(n=(e=this.five.works)==null?void 0:e.find(i=>i.workCode===this.workCode))!=null?n:this.five.work}get observers(){var e;return(e=this.work)==null?void 0:e.observers}get transform(){var e,n,i,r;const l=(r=(e=this.work)==null?void 0:e.transform)!=null?r:(i=(n=this.work)==null?void 0:n.options)==null?void 0:i.transform;return l?l.clone():new yi}getResolvedObserver(e){return this.five.works.getResolvedObserver({workCode:this.workCode,panoIndex:e})}getObserverPosition(e){var n;const i=(n=this.getObserver(e))==null?void 0:n.position;if(i)return Hn(i,this.transform)}getObserverStandingPosition(e){var n;const i=(n=this.getObserver(e))==null?void 0:n.standingPosition;if(i)return Hn(i,this.transform)}getObserver(e){var n;return(n=this.observers)==null?void 0:n[e]}};var ts=Object.defineProperty,ns=(t,e,n)=>e in t?ts(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,is=(t,e,n)=>(ns(t,typeof e!="symbol"?e+"":e,n),n);let rs=class extends wi{constructor(e){super(e),is(this,"workUtil",new es(this.five))}get version(){return this.five.constructor.version}get majorVersion(){return Number(this.version.split(".")[0])}get model(){return Ct(this.five)}moveToPano(e,n){const i=this.majorVersion===5?e:{workCode:this.workUtil.workCode,panoIndex:e};return this.five.moveToPano(i,n)}},ss=class extends Or{intersectObject(e,n=!0,i=[]){return Qt(e,this,i,n),i.sort(Gn),i}intersectObjects(e,n=!0,i=[]){for(let r=0,l=e.length;r<l;r++)Qt(e[r],this,i,n);return i.sort(Gn),i}};function Gn(t,e){return t.distance-e.distance}function Qt(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){const l=t.children;for(let c=0,u=l.length;c<u;c++)Qt(l[c],e,n,!0)}}function os(t,e,n,i){let r=!0;if(t.type!=="Line2"&&(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0)){const l=t.children;for(let c=0,u=l.length;c<u;c++)l[c].type!=="Line2"&&os(l[c],e,n,!0)}}const bt=new ss;bt.params.Points.threshold=.02;function as(t,e){if(!e||typeof ResizeObserver>"u"||!ResizeObserver)return{observe:()=>window.addEventListener("resize",t),unobserve:()=>window.removeEventListener("resize",t)};{const n=new ResizeObserver(t);return{observe:()=>n.observe(e),unobserve:()=>n.unobserve(e)}}}function ls(t,e=200){let n;return function(...i){n||(t(...i),n=setTimeout(function(){n=null},e))}}function cs(t,e){let n=!1;const i=ls(()=>{n||(n=!0,t.ready().then(()=>{e(),n=!1}))},150);return t.on("camera.update",i),()=>{t.off("camera.update",i)}}var qn={},hs={get exports(){return qn},set exports(t){qn=t}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,i,r){var l=["","webkit","Moz","MS","ms","o"],c=n.createElement("div"),u="function",a=Math.round,p=Math.abs,d=Date.now;function v(s,o,h){return setTimeout(M(s,h),o)}function b(s,o,h){return Array.isArray(s)?(x(s,h[o],h),!0):!1}function x(s,o,h){var f;if(s)if(s.forEach)s.forEach(o,h);else if(s.length!==r)for(f=0;f<s.length;)o.call(h,s[f],f,s),f++;else for(f in s)s.hasOwnProperty(f)&&o.call(h,s[f],f,s)}function _(s,o,h){var f="DEPRECATED METHOD: "+o+`
`+h+` AT 
`;return function(){var y=new Error("get-stack-trace"),O=y&&y.stack?y.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",D=e.console&&(e.console.warn||e.console.log);return D&&D.call(e.console,f,O),s.apply(this,arguments)}}var m;typeof Object.assign!="function"?m=function(s){if(s===r||s===null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(s),h=1;h<arguments.length;h++){var f=arguments[h];if(f!==r&&f!==null)for(var y in f)f.hasOwnProperty(y)&&(o[y]=f[y])}return o}:m=Object.assign;var g=_(function(s,o,h){for(var f=Object.keys(o),y=0;y<f.length;)(!h||h&&s[f[y]]===r)&&(s[f[y]]=o[f[y]]),y++;return s},"extend","Use `assign`."),w=_(function(s,o){return g(s,o,!0)},"merge","Use `assign`.");function S(s,o,h){var f=o.prototype,y;y=s.prototype=Object.create(f),y.constructor=s,y._super=f,h&&m(y,h)}function M(s,o){return function(){return s.apply(o,arguments)}}function P(s,o){return typeof s==u?s.apply(o&&o[0]||r,o):s}function $(s,o){return s===r?o:s}function C(s,o,h){x(T(o),function(f){s.addEventListener(f,h,!1)})}function j(s,o,h){x(T(o),function(f){s.removeEventListener(f,h,!1)})}function I(s,o){for(;s;){if(s==o)return!0;s=s.parentNode}return!1}function E(s,o){return s.indexOf(o)>-1}function T(s){return s.trim().split(/\s+/g)}function V(s,o,h){if(s.indexOf&&!h)return s.indexOf(o);for(var f=0;f<s.length;){if(h&&s[f][h]==o||!h&&s[f]===o)return f;f++}return-1}function B(s){return Array.prototype.slice.call(s,0)}function H(s,o,h){for(var f=[],y=[],O=0;O<s.length;){var D=o?s[O][o]:s[O];V(y,D)<0&&f.push(s[O]),y[O]=D,O++}return h&&(o?f=f.sort(function(R,te){return R[o]>te[o]}):f=f.sort()),f}function K(s,o){for(var h,f,y=o[0].toUpperCase()+o.slice(1),O=0;O<l.length;){if(h=l[O],f=h?h+y:o,f in s)return f;O++}return r}var ge=1;function $e(){return ge++}function pe(s){var o=s.ownerDocument||s;return o.defaultView||o.parentWindow||e}var xe=/mobile|tablet|ip(ad|hone|od)|android/i,be="ontouchstart"in e,it=K(e,"PointerEvent")!==r,rt=be&&xe.test(navigator.userAgent),Se="touch",Ae="pen",Ie="mouse",Ne="kinect",$t=25,G=1,Oe=2,z=4,q=8,st=1,Ve=2,Be=4,He=8,Ge=16,ie=Ve|Be,Ce=He|Ge,En=ie|Ce,_n=["x","y"],ot=["clientX","clientY"];function Z(s,o){var h=this;this.manager=s,this.callback=o,this.element=s.element,this.target=s.options.inputTarget,this.domHandler=function(f){P(s.options.enable,[s])&&h.handler(f)},this.init()}Z.prototype={handler:function(){},init:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(pe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&j(this.element,this.evEl,this.domHandler),this.evTarget&&j(this.target,this.evTarget,this.domHandler),this.evWin&&j(pe(this.element),this.evWin,this.domHandler)}};function Ki(s){var o,h=s.options.inputClass;return h?o=h:it?o=jt:rt?o=ct:be?o=kt:o=lt,new o(s,er)}function er(s,o,h){var f=h.pointers.length,y=h.changedPointers.length,O=o&G&&f-y===0,D=o&(z|q)&&f-y===0;h.isFirst=!!O,h.isFinal=!!D,O&&(s.session={}),h.eventType=o,tr(s,h),s.emit("hammer.input",h),s.recognize(h),s.session.prevInput=h}function tr(s,o){var h=s.session,f=o.pointers,y=f.length;h.firstInput||(h.firstInput=Mn(o)),y>1&&!h.firstMultiple?h.firstMultiple=Mn(o):y===1&&(h.firstMultiple=!1);var O=h.firstInput,D=h.firstMultiple,R=D?D.center:O.center,te=o.center=xn(f);o.timeStamp=d(),o.deltaTime=o.timeStamp-O.timeStamp,o.angle=It(R,te),o.distance=at(R,te),nr(h,o),o.offsetDirection=On(o.deltaX,o.deltaY);var X=An(o.deltaTime,o.deltaX,o.deltaY);o.overallVelocityX=X.x,o.overallVelocityY=X.y,o.overallVelocity=p(X.x)>p(X.y)?X.x:X.y,o.scale=D?sr(D.pointers,f):1,o.rotation=D?rr(D.pointers,f):0,o.maxPointers=h.prevInput?o.pointers.length>h.prevInput.maxPointers?o.pointers.length:h.prevInput.maxPointers:o.pointers.length,ir(h,o);var se=s.element;I(o.srcEvent.target,se)&&(se=o.srcEvent.target),o.target=se}function nr(s,o){var h=o.center,f=s.offsetDelta||{},y=s.prevDelta||{},O=s.prevInput||{};(o.eventType===G||O.eventType===z)&&(y=s.prevDelta={x:O.deltaX||0,y:O.deltaY||0},f=s.offsetDelta={x:h.x,y:h.y}),o.deltaX=y.x+(h.x-f.x),o.deltaY=y.y+(h.y-f.y)}function ir(s,o){var h=s.lastInterval||o,f=o.timeStamp-h.timeStamp,y,O,D,R;if(o.eventType!=q&&(f>$t||h.velocity===r)){var te=o.deltaX-h.deltaX,X=o.deltaY-h.deltaY,se=An(f,te,X);O=se.x,D=se.y,y=p(se.x)>p(se.y)?se.x:se.y,R=On(te,X),s.lastInterval=o}else y=h.velocity,O=h.velocityX,D=h.velocityY,R=h.direction;o.velocity=y,o.velocityX=O,o.velocityY=D,o.direction=R}function Mn(s){for(var o=[],h=0;h<s.pointers.length;)o[h]={clientX:a(s.pointers[h].clientX),clientY:a(s.pointers[h].clientY)},h++;return{timeStamp:d(),pointers:o,center:xn(o),deltaX:s.deltaX,deltaY:s.deltaY}}function xn(s){var o=s.length;if(o===1)return{x:a(s[0].clientX),y:a(s[0].clientY)};for(var h=0,f=0,y=0;y<o;)h+=s[y].clientX,f+=s[y].clientY,y++;return{x:a(h/o),y:a(f/o)}}function An(s,o,h){return{x:o/s||0,y:h/s||0}}function On(s,o){return s===o?st:p(s)>=p(o)?s<0?Ve:Be:o<0?He:Ge}function at(s,o,h){h||(h=_n);var f=o[h[0]]-s[h[0]],y=o[h[1]]-s[h[1]];return Math.sqrt(f*f+y*y)}function It(s,o,h){h||(h=_n);var f=o[h[0]]-s[h[0]],y=o[h[1]]-s[h[1]];return Math.atan2(y,f)*180/Math.PI}function rr(s,o){return It(o[1],o[0],ot)+It(s[1],s[0],ot)}function sr(s,o){return at(o[0],o[1],ot)/at(s[0],s[1],ot)}var or={mousedown:G,mousemove:Oe,mouseup:z},ar="mousedown",lr="mousemove mouseup";function lt(){this.evEl=ar,this.evWin=lr,this.pressed=!1,Z.apply(this,arguments)}S(lt,Z,{handler:function(s){var o=or[s.type];o&G&&s.button===0&&(this.pressed=!0),o&Oe&&s.which!==1&&(o=z),this.pressed&&(o&z&&(this.pressed=!1),this.callback(this.manager,o,{pointers:[s],changedPointers:[s],pointerType:Ie,srcEvent:s}))}});var cr={pointerdown:G,pointermove:Oe,pointerup:z,pointercancel:q,pointerout:q},hr={2:Se,3:Ae,4:Ie,5:Ne},Cn="pointerdown",Pn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Cn="MSPointerDown",Pn="MSPointerMove MSPointerUp MSPointerCancel");function jt(){this.evEl=Cn,this.evWin=Pn,Z.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}S(jt,Z,{handler:function(s){var o=this.store,h=!1,f=s.type.toLowerCase().replace("ms",""),y=cr[f],O=hr[s.pointerType]||s.pointerType,D=O==Se,R=V(o,s.pointerId,"pointerId");y&G&&(s.button===0||D)?R<0&&(o.push(s),R=o.length-1):y&(z|q)&&(h=!0),!(R<0)&&(o[R]=s,this.callback(this.manager,y,{pointers:o,changedPointers:[s],pointerType:O,srcEvent:s}),h&&o.splice(R,1))}});var ur={touchstart:G,touchmove:Oe,touchend:z,touchcancel:q},dr="touchstart",pr="touchstart touchmove touchend touchcancel";function Tn(){this.evTarget=dr,this.evWin=pr,this.started=!1,Z.apply(this,arguments)}S(Tn,Z,{handler:function(s){var o=ur[s.type];if(o===G&&(this.started=!0),!!this.started){var h=fr.call(this,s,o);o&(z|q)&&h[0].length-h[1].length===0&&(this.started=!1),this.callback(this.manager,o,{pointers:h[0],changedPointers:h[1],pointerType:Se,srcEvent:s})}}});function fr(s,o){var h=B(s.touches),f=B(s.changedTouches);return o&(z|q)&&(h=H(h.concat(f),"identifier",!0)),[h,f]}var mr={touchstart:G,touchmove:Oe,touchend:z,touchcancel:q},vr="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=vr,this.targetIds={},Z.apply(this,arguments)}S(ct,Z,{handler:function(s){var o=mr[s.type],h=yr.call(this,s,o);h&&this.callback(this.manager,o,{pointers:h[0],changedPointers:h[1],pointerType:Se,srcEvent:s})}});function yr(s,o){var h=B(s.touches),f=this.targetIds;if(o&(G|Oe)&&h.length===1)return f[h[0].identifier]=!0,[h,h];var y,O,D=B(s.changedTouches),R=[],te=this.target;if(O=h.filter(function(X){return I(X.target,te)}),o===G)for(y=0;y<O.length;)f[O[y].identifier]=!0,y++;for(y=0;y<D.length;)f[D[y].identifier]&&R.push(D[y]),o&(z|q)&&delete f[D[y].identifier],y++;if(R.length)return[H(O.concat(R),"identifier",!0),R]}var gr=2500,Dn=25;function kt(){Z.apply(this,arguments);var s=M(this.handler,this);this.touch=new ct(this.manager,s),this.mouse=new lt(this.manager,s),this.primaryTouch=null,this.lastTouches=[]}S(kt,Z,{handler:function(s,o,h){var f=h.pointerType==Se,y=h.pointerType==Ie;if(!(y&&h.sourceCapabilities&&h.sourceCapabilities.firesTouchEvents)){if(f)br.call(this,o,h);else if(y&&Sr.call(this,h))return;this.callback(s,o,h)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function br(s,o){s&G?(this.primaryTouch=o.changedPointers[0].identifier,$n.call(this,o)):s&(z|q)&&$n.call(this,o)}function $n(s){var o=s.changedPointers[0];if(o.identifier===this.primaryTouch){var h={x:o.clientX,y:o.clientY};this.lastTouches.push(h);var f=this.lastTouches,y=function(){var O=f.indexOf(h);O>-1&&f.splice(O,1)};setTimeout(y,gr)}}function Sr(s){for(var o=s.srcEvent.clientX,h=s.srcEvent.clientY,f=0;f<this.lastTouches.length;f++){var y=this.lastTouches[f],O=Math.abs(o-y.x),D=Math.abs(h-y.y);if(O<=Dn&&D<=Dn)return!0}return!1}var In=K(c.style,"touchAction"),jn=In!==r,kn="compute",Fn="auto",Ft="manipulation",Pe="none",qe="pan-x",Ye="pan-y",ht=Er();function Rt(s,o){this.manager=s,this.set(o)}Rt.prototype={set:function(s){s==kn&&(s=this.compute()),jn&&this.manager.element.style&&ht[s]&&(this.manager.element.style[In]=s),this.actions=s.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var s=[];return x(this.manager.recognizers,function(o){P(o.options.enable,[o])&&(s=s.concat(o.getTouchAction()))}),wr(s.join(" "))},preventDefaults:function(s){var o=s.srcEvent,h=s.offsetDirection;if(this.manager.session.prevented){o.preventDefault();return}var f=this.actions,y=E(f,Pe)&&!ht[Pe],O=E(f,Ye)&&!ht[Ye],D=E(f,qe)&&!ht[qe];if(y){var R=s.pointers.length===1,te=s.distance<2,X=s.deltaTime<250;if(R&&te&&X)return}if(!(D&&O)&&(y||O&&h&ie||D&&h&Ce))return this.preventSrc(o)},preventSrc:function(s){this.manager.session.prevented=!0,s.preventDefault()}};function wr(s){if(E(s,Pe))return Pe;var o=E(s,qe),h=E(s,Ye);return o&&h?Pe:o||h?o?qe:Ye:E(s,Ft)?Ft:Fn}function Er(){if(!jn)return!1;var s={},o=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(h){s[h]=o?e.CSS.supports("touch-action",h):!0}),s}var ut=1,J=2,je=4,we=8,fe=we,Xe=16,re=32;function me(s){this.options=m({},this.defaults,s||{}),this.id=$e(),this.manager=null,this.options.enable=$(this.options.enable,!0),this.state=ut,this.simultaneous={},this.requireFail=[]}me.prototype={defaults:{},set:function(s){return m(this.options,s),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(s){if(b(s,"recognizeWith",this))return this;var o=this.simultaneous;return s=dt(s,this),o[s.id]||(o[s.id]=s,s.recognizeWith(this)),this},dropRecognizeWith:function(s){return b(s,"dropRecognizeWith",this)?this:(s=dt(s,this),delete this.simultaneous[s.id],this)},requireFailure:function(s){if(b(s,"requireFailure",this))return this;var o=this.requireFail;return s=dt(s,this),V(o,s)===-1&&(o.push(s),s.requireFailure(this)),this},dropRequireFailure:function(s){if(b(s,"dropRequireFailure",this))return this;s=dt(s,this);var o=V(this.requireFail,s);return o>-1&&this.requireFail.splice(o,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(s){return!!this.simultaneous[s.id]},emit:function(s){var o=this,h=this.state;function f(y){o.manager.emit(y,s)}h<we&&f(o.options.event+Rn(h)),f(o.options.event),s.additionalEvent&&f(s.additionalEvent),h>=we&&f(o.options.event+Rn(h))},tryEmit:function(s){if(this.canEmit())return this.emit(s);this.state=re},canEmit:function(){for(var s=0;s<this.requireFail.length;){if(!(this.requireFail[s].state&(re|ut)))return!1;s++}return!0},recognize:function(s){var o=m({},s);if(!P(this.options.enable,[this,o])){this.reset(),this.state=re;return}this.state&(fe|Xe|re)&&(this.state=ut),this.state=this.process(o),this.state&(J|je|we|Xe)&&this.tryEmit(o)},process:function(s){},getTouchAction:function(){},reset:function(){}};function Rn(s){return s&Xe?"cancel":s&we?"end":s&je?"move":s&J?"start":""}function zn(s){return s==Ge?"down":s==He?"up":s==Ve?"left":s==Be?"right":""}function dt(s,o){var h=o.manager;return h?h.get(s):s}function ee(){me.apply(this,arguments)}S(ee,me,{defaults:{pointers:1},attrTest:function(s){var o=this.options.pointers;return o===0||s.pointers.length===o},process:function(s){var o=this.state,h=s.eventType,f=o&(J|je),y=this.attrTest(s);return f&&(h&q||!y)?o|Xe:f||y?h&z?o|we:o&J?o|je:J:re}});function pt(){ee.apply(this,arguments),this.pX=null,this.pY=null}S(pt,ee,{defaults:{event:"pan",threshold:10,pointers:1,direction:En},getTouchAction:function(){var s=this.options.direction,o=[];return s&ie&&o.push(Ye),s&Ce&&o.push(qe),o},directionTest:function(s){var o=this.options,h=!0,f=s.distance,y=s.direction,O=s.deltaX,D=s.deltaY;return y&o.direction||(o.direction&ie?(y=O===0?st:O<0?Ve:Be,h=O!=this.pX,f=Math.abs(s.deltaX)):(y=D===0?st:D<0?He:Ge,h=D!=this.pY,f=Math.abs(s.deltaY))),s.direction=y,h&&f>o.threshold&&y&o.direction},attrTest:function(s){return ee.prototype.attrTest.call(this,s)&&(this.state&J||!(this.state&J)&&this.directionTest(s))},emit:function(s){this.pX=s.deltaX,this.pY=s.deltaY;var o=zn(s.direction);o&&(s.additionalEvent=this.options.event+o),this._super.emit.call(this,s)}});function zt(){ee.apply(this,arguments)}S(zt,ee,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Pe]},attrTest:function(s){return this._super.attrTest.call(this,s)&&(Math.abs(s.scale-1)>this.options.threshold||this.state&J)},emit:function(s){if(s.scale!==1){var o=s.scale<1?"in":"out";s.additionalEvent=this.options.event+o}this._super.emit.call(this,s)}});function Lt(){me.apply(this,arguments),this._timer=null,this._input=null}S(Lt,me,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Fn]},process:function(s){var o=this.options,h=s.pointers.length===o.pointers,f=s.distance<o.threshold,y=s.deltaTime>o.time;if(this._input=s,!f||!h||s.eventType&(z|q)&&!y)this.reset();else if(s.eventType&G)this.reset(),this._timer=v(function(){this.state=fe,this.tryEmit()},o.time,this);else if(s.eventType&z)return fe;return re},reset:function(){clearTimeout(this._timer)},emit:function(s){this.state===fe&&(s&&s.eventType&z?this.manager.emit(this.options.event+"up",s):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}});function Ut(){ee.apply(this,arguments)}S(Ut,ee,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Pe]},attrTest:function(s){return this._super.attrTest.call(this,s)&&(Math.abs(s.rotation)>this.options.threshold||this.state&J)}});function Wt(){ee.apply(this,arguments)}S(Wt,ee,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ie|Ce,pointers:1},getTouchAction:function(){return pt.prototype.getTouchAction.call(this)},attrTest:function(s){var o=this.options.direction,h;return o&(ie|Ce)?h=s.overallVelocity:o&ie?h=s.overallVelocityX:o&Ce&&(h=s.overallVelocityY),this._super.attrTest.call(this,s)&&o&s.offsetDirection&&s.distance>this.options.threshold&&s.maxPointers==this.options.pointers&&p(h)>this.options.velocity&&s.eventType&z},emit:function(s){var o=zn(s.offsetDirection);o&&this.manager.emit(this.options.event+o,s),this.manager.emit(this.options.event,s)}});function ft(){me.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}S(ft,me,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ft]},process:function(s){var o=this.options,h=s.pointers.length===o.pointers,f=s.distance<o.threshold,y=s.deltaTime<o.time;if(this.reset(),s.eventType&G&&this.count===0)return this.failTimeout();if(f&&y&&h){if(s.eventType!=z)return this.failTimeout();var O=this.pTime?s.timeStamp-this.pTime<o.interval:!0,D=!this.pCenter||at(this.pCenter,s.center)<o.posThreshold;this.pTime=s.timeStamp,this.pCenter=s.center,!D||!O?this.count=1:this.count+=1,this._input=s;var R=this.count%o.taps;if(R===0)return this.hasRequireFailures()?(this._timer=v(function(){this.state=fe,this.tryEmit()},o.interval,this),J):fe}return re},failTimeout:function(){return this._timer=v(function(){this.state=re},this.options.interval,this),re},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==fe&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ve(s,o){return o=o||{},o.recognizers=$(o.recognizers,ve.defaults.preset),new Nt(s,o)}ve.VERSION="2.0.7",ve.defaults={domEvents:!1,touchAction:kn,enable:!0,inputTarget:null,inputClass:null,preset:[[Ut,{enable:!1}],[zt,{enable:!1},["rotate"]],[Wt,{direction:ie}],[pt,{direction:ie},["swipe"]],[ft],[ft,{event:"doubletap",taps:2},["tap"]],[Lt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var _r=1,Ln=2;function Nt(s,o){this.options=m({},ve.defaults,o||{}),this.options.inputTarget=this.options.inputTarget||s,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=s,this.input=Ki(this),this.touchAction=new Rt(this,this.options.touchAction),Un(this,!0),x(this.options.recognizers,function(h){var f=this.add(new h[0](h[1]));h[2]&&f.recognizeWith(h[2]),h[3]&&f.requireFailure(h[3])},this)}Nt.prototype={set:function(s){return m(this.options,s),s.touchAction&&this.touchAction.update(),s.inputTarget&&(this.input.destroy(),this.input.target=s.inputTarget,this.input.init()),this},stop:function(s){this.session.stopped=s?Ln:_r},recognize:function(s){var o=this.session;if(!o.stopped){this.touchAction.preventDefaults(s);var h,f=this.recognizers,y=o.curRecognizer;(!y||y&&y.state&fe)&&(y=o.curRecognizer=null);for(var O=0;O<f.length;)h=f[O],o.stopped!==Ln&&(!y||h==y||h.canRecognizeWith(y))?h.recognize(s):h.reset(),!y&&h.state&(J|je|we)&&(y=o.curRecognizer=h),O++}},get:function(s){if(s instanceof me)return s;for(var o=this.recognizers,h=0;h<o.length;h++)if(o[h].options.event==s)return o[h];return null},add:function(s){if(b(s,"add",this))return this;var o=this.get(s.options.event);return o&&this.remove(o),this.recognizers.push(s),s.manager=this,this.touchAction.update(),s},remove:function(s){if(b(s,"remove",this))return this;if(s=this.get(s),s){var o=this.recognizers,h=V(o,s);h!==-1&&(o.splice(h,1),this.touchAction.update())}return this},on:function(s,o){if(s!==r&&o!==r){var h=this.handlers;return x(T(s),function(f){h[f]=h[f]||[],h[f].push(o)}),this}},off:function(s,o){if(s!==r){var h=this.handlers;return x(T(s),function(f){o?h[f]&&h[f].splice(V(h[f],o),1):delete h[f]}),this}},emit:function(s,o){this.options.domEvents&&Mr(s,o);var h=this.handlers[s]&&this.handlers[s].slice();if(!(!h||!h.length)){o.type=s,o.preventDefault=function(){o.srcEvent.preventDefault()};for(var f=0;f<h.length;)h[f](o),f++}},destroy:function(){this.element&&Un(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Un(s,o){var h=s.element;if(h.style){var f;x(s.options.cssProps,function(y,O){f=K(h.style,O),o?(s.oldCssProps[f]=h.style[f],h.style[f]=y):h.style[f]=s.oldCssProps[f]||""}),o||(s.oldCssProps={})}}function Mr(s,o){var h=n.createEvent("Event");h.initEvent(s,!0,!0),h.gesture=o,o.target.dispatchEvent(h)}m(ve,{INPUT_START:G,INPUT_MOVE:Oe,INPUT_END:z,INPUT_CANCEL:q,STATE_POSSIBLE:ut,STATE_BEGAN:J,STATE_CHANGED:je,STATE_ENDED:we,STATE_RECOGNIZED:fe,STATE_CANCELLED:Xe,STATE_FAILED:re,DIRECTION_NONE:st,DIRECTION_LEFT:Ve,DIRECTION_RIGHT:Be,DIRECTION_UP:He,DIRECTION_DOWN:Ge,DIRECTION_HORIZONTAL:ie,DIRECTION_VERTICAL:Ce,DIRECTION_ALL:En,Manager:Nt,Input:Z,TouchAction:Rt,TouchInput:ct,MouseInput:lt,PointerEventInput:jt,TouchMouseInput:kt,SingleTouchInput:Tn,Recognizer:me,AttrRecognizer:ee,Tap:ft,Pan:pt,Swipe:Wt,Pinch:zt,Rotate:Ut,Press:Lt,on:C,off:j,each:x,merge:w,extend:g,assign:m,inherit:S,bindFn:M,prefixed:K});var xr=typeof e<"u"?e:typeof self<"u"?self:{};xr.Hammer=ve,typeof r=="function"&&r.amd?r(function(){return ve}):t.exports?t.exports=ve:e[i]=ve})(window,document,"Hammer")})(hs);function wt(t,e){const n=Math.round(t);return n%2===0?n:n+(e!=null&&e.floor?-1:1)}var us=Object.defineProperty,ds=(t,e,n)=>e in t?us(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ps=(t,e,n)=>(ds(t,typeof e!="symbol"?e+"":e,n),n);class fs extends Cr{constructor(e,n){const i=new Pr({opacity:0,color:0,transparent:!1,side:gi}),r=new Tr(e,n);super(r,i),ps(this,"name","opacity-mesh")}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}}function Zt(...t){const e=new W;return t.forEach(n=>e.add(n)),e.divideScalar(t.length),e}const Ei=t=>t?t.visible===!1?!1:Ei(t.parent):!0;var Me=function(t){ln.call(this),this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof Element&&e.element.parentNode!==null&&e.element.remove()})})};Me.prototype=Object.create(ln.prototype);Me.prototype.constructor=Me;var Jt=function(t){Me.call(this,t)};Jt.prototype=Object.create(Me.prototype);Jt.prototype.constructor=Jt;let ms=function(t){let e=this,n,i,r,l,c=new yi,u={camera:{fov:0,style:""},objects:new Map},a=document.createElement("div");a.style.overflow="hidden",this.domElement=a;let p=document.createElement("div");p.style.WebkitTransformStyle="preserve-3d",p.style.transformStyle="preserve-3d",p.style.pointerEvents="none",a.appendChild(p),this.getSize=function(){return{width:n,height:i}},this.setSize=function(m,g){n=m,i=g,r=n/2,l=i/2,a.style.width=m+"px",a.style.height=g+"px",p.style.width=m+"px",p.style.height=g+"px"};function d(m){return Math.abs(m)<1e-10?0:m}function v(m){let g=m.elements;return"matrix3d("+d(g[0])+","+d(-g[1])+","+d(g[2])+","+d(g[3])+","+d(g[4])+","+d(-g[5])+","+d(g[6])+","+d(g[7])+","+d(g[8])+","+d(-g[9])+","+d(g[10])+","+d(g[11])+","+d(g[12])+","+d(-g[13])+","+d(g[14])+","+d(g[15])+")"}function b(m,g){let w=m.elements;return"translate(-50%,-50%)"+("matrix3d("+d(w[0])+","+d(w[1])+","+d(w[2])+","+d(w[3])+","+d(-w[4])+","+d(-w[5])+","+d(-w[6])+","+d(-w[7])+","+d(w[8])+","+d(w[9])+","+d(w[10])+","+d(w[11])+","+d(w[12])+","+d(w[13])+","+d(w[14])+","+d(w[15])+")")}function x(m){var g;if(m.isCSS3DObject){const w=(g=m.mode)!=null?g:"front";(!t||w===t)&&(m.element.style.display="none")}for(let w=0,S=m.children.length;w<S;w++)x(m.children[w])}function _(m,g,w,S,M){var P;if(m.visible===!1){x(m);return}if(m.isCSS3DObject){const $=(P=m.mode)!=null?P:"front";if(t&&$!==t)return;m.flag=M;const C=m.layers.test(w.layers)===!0,j=m.element;if(j.style.display=C===!0?"":"none",C){m.onBeforeRender(e,g,w);let I;m.isCSS3DSprite?(c.copy(w.matrixWorldInverse),c.transpose(),c.copyPosition(m.matrixWorld),c.scale(m.scale),c.elements[3]=0,c.elements[7]=0,c.elements[11]=0,c.elements[15]=1,I=b(c)):I=b(m.matrixWorld);let E=u.objects.get(m);if(E===void 0||E.style!==I){j.style.WebkitTransform=I,j.style.transform=I;let T={style:I};u.objects.set(m,T)}j.style.display=m.visible?"":"none",j.parentNode!==p&&p.appendChild(j),m.onAfterRender(e,g,w)}}for(let $=0,C=m.children.length;$<C;$++)_(m.children[$],g,w,S,M)}this.render=function(m,g){let w=g.projectionMatrix.elements[5]*l;if(u.camera.fov!==w&&(g.isPerspectiveCamera?(a.style.WebkitPerspective=w+"px",a.style.perspective=w+"px"):(a.style.WebkitPerspective="",a.style.perspective=""),u.camera.fov=w),m.autoUpdate===!0&&m.updateMatrixWorld(),g.parent===null&&g.updateMatrixWorld(),g.isOrthographicCamera)var S=-(g.right+g.left)/2,M=(g.top+g.bottom)/2;let P=g.isOrthographicCamera?"scale("+w+")translate("+d(S)+"px,"+d(M)+"px)"+v(g.matrixWorldInverse):"translateZ("+w+"px)"+v(g.matrixWorldInverse),$=P+"translate("+r+"px,"+l+"px)";u.camera.style!==$&&(p.style.WebkitTransform=$,p.style.transform=$,u.camera.style=$);const C=m.uuid+"_"+performance.now().toString();_(m,m,g,P,C),u.objects.forEach(function(j,I){I.flag!==C&&(I.element.remove(),u.objects.delete(I))})}};const ue=document.createElement("div");ue.classList.add("behindFiveElement");ue.style.position="absolute";ue.style.top="0";ue.style.left="0";ue.style.width="100%";ue.style.height="100%";ue.style.pointerEvents="none";function va(t){var e,n,i,r,l;const c=(l=(n=Ht(t.getElement()))!=null?n:Ht((e=t.getElement())==null?void 0:e.parentElement))!=null?l:Ht((r=(i=t.getElement())==null?void 0:i.parentElement)==null?void 0:r.parentElement),u=c==null?void 0:c.parentElement;if(u)return u.contains(ue)||c.parentElement.insertBefore(ue,c),ue;console.error("Can not find a valid element to insert behindFiveElement. How to fix it: https://github.com/realsee-developer/dnalogel/tree/main/plugins/src/CSS3DRenderPlugin/README.md")}function Ht(t){var e;if(!t)return;const n=(e=t.style.position)!=null?e:getComputedStyle(t).position;if(n!=="fixed"&&n!=="absolute"&&n!=="relative")return;const i=getComputedStyle(t),r=i.backgroundColor,l=i.backgroundImage;if(!(r!=="transparent"&&r!=="rgba(0, 0, 0, 0)"&&r!==""||l!=="none"&&l!==""))return t}function Yn(t){return!Y(t)}function Y(t){return t!=null}var vs=Object.defineProperty,ys=(t,e,n)=>e in t?vs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ke=(t,e,n)=>(ys(t,typeof e!="symbol"?e+"":e,n),n);const Gt={uniforms:bi.merge([Wn.common,Wn.fog,{linewidth:{value:1},resolution:{value:new cn(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1},opacity:{value:1}}]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		varying vec2 vUv;

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;

			#endif

			float aspect = resolution.x / resolution.y;

			vUv = uv;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec2 ndcStart = clipStart.xy / clipStart.w;
			vec2 ndcEnd = clipEnd.xy / clipEnd.w;

			// direction
			vec2 dir = ndcEnd - ndcStart;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			// perpendicular to dir
			vec2 offset = vec2( dir.y, - dir.x );

			// undo aspect ratio adjustment
			dir.x /= aspect;
			offset.x /= aspect;

			// sign flip
			if ( position.x < 0.0 ) offset *= - 1.0;

			// endcaps
			if ( position.y < 0.0 ) {

				offset += - dir;

			} else if ( position.y > 1.0 ) {

				offset += dir;

			}

			// adjust for linewidth
			offset *= linewidth;

			// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
			offset /= resolution.y;

			// select end
			vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

			// back to clip space
			offset *= clip.w;

			clip.xy += offset;

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;

		#ifdef USE_DASH

			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		varying vec2 vUv;

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance, dashSize + gapSize ) < dashSize ) discard; // todo - FIX

			#endif

			if ( abs( vUv.y ) > 1.0 ) {

				float a = vUv.x;
				float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
				float len2 = a * a + b * b;

				if ( len2 > 1.0 ) discard;

			}

			vec4 diffuseColor = vec4( diffuse, opacity );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );

			#include <tonemapping_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};let _i=class extends hn{constructor(e){super({uniforms:bi.clone(Gt.uniforms),vertexShader:Gt.vertexShader,fragmentShader:Gt.fragmentShader,clipping:!0}),ke(this,"color"),ke(this,"dashed"),ke(this,"dashScale"),ke(this,"dashSize"),ke(this,"gapSize"),ke(this,"resolution"),this.type="LineMaterial",this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get(){return this.uniforms.diffuse.value},set(n){this.uniforms.diffuse.value=n}},linewidth:{enumerable:!0,get(){return this.uniforms.linewidth.value},set(n){this.uniforms.linewidth.value=n}},dashScale:{enumerable:!0,get(){return this.uniforms.dashScale.value},set(n){this.uniforms.dashScale.value=n}},dashSize:{enumerable:!0,get(){return this.uniforms.dashSize.value},set(n){this.uniforms.dashSize.value=n}},gapSize:{enumerable:!0,get(){return this.uniforms.gapSize.value},set(n){this.uniforms.gapSize.value=n}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(n){this.uniforms.opacity.value=n}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(n){this.uniforms.resolution.value.copy(n)}}}),this.setValues(e)}};Object.assign(_i.prototype,{isLineMaterial:!0});var Mi={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},dn={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},gs=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Et={CSS:{},springs:{}};function le(t,e,n){return Math.min(Math.max(t,e),n)}function nt(t,e){return t.indexOf(e)>-1}function qt(t,e){return t.apply(null,e)}var A={arr:function(t){return Array.isArray(t)},obj:function(t){return nt(Object.prototype.toString.call(t),"Object")},pth:function(t){return A.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return t.nodeType||A.svg(t)},str:function(t){return typeof t=="string"},fnc:function(t){return typeof t=="function"},und:function(t){return typeof t>"u"},nil:function(t){return A.und(t)||t===null},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return A.hex(t)||A.rgb(t)||A.hsl(t)},key:function(t){return!Mi.hasOwnProperty(t)&&!dn.hasOwnProperty(t)&&t!=="targets"&&t!=="keyframes"}};function xi(t){var e=/\(([^)]+)\)/.exec(t);return e?e[1].split(",").map(function(n){return parseFloat(n)}):[]}function Ai(t,e){var n=xi(t),i=le(A.und(n[0])?1:n[0],.1,100),r=le(A.und(n[1])?100:n[1],.1,100),l=le(A.und(n[2])?10:n[2],.1,100),c=le(A.und(n[3])?0:n[3],.1,100),u=Math.sqrt(r/i),a=l/(2*Math.sqrt(r*i)),p=a<1?u*Math.sqrt(1-a*a):0,d=1,v=a<1?(a*u+-c)/p:-c+u;function b(_){var m=e?e*_/1e3:_;return a<1?m=Math.exp(-m*a*u)*(d*Math.cos(p*m)+v*Math.sin(p*m)):m=(d+v*m)*Math.exp(-m*u),_===0||_===1?_:1-m}function x(){var _=Et.springs[t];if(_)return _;for(var m=1/6,g=0,w=0;;)if(g+=m,b(g)===1){if(w++,w>=16)break}else w=0;var S=g*m*1e3;return Et.springs[t]=S,S}return e?b:x}function bs(t){return t===void 0&&(t=10),function(e){return Math.ceil(le(e,1e-6,1)*t)*(1/t)}}var Ss=function(){var t=11,e=1/(t-1);function n(d,v){return 1-3*v+3*d}function i(d,v){return 3*v-6*d}function r(d){return 3*d}function l(d,v,b){return((n(v,b)*d+i(v,b))*d+r(v))*d}function c(d,v,b){return 3*n(v,b)*d*d+2*i(v,b)*d+r(v)}function u(d,v,b,x,_){var m,g,w=0;do g=v+(b-v)/2,m=l(g,x,_)-d,m>0?b=g:v=g;while(Math.abs(m)>1e-7&&++w<10);return g}function a(d,v,b,x){for(var _=0;_<4;++_){var m=c(v,b,x);if(m===0)return v;var g=l(v,b,x)-d;v-=g/m}return v}function p(d,v,b,x){if(!(0<=d&&d<=1&&0<=b&&b<=1))return;var _=new Float32Array(t);if(d!==v||b!==x)for(var m=0;m<t;++m)_[m]=l(m*e,d,b);function g(w){for(var S=0,M=1,P=t-1;M!==P&&_[M]<=w;++M)S+=e;--M;var $=(w-_[M])/(_[M+1]-_[M]),C=S+$*e,j=c(C,d,b);return j>=.001?a(w,C,d,b):j===0?C:u(w,S,S+e,d,b)}return function(w){return d===v&&b===x||w===0||w===1?w:l(g(w),v,x)}}return p}(),Oi=function(){var t={linear:function(){return function(i){return i}}},e={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Expo:function(){return function(i){return i?Math.pow(2,10*i-10):0}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var r,l=4;i<((r=Math.pow(2,--l))-1)/11;);return 1/Math.pow(4,3-l)-7.5625*Math.pow((r*3-2)/22-i,2)}},Elastic:function(i,r){i===void 0&&(i=1),r===void 0&&(r=.5);var l=le(i,1,10),c=le(r,.1,2);return function(u){return u===0||u===1?u:-l*Math.pow(2,10*(u-1))*Math.sin((u-1-c/(Math.PI*2)*Math.asin(1/l))*(Math.PI*2)/c)}}},n=["Quad","Cubic","Quart","Quint"];return n.forEach(function(i,r){e[i]=function(){return function(l){return Math.pow(l,r+2)}}}),Object.keys(e).forEach(function(i){var r=e[i];t["easeIn"+i]=r,t["easeOut"+i]=function(l,c){return function(u){return 1-r(l,c)(1-u)}},t["easeInOut"+i]=function(l,c){return function(u){return u<.5?r(l,c)(u*2)/2:1-r(l,c)(u*-2+2)/2}},t["easeOutIn"+i]=function(l,c){return function(u){return u<.5?(1-r(l,c)(1-u*2))/2:(r(l,c)(u*2-1)+1)/2}}}),t}();function pn(t,e){if(A.fnc(t))return t;var n=t.split("(")[0],i=Oi[n],r=xi(t);switch(n){case"spring":return Ai(t,e);case"cubicBezier":return qt(Ss,r);case"steps":return qt(bs,r);default:return qt(i,r)}}function Ci(t){try{var e=document.querySelectorAll(t);return e}catch{return}}function Pt(t,e){for(var n=t.length,i=arguments.length>=2?arguments[1]:void 0,r=[],l=0;l<n;l++)if(l in t){var c=t[l];e.call(i,c,l,t)&&r.push(c)}return r}function Tt(t){return t.reduce(function(e,n){return e.concat(A.arr(n)?Tt(n):n)},[])}function Xn(t){return A.arr(t)?t:(A.str(t)&&(t=Ci(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function fn(t,e){return t.some(function(n){return n===e})}function mn(t){var e={};for(var n in t)e[n]=t[n];return e}function Kt(t,e){var n=mn(t);for(var i in t)n[i]=e.hasOwnProperty(i)?e[i]:t[i];return n}function Dt(t,e){var n=mn(t);for(var i in e)n[i]=A.und(t[i])?e[i]:t[i];return n}function ws(t){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t);return e?"rgba("+e[1]+",1)":t}function Es(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=t.replace(e,function(u,a,p,d){return a+a+p+p+d+d}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n),r=parseInt(i[1],16),l=parseInt(i[2],16),c=parseInt(i[3],16);return"rgba("+r+","+l+","+c+",1)"}function _s(t){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),n=parseInt(e[1],10)/360,i=parseInt(e[2],10)/100,r=parseInt(e[3],10)/100,l=e[4]||1;function c(b,x,_){return _<0&&(_+=1),_>1&&(_-=1),_<1/6?b+(x-b)*6*_:_<1/2?x:_<2/3?b+(x-b)*(2/3-_)*6:b}var u,a,p;if(i==0)u=a=p=r;else{var d=r<.5?r*(1+i):r+i-r*i,v=2*r-d;u=c(v,d,n+1/3),a=c(v,d,n),p=c(v,d,n-1/3)}return"rgba("+u*255+","+a*255+","+p*255+","+l+")"}function Ms(t){if(A.rgb(t))return ws(t);if(A.hex(t))return Es(t);if(A.hsl(t))return _s(t)}function ye(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function xs(t){if(nt(t,"translate")||t==="perspective")return"px";if(nt(t,"rotate")||nt(t,"skew"))return"deg"}function en(t,e){return A.fnc(t)?t(e.target,e.id,e.total):t}function ce(t,e){return t.getAttribute(e)}function vn(t,e,n){var i=ye(e);if(fn([n,"deg","rad","turn"],i))return e;var r=Et.CSS[e+n];if(!A.und(r))return r;var l=100,c=document.createElement(t.tagName),u=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;u.appendChild(c),c.style.position="absolute",c.style.width=l+n;var a=l/c.offsetWidth;u.removeChild(c);var p=a*parseFloat(e);return Et.CSS[e+n]=p,p}function Pi(t,e,n){if(e in t.style){var i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=t.style[e]||getComputedStyle(t).getPropertyValue(i)||"0";return n?vn(t,r,n):r}}function yn(t,e){if(A.dom(t)&&!A.inp(t)&&(!A.nil(ce(t,e))||A.svg(t)&&t[e]))return"attribute";if(A.dom(t)&&fn(gs,e))return"transform";if(A.dom(t)&&e!=="transform"&&Pi(t,e))return"css";if(t[e]!=null)return"object"}function Ti(t){if(A.dom(t)){for(var e=t.style.transform||"",n=/(\w+)\(([^)]*)\)/g,i=new Map,r;r=n.exec(e);)i.set(r[1],r[2]);return i}}function As(t,e,n,i){var r=nt(e,"scale")?1:0+xs(e),l=Ti(t).get(e)||r;return n&&(n.transforms.list.set(e,l),n.transforms.last=e),i?vn(t,l,i):l}function gn(t,e,n,i){switch(yn(t,e)){case"transform":return As(t,e,i,n);case"css":return Pi(t,e,n);case"attribute":return ce(t,e);default:return t[e]||0}}function bn(t,e){var n=/^(\*=|\+=|-=)/.exec(t);if(!n)return t;var i=ye(t)||0,r=parseFloat(e),l=parseFloat(t.replace(n[0],""));switch(n[0][0]){case"+":return r+l+i;case"-":return r-l+i;case"*":return r*l+i}}function Di(t,e){if(A.col(t))return Ms(t);if(/\s/g.test(t))return t;var n=ye(t),i=n?t.substr(0,t.length-n.length):t;return e?i+e:i}function Sn(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Os(t){return Math.PI*2*ce(t,"r")}function Cs(t){return ce(t,"width")*2+ce(t,"height")*2}function Ps(t){return Sn({x:ce(t,"x1"),y:ce(t,"y1")},{x:ce(t,"x2"),y:ce(t,"y2")})}function $i(t){for(var e=t.points,n=0,i,r=0;r<e.numberOfItems;r++){var l=e.getItem(r);r>0&&(n+=Sn(i,l)),i=l}return n}function Ts(t){var e=t.points;return $i(t)+Sn(e.getItem(e.numberOfItems-1),e.getItem(0))}function Ii(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return Os(t);case"rect":return Cs(t);case"line":return Ps(t);case"polyline":return $i(t);case"polygon":return Ts(t)}}function Ds(t){var e=Ii(t);return t.setAttribute("stroke-dasharray",e),e}function $s(t){for(var e=t.parentNode;A.svg(e)&&A.svg(e.parentNode);)e=e.parentNode;return e}function ji(t,e){var n=e||{},i=n.el||$s(t),r=i.getBoundingClientRect(),l=ce(i,"viewBox"),c=r.width,u=r.height,a=n.viewBox||(l?l.split(" "):[0,0,c,u]);return{el:i,viewBox:a,x:a[0]/1,y:a[1]/1,w:c,h:u,vW:a[2],vH:a[3]}}function Is(t,e){var n=A.str(t)?Ci(t)[0]:t,i=e||100;return function(r){return{property:r,el:n,svg:ji(n),totalLength:Ii(n)*(i/100)}}}function js(t,e,n){function i(d){d===void 0&&(d=0);var v=e+d>=1?e+d:0;return t.el.getPointAtLength(v)}var r=ji(t.el,t.svg),l=i(),c=i(-1),u=i(1),a=n?1:r.w/r.vW,p=n?1:r.h/r.vH;switch(t.property){case"x":return(l.x-r.x)*a;case"y":return(l.y-r.y)*p;case"angle":return Math.atan2(u.y-c.y,u.x-c.x)*180/Math.PI}}function Qn(t,e){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=Di(A.pth(t)?t.totalLength:t,e)+"";return{original:i,numbers:i.match(n)?i.match(n).map(Number):[0],strings:A.str(t)||e?i.split(n):[]}}function wn(t){var e=t?Tt(A.arr(t)?t.map(Xn):Xn(t)):[];return Pt(e,function(n,i,r){return r.indexOf(n)===i})}function ki(t){var e=wn(t);return e.map(function(n,i){return{target:n,id:i,total:e.length,transforms:{list:Ti(n)}}})}function ks(t,e){var n=mn(e);if(/^spring/.test(n.easing)&&(n.duration=Ai(n.easing)),A.arr(t)){var i=t.length,r=i===2&&!A.obj(t[0]);r?t={value:t}:A.fnc(e.duration)||(n.duration=e.duration/i)}var l=A.arr(t)?t:[t];return l.map(function(c,u){var a=A.obj(c)&&!A.pth(c)?c:{value:c};return A.und(a.delay)&&(a.delay=u?0:e.delay),A.und(a.endDelay)&&(a.endDelay=u===l.length-1?e.endDelay:0),a}).map(function(c){return Dt(c,n)})}function Fs(t){for(var e=Pt(Tt(t.map(function(l){return Object.keys(l)})),function(l){return A.key(l)}).reduce(function(l,c){return l.indexOf(c)<0&&l.push(c),l},[]),n={},i=function(l){var c=e[l];n[c]=t.map(function(u){var a={};for(var p in u)A.key(p)?p==c&&(a.value=u[p]):a[p]=u[p];return a})},r=0;r<e.length;r++)i(r);return n}function Rs(t,e){var n=[],i=e.keyframes;i&&(e=Dt(Fs(i),e));for(var r in e)A.key(r)&&n.push({name:r,tweens:ks(e[r],t)});return n}function zs(t,e){var n={};for(var i in t){var r=en(t[i],e);A.arr(r)&&(r=r.map(function(l){return en(l,e)}),r.length===1&&(r=r[0])),n[i]=r}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}function Ls(t,e){var n;return t.tweens.map(function(i){var r=zs(i,e),l=r.value,c=A.arr(l)?l[1]:l,u=ye(c),a=gn(e.target,t.name,u,e),p=n?n.to.original:a,d=A.arr(l)?l[0]:p,v=ye(d)||ye(a),b=u||v;return A.und(c)&&(c=p),r.from=Qn(d,b),r.to=Qn(bn(c,d),b),r.start=n?n.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=pn(r.easing,r.duration),r.isPath=A.pth(l),r.isPathTargetInsideSVG=r.isPath&&A.svg(e.target),r.isColor=A.col(r.from.original),r.isColor&&(r.round=1),n=r,r})}var Fi={css:function(t,e,n){return t.style[e]=n},attribute:function(t,e,n){return t.setAttribute(e,n)},object:function(t,e,n){return t[e]=n},transform:function(t,e,n,i,r){if(i.list.set(e,n),e===i.last||r){var l="";i.list.forEach(function(c,u){l+=u+"("+c+") "}),t.style.transform=l}}};function Ri(t,e){var n=ki(t);n.forEach(function(i){for(var r in e){var l=en(e[r],i),c=i.target,u=ye(l),a=gn(c,r,u,i),p=u||ye(a),d=bn(Di(l,p),a),v=yn(c,r);Fi[v](c,r,d,i.transforms,!0)}})}function Us(t,e){var n=yn(t.target,e.name);if(n){var i=Ls(e,t),r=i[i.length-1];return{type:n,property:e.name,animatable:t,tweens:i,duration:r.end,delay:i[0].delay,endDelay:r.endDelay}}}function Ws(t,e){return Pt(Tt(t.map(function(n){return e.map(function(i){return Us(n,i)})})),function(n){return!A.und(n)})}function zi(t,e){var n=t.length,i=function(l){return l.timelineOffset?l.timelineOffset:0},r={};return r.duration=n?Math.max.apply(Math,t.map(function(l){return i(l)+l.duration})):e.duration,r.delay=n?Math.min.apply(Math,t.map(function(l){return i(l)+l.delay})):e.delay,r.endDelay=n?r.duration-Math.max.apply(Math,t.map(function(l){return i(l)+l.duration-l.endDelay})):e.endDelay,r}var Zn=0;function Ns(t){var e=Kt(Mi,t),n=Kt(dn,t),i=Rs(n,t),r=ki(t.targets),l=Ws(r,i),c=zi(l,n),u=Zn;return Zn++,Dt(e,{id:u,children:[],animatables:r,animations:l,duration:c.duration,delay:c.delay,endDelay:c.endDelay})}var ne=[],Li=function(){var t;function e(){!t&&(!Jn()||!F.suspendWhenDocumentHidden)&&ne.length>0&&(t=requestAnimationFrame(n))}function n(r){for(var l=ne.length,c=0;c<l;){var u=ne[c];u.paused?(ne.splice(c,1),l--):(u.tick(r),c++)}t=c>0?requestAnimationFrame(n):void 0}function i(){F.suspendWhenDocumentHidden&&(Jn()?t=cancelAnimationFrame(t):(ne.forEach(function(r){return r._onDocumentVisibility()}),Li()))}return typeof document<"u"&&document.addEventListener("visibilitychange",i),e}();function Jn(){return!!document&&document.hidden}function F(t){t===void 0&&(t={});var e=0,n=0,i=0,r,l=0,c=null;function u(S){var M=window.Promise&&new Promise(function(P){return c=P});return S.finished=M,M}var a=Ns(t);u(a);function p(){var S=a.direction;S!=="alternate"&&(a.direction=S!=="normal"?"normal":"reverse"),a.reversed=!a.reversed,r.forEach(function(M){return M.reversed=a.reversed})}function d(S){return a.reversed?a.duration-S:S}function v(){e=0,n=d(a.currentTime)*(1/F.speed)}function b(S,M){M&&M.seek(S-M.timelineOffset)}function x(S){if(a.reversePlayback)for(var M=l;M--;)b(S,r[M]);else for(var P=0;P<l;P++)b(S,r[P])}function _(S){for(var M=0,P=a.animations,$=P.length;M<$;){var C=P[M],j=C.animatable,I=C.tweens,E=I.length-1,T=I[E];E&&(T=Pt(I,function($t){return S<$t.end})[0]||T);for(var V=le(S-T.start-T.delay,0,T.duration)/T.duration,B=isNaN(V)?1:T.easing(V),H=T.to.strings,K=T.round,ge=[],$e=T.to.numbers.length,pe=void 0,xe=0;xe<$e;xe++){var be=void 0,it=T.to.numbers[xe],rt=T.from.numbers[xe]||0;T.isPath?be=js(T.value,B*it,T.isPathTargetInsideSVG):be=rt+B*(it-rt),K&&(T.isColor&&xe>2||(be=Math.round(be*K)/K)),ge.push(be)}var Se=H.length;if(!Se)pe=ge[0];else{pe=H[0];for(var Ae=0;Ae<Se;Ae++){H[Ae];var Ie=H[Ae+1],Ne=ge[Ae];isNaN(Ne)||(Ie?pe+=Ne+Ie:pe+=Ne+" ")}}Fi[C.type](j.target,C.property,pe,j.transforms),C.currentValue=pe,M++}}function m(S){a[S]&&!a.passThrough&&a[S](a)}function g(){a.remaining&&a.remaining!==!0&&a.remaining--}function w(S){var M=a.duration,P=a.delay,$=M-a.endDelay,C=d(S);a.progress=le(C/M*100,0,100),a.reversePlayback=C<a.currentTime,r&&x(C),!a.began&&a.currentTime>0&&(a.began=!0,m("begin")),!a.loopBegan&&a.currentTime>0&&(a.loopBegan=!0,m("loopBegin")),C<=P&&a.currentTime!==0&&_(0),(C>=$&&a.currentTime!==M||!M)&&_(M),C>P&&C<$?(a.changeBegan||(a.changeBegan=!0,a.changeCompleted=!1,m("changeBegin")),m("change"),_(C)):a.changeBegan&&(a.changeCompleted=!0,a.changeBegan=!1,m("changeComplete")),a.currentTime=le(C,0,M),a.began&&m("update"),S>=M&&(n=0,g(),a.remaining?(e=i,m("loopComplete"),a.loopBegan=!1,a.direction==="alternate"&&p()):(a.paused=!0,a.completed||(a.completed=!0,m("loopComplete"),m("complete"),!a.passThrough&&"Promise"in window&&(c(),u(a)))))}return a.reset=function(){var S=a.direction;a.passThrough=!1,a.currentTime=0,a.progress=0,a.paused=!0,a.began=!1,a.loopBegan=!1,a.changeBegan=!1,a.completed=!1,a.changeCompleted=!1,a.reversePlayback=!1,a.reversed=S==="reverse",a.remaining=a.loop,r=a.children,l=r.length;for(var M=l;M--;)a.children[M].reset();(a.reversed&&a.loop!==!0||S==="alternate"&&a.loop===1)&&a.remaining++,_(a.reversed?a.duration:0)},a._onDocumentVisibility=v,a.set=function(S,M){return Ri(S,M),a},a.tick=function(S){i=S,e||(e=i),w((i+(n-e))*F.speed)},a.seek=function(S){w(d(S))},a.pause=function(){a.paused=!0,v()},a.play=function(){a.paused&&(a.completed&&a.reset(),a.paused=!1,ne.push(a),v(),Li())},a.reverse=function(){p(),a.completed=!a.reversed,v()},a.restart=function(){a.reset(),a.play()},a.remove=function(S){var M=wn(S);Ui(M,a)},a.reset(),a.autoplay&&a.play(),a}function Kn(t,e){for(var n=e.length;n--;)fn(t,e[n].animatable.target)&&e.splice(n,1)}function Ui(t,e){var n=e.animations,i=e.children;Kn(t,n);for(var r=i.length;r--;){var l=i[r],c=l.animations;Kn(t,c),!c.length&&!l.children.length&&i.splice(r,1)}!n.length&&!i.length&&e.pause()}function Vs(t){for(var e=wn(t),n=ne.length;n--;){var i=ne[n];Ui(e,i)}}function Bs(t,e){e===void 0&&(e={});var n=e.direction||"normal",i=e.easing?pn(e.easing):null,r=e.grid,l=e.axis,c=e.from||0,u=c==="first",a=c==="center",p=c==="last",d=A.arr(t),v=parseFloat(d?t[0]:t),b=d?parseFloat(t[1]):0,x=ye(d?t[1]:t)||0,_=e.start||0+(d?v:0),m=[],g=0;return function(w,S,M){if(u&&(c=0),a&&(c=(M-1)/2),p&&(c=M-1),!m.length){for(var P=0;P<M;P++){if(!r)m.push(Math.abs(c-P));else{var $=a?(r[0]-1)/2:c%r[0],C=a?(r[1]-1)/2:Math.floor(c/r[0]),j=P%r[0],I=Math.floor(P/r[0]),E=$-j,T=C-I,V=Math.sqrt(E*E+T*T);l==="x"&&(V=-E),l==="y"&&(V=-T),m.push(V)}g=Math.max.apply(Math,m)}i&&(m=m.map(function(H){return i(H/g)*g})),n==="reverse"&&(m=m.map(function(H){return l?H<0?H*-1:-H:Math.abs(g-H)}))}var B=d?(b-v)/g:v;return _+B*(Math.round(m[S]*100)/100)+x}}function Hs(t){t===void 0&&(t={});var e=F(t);return e.duration=0,e.add=function(n,i){var r=ne.indexOf(e),l=e.children;r>-1&&ne.splice(r,1);function c(b){b.passThrough=!0}for(var u=0;u<l.length;u++)c(l[u]);var a=Dt(n,Kt(dn,t));a.targets=a.targets||t.targets;var p=e.duration;a.autoplay=!1,a.direction=e.direction,a.timelineOffset=A.und(i)?p:bn(i,p),c(e),e.seek(a.timelineOffset);var d=F(a);c(d),l.push(d);var v=zi(l,t);return e.delay=v.delay,e.endDelay=v.endDelay,e.duration=v.duration,e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}F.version="3.2.1";F.speed=1;F.suspendWhenDocumentHidden=!0;F.running=ne;F.remove=Vs;F.get=gn;F.set=Ri;F.convertPx=vn;F.path=Is;F.setDashoffset=Ds;F.stagger=Bs;F.timeline=Hs;F.easing=pn;F.penner=Oi;F.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};function We(t){return arguments.length===0?[]:Array.isArray(t)?t:[t]}var Gs=Object.defineProperty,qs=Object.defineProperties,Ys=Object.getOwnPropertyDescriptors,ei=Object.getOwnPropertySymbols,Xs=Object.prototype.hasOwnProperty,Qs=Object.prototype.propertyIsEnumerable,tn=(t,e,n)=>e in t?Gs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_t=(t,e)=>{for(var n in e||(e={}))Xs.call(e,n)&&tn(t,n,e[n]);if(ei)for(var n of ei(e))Qs.call(e,n)&&tn(t,n,e[n]);return t},Wi=(t,e)=>qs(t,Ys(e)),ze=(t,e,n)=>(tn(t,typeof e!="symbol"?e+"":e,n),n);const Ni={duration:300,easing:"linear",direction:"alternate",loop:4,autoplay:!1};let Zs=class{constructor(){ze(this,"materialsToUpdate",new Set)}scheduleUpdate(e){this.materialsToUpdate.add(e)}flushUpdates(){this.materialsToUpdate.forEach(e=>{e.needsUpdate=!0}),this.materialsToUpdate.clear()}clear(){this.materialsToUpdate.clear()}},Js=class{constructor(){ze(this,"startTime",0),ze(this,"measurements",new Map)}start(e){this.startTime=performance.now()}end(e){const n=performance.now()-this.startTime;return this.measurements.has(e)||this.measurements.set(e,[]),this.measurements.get(e).push(n),n}getAverage(e){const n=this.measurements.get(e);return!n||n.length===0?0:n.reduce((i,r)=>i+r,0)/n.length}clear(){this.measurements.clear()}},Ks=class{constructor(){ze(this,"stateMap",new WeakMap),ze(this,"materialManager",new Zs),ze(this,"performanceMonitor",new Js)}storeState(e){this.performanceMonitor.start("storeState"),e.forEach(n=>{if(!this.stateMap.has(n)){const i=this.createStateSnapshot(n);this.stateMap.set(n,i)}}),this.performanceMonitor.end("storeState")}restoreState(e){this.performanceMonitor.start("restoreState"),e.forEach(n=>{const i=this.stateMap.get(n);i&&(this.restoreSingleState(n,i),this.stateMap.delete(n))}),this.materialManager.flushUpdates(),this.performanceMonitor.end("restoreState")}getStateMap(){return this.stateMap}createStateSnapshot(e){var n;if(e instanceof HTMLElement)return{opacity:e.style.opacity===""?void 0:e.style.opacity,visible:{display:e.style.display,visibility:e.style.visibility}};if(Le(e))if(!De(e)&&e.children.length===0&&e.name,De(e)){if(Mt(e)){const i=e.material.transparent;return{opacity:(n=e.material.uniforms.opacity)==null?void 0:n.value,transparent:i===!1?void 0:i,visible:e.visible}}else if(xt(e)){const i=e.material.transparent;return{opacity:e.material.opacity,transparent:i===!1?void 0:i,visible:e.visible}}}else return{visible:e.visible};return{}}restoreSingleState(e,n){e instanceof HTMLElement?(e.style.opacity=n.opacity===void 0?"":String(n.opacity),typeof n.visible=="object"&&n.visible!==null&&(e.style.display=n.visible.display,e.style.visibility=n.visible.visibility)):Le(e)&&(typeof n.visible=="boolean"&&(e.visible=n.visible),De(e)&&(Mt(e)?(e.material.uniforms.opacity!==void 0&&(e.material.uniforms.opacity.value=n.opacity!==void 0?Number(n.opacity):1),n.transparent!==void 0&&(e.material.transparent=n.transparent),this.materialManager.scheduleUpdate(e.material)):xt(e)&&(e.material.opacity=n.opacity!==void 0?Number(n.opacity):1,n.transparent!==void 0&&(e.material.transparent=n.transparent),this.materialManager.scheduleUpdate(e.material))))}clear(){this.materialManager.clear(),this.performanceMonitor.clear()}};const Ee=new WeakMap,_e=new Ks;function Le(t){return"isObject3D"in t&&t.isObject3D===!0}function De(t){return Le(t)&&"material"in t&&t.material!==void 0}function Mt(t){return De(t)&&t.material instanceof hn}function xt(t){return De(t)&&!(t.material instanceof hn)}function eo(t,e){t instanceof HTMLElement?t.style.opacity=String(e):Le(t)&&De(t)&&(Mt(t)?(t.material.uniforms.opacity&&(t.material.uniforms.opacity.value=e),t.material.transparent=!0):xt(t)&&(t.material.opacity=e,t.material.transparent=!0))}function At(){const t=F({});return t.preComplete=()=>{},t}function Vi(t){if(!t)throw new Error("Invalid objects parameter: objects cannot be null or undefined");const e=We(t);if(e.length===0)throw new Error("Invalid objects parameter: objects array cannot be empty");if(e.some(n=>n==null))throw new Error("Invalid objects parameter: objects array contains null or undefined values")}function Bi(t,e){const n=We(t),i=[];return n.forEach(r=>{r&&(r instanceof HTMLElement?i.push(r):Le(r)&&(e?(i.push(r),r.traverse(l=>{l&&i.push(l)})):i.push(r)))}),Array.from(new Set(i.filter(Boolean)))}function to(t,e){const n=new Map,i=_e.getStateMap();return t.forEach(r=>{var l;const c=i.get(r);c&&n.set(r,{initialOpacity:Number((l=c.opacity)!=null?l:1)})}),r=>{var l,c;const u=r.progress;t.forEach(a=>{const p=n.get(a);if(!p)return;const d=p.initialOpacity*(100-u)/100;eo(a,d)}),(l=e.onProgress)==null||l.call(e,u),(c=e.updateRender)==null||c.call(e)}}function no(t,e){const n=new Map,i=_e.getStateMap();return t.forEach(r=>{var l,c;const u=i.get(r),a=Number((c=(l=u==null?void 0:u.opacity)!=null?l:e==null?void 0:e.maxOpacity)!=null?c:1);n.set(r,{maxOpacity:a})}),r=>{var l,c;const u=r.progress;t.forEach(a=>{const p=n.get(a);if(!p)return;const d=p.maxOpacity*(u/100);a instanceof HTMLElement?(a.style.opacity=String(d),a.style.visibility="visible"):Le(a)&&(We(t).includes(a)&&(a.visible=!0),De(a)&&(Mt(a)?(a.material.uniforms.opacity&&(a.material.uniforms.opacity.value=d),a.material.transparent=!0):xt(a)&&(a.material.opacity=d,a.material.transparent=!0)))}),(l=e.onProgress)==null||l.call(e,u),(c=e.updateRender)==null||c.call(e)}}function wa(t,e){var n,i;try{Vi(t);const r=(n=e==null?void 0:e.traverseTHREEObject)!=null?n:!0,l=Bi(t,r);if(l.length===0)return At();_e.storeState(l);const c=Wi(_t(_t({},Ni),e),{targets:l,update:to(l,e||{})}),u=F(c);u.preComplete=()=>{u.completed||(u.pause(),_e.restoreState(l),setTimeout(()=>{var p;return(p=e==null?void 0:e.updateRender)==null?void 0:p.call(e)}))};const a=Ee.get(t);return a==null||a.pause(),a==null||a.seek(0),Ee.set(t,u),(i=e==null?void 0:e.onStart)==null||i.call(e),u.play(),u.finished.then(()=>{var p,d;_e.restoreState(l),setTimeout(()=>{Ee.get(t)===u&&Ee.delete(t)},1e3),(p=e==null?void 0:e.onComplete)==null||p.call(e),(d=e==null?void 0:e.updateRender)==null||d.call(e),setTimeout(()=>{var v;return(v=e==null?void 0:e.updateRender)==null?void 0:v.call(e)},50),setTimeout(()=>{var v;return(v=e==null?void 0:e.updateRender)==null?void 0:v.call(e)},100)}),u}catch{return At()}}function Ea(t,e){var n,i;try{Vi(t);const r=(n=e==null?void 0:e.traverseTHREEObject)!=null?n:!0,l=Bi(t,r);if(l.length===0)return At();_e.storeState(l);const c=Wi(_t(_t({},Ni),e),{targets:l,update:no(l,e||{})}),u=F(c);u.preComplete=()=>{u.completed||(u.pause(),_e.restoreState(l),setTimeout(()=>{var p;return(p=e==null?void 0:e.updateRender)==null?void 0:p.call(e)}))};const a=Ee.get(t);return a==null||a.pause(),a==null||a.seek(0),Ee.set(t,u),(i=e==null?void 0:e.onStart)==null||i.call(e),u.play(),u.finished.then(()=>{var p,d;_e.restoreState(l),setTimeout(()=>{Ee.get(t)===u&&Ee.delete(t)},1e3),(p=e==null?void 0:e.onComplete)==null||p.call(e),(d=e==null?void 0:e.updateRender)==null||d.call(e),setTimeout(()=>{var v;return(v=e==null?void 0:e.updateRender)==null?void 0:v.call(e)},50),setTimeout(()=>{var v;return(v=e==null?void 0:e.updateRender)==null?void 0:v.call(e)},100)}),u}catch{return At()}}function io(t,e,n=!0){if(!t)return console.error("createResizeObserver: element is undefined"),{observe:()=>{},unobserve:()=>{}};const i=()=>{const l=wt(t.clientWidth,{floor:!0}),c=wt(t.clientHeight,{floor:!0});e(l,c)};if(typeof ResizeObserver>"u"||!ResizeObserver)return console.warn("createResizeObserver: ResizeObserver is undefined"),{observe:()=>i(),unobserve:()=>{}};const r=new ResizeObserver(i);return n&&i(),{observe:()=>r.observe(t),unobserve:()=>r.unobserve(t)}}var ro=Object.defineProperty,so=(t,e,n)=>e in t?ro(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yt=(t,e,n)=>(so(t,typeof e!="symbol"?e+"":e,n),n);let ti=class extends ms{constructor(e){super(e),yt(this,"wrapper"),yt(this,"domElementWrapper",document.createElement("div")),yt(this,"requestAnimationFrameId"),yt(this,"resizeDisoper"),this.domElementWrapper.classList.add("ICSS3DRendererWrapper"),this.domElementWrapper.style.position="absolute",this.domElementWrapper.style.top="0",this.domElementWrapper.style.left="0",this.domElementWrapper.style.width="100%",this.domElementWrapper.style.height="100%",this.domElementWrapper.style.userSelect="none",this.domElementWrapper.style.pointerEvents="none",this.domElement.classList.add("ICSS3DRenderer"),this.domElement.style.position="absolute",this.domElement.style.top="0",this.domElement.style.left="0",this.domElement.style.userSelect="none",this.domElement.style.pointerEvents="none",this.domElementWrapper.appendChild(this.domElement)}setWrapper(e){if(!e)throw new Error("CSS3DRenderer: wrapper is required");if((()=>{for(let i=0;i<e.children.length;i++)if(e.children.item(i)===this.domElementWrapper)return!0;return!1})())return;const n=this.wrapper;return n&&n.contains(this.domElementWrapper)&&this.domElementWrapper.remove(),this.appendToElement(e),this.wrapper=e,this}appendToElement(e){e.appendChild(this.domElementWrapper);const n=(l,c)=>this.setSize(l,c),{observe:i,unobserve:r}=io(this.domElementWrapper,n,!0);i(),this.resizeDisoper=r,this.wrapper=e}renderEveryFrame(e,n){if(this.wrapper||console.warn("wrapper is not find, creating a html element and call setWrapper(wrapper)",this,e),this.requestAnimationFrameId)return;const i=()=>{this.requestAnimationFrameId=requestAnimationFrame(i),e.visible&&this.render(e,n)};i()}stopRender(){this.requestAnimationFrameId&&cancelAnimationFrame(this.requestAnimationFrameId)}dispose(){var e;this.stopRender(),(e=this.resizeDisoper)==null||e.call(this),this.domElementWrapper.remove()}};function Ue(t){const e=[];return We(t).forEach(n=>{n.traverse(i=>{(i.isCSS3DObjectPlus||i.isCSS3DObject||i.isCSS3DSprite)&&e.push(i)})}),e}var oo=Object.defineProperty,ao=(t,e,n)=>e in t?oo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lo=(t,e,n)=>(ao(t,typeof e!="symbol"?e+"":e,n),n);let co=class extends Si{constructor(){super()}add(...e){return super.add(...e),Ue(e).forEach(n=>{n.mode="front"}),this}},ho=class extends Si{constructor(e){if(super(),lo(this,"scene"),!e)throw new Error("CSS3DBehindScene: scene is required");this.scene=e}add(...e){return super.add(...e),Ue(e).forEach(n=>{n.mode="behind",this.scene.add(n.getOpacityMesh())}),this}remove(...e){return Ue(e).forEach(n=>{var i;(i=n.opacityMesh)==null||i.removeFromParent(),n.opacityMesh=null}),super.remove(...e),this}};var uo=Object.defineProperty,po=(t,e,n)=>e in t?uo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,St=(t,e,n)=>(po(t,typeof e!="symbol"?e+"":e,n),n);let Hi=class extends Dr{constructor(e){super(),St(this,"isCSS3DGroup",!0),St(this,"mode"),St(this,"CSS3DObjectLength",0),this.mode=e}add(...e){return Ue(e).forEach(n=>{n.mode=this.mode}),super.add(...e),this.updateLength(),this}setVisible(e){this.visible=e,this.traverse(n=>{n.isCSS3DObjectPlus&&n.updateVisible()})}remove(...e){return super.remove(...e),this.updateLength(),this}updateLength(){this.CSS3DObjectLength=Ue(this).length}},fo=class extends Hi{constructor(){super("front")}},mo=class extends Hi{constructor(e){if(super("behind"),St(this,"scene"),!e)throw new Error("CSS3DBehindScene: scene is required");this.scene=e}add(...e){return Ue(e).forEach(n=>{this.scene.add(n.getOpacityMesh())}),super.add(...e),this}};var vo=(t,e,n)=>new Promise((i,r)=>{var l=a=>{try{u(n.next(a))}catch(p){r(p)}},c=a=>{try{u(n.throw(a))}catch(p){r(p)}},u=a=>a.done?i(a.value):Promise.resolve(a.value).then(l,c);u((n=n.apply(t,e)).next())});function yo(t){return vo(this,null,function*(){return new Promise(e=>{if(go(t))e();else{const n=i=>{const r=Ct(t);i===r&&(t.off("modelLoaded",n),e())};t.on("modelLoaded",n)}})})}function go(t){var e;return(e=Ct(t))==null?void 0:e.loaded}const Pa=16777215,bo=16777215,So=1,Ta=.4,Gi=.6;var wo=Object.defineProperty,Eo=(t,e,n)=>e in t?wo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ni=(t,e,n)=>(Eo(t,typeof e!="symbol"?e+"":e,n),n);let qi=class extends ln{constructor(){super(),ni(this,"name","IObject3D"),ni(this,"needsRender")}removeChildren(){for(;this.children.length>0;)this.remove(this.children[0]);return this}add(...e){const n=e.filter(Boolean);return n.length===0?this:super.add(...n)}addIfNotExists(...e){return e.forEach(n=>{this.children.includes(n)||this.add(n)}),this}remove(...e){if(e.length===0)return this;const n=e.filter(Boolean);return super.remove(...n)}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}};function Yi(t,e){if(!document.getElementById("LineLengthTagStyle")){const i=document.createElement("style");i.id="LineLengthTagStyle",document.head.appendChild(i),i.innerHTML=`
    .LineLengthTag {
      cursor: default;
      position: absolute;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: Arial-BoldMT;
      font-weight: BoldMT;
      color: #041066;
      letter-spacing: 0;
      line-height: 20px;
      background-color: #FFFFFF;
      border-radius: 12px;
      padding: 2px 8px;
      left: 50%;
      transform: translate(-50%, -50%);
      word-break: keep-all;
      --distance-scale: 1; /* Default scale if not provided */
      transition: font-size 0.5s ease; /* Smooth transition for font size */
    }
    
    /* sm screen */
    @media screen and (max-width: 499px) {
      .LineLengthTag {
        font-size: calc(12px + (14px - 12px) * var(--distance-scale));
      }
    }
    
    /* md screen */
    @media screen and (min-width: 500px) and (max-width: 929px) {
      .LineLengthTag {
        font-size: calc(12px + (14px - 12px) * var(--distance-scale));
      }
    }
    
    /* lg screen */
    @media screen and (min-width: 930px) and (max-width: 1365px) {
      .LineLengthTag {
        font-size: calc(14px + (16px - 14px) * var(--distance-scale));
      }
    }
    
    /* xl screen */
    @media screen and (min-width: 1366px) and (max-width: 2549px) {
      .LineLengthTag {
        font-size: calc(14px + (16px - 14px) * var(--distance-scale));
      }
    }
    
    /* xxl screen */
    @media screen and (min-width: 2550px) {
      .LineLengthTag {
        font-size: calc(0.875rem + (1rem - 0.875rem) * var(--distance-scale));
      }
    }
    `}const n=e!=null&&e.offsetY?`translateY(${e.offsetY}px)`:"";return`
    <div class="LineLengthTag" style="${n?`transform: translate(-50%, -50%) ${n};`:""}${e!=null&&e.style?" "+e.style:""}">
      ${t}
    </div>
  `}function nn(t,e){const n=We(e).map(i=>t.localToWorld(i.clone()));return Array.isArray(e)?n:n[0]}function $a(t,e){const n=We(e).map(i=>t.worldToLocal(i.clone()));return Array.isArray(e)?n:n[0]}let Yt=class extends $r{constructor(...e){super(...e),this.setAttribute("instanceStart",new Qe(new Float32Array,3)),this.setAttribute("instanceEnd",new Qe(new Float32Array,3))}fromEdgesGeometry(e){if(e.attributes.position.array.length<6)return this.setAttribute("position",new Qe(new Float32Array,3)),this.setAttribute("instanceStart",new Qe(new Float32Array,3)),this.setAttribute("instanceEnd",new Qe(new Float32Array,3)),this;if(e instanceof Ir){const n=new jr(e.attributes.position.array,6,1);this.setPositions(e.attributes.position.array),this.setAttribute("instanceStart",new Nn(n,3,0)),this.setAttribute("instanceEnd",new Nn(n,3,3))}else super.fromEdgesGeometry(e);return this}toJSON(){return{type:"FiveLineGeometry",attributes:this.attributes}}};var _o=Object.defineProperty,Mo=(t,e,n)=>e in t?_o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ii=(t,e,n)=>(Mo(t,typeof e!="symbol"?e+"":e,n),n);let xo=class extends kr{constructor(e){var n;super(e),ii(this,"_three_color"),ii(this,"_dashed"),Y(e==null?void 0:e.color)&&(this.three_color=(n=e==null?void 0:e.color)!=null?n:16777215),Object.keys(e).forEach(i=>{["color","dashed","dashScale","dashSize","gapSize","resolution"].includes(i)||i in this&&(this[i]=e[i])}),Object.defineProperties(this,{dashed:{get(){return this._dashed},set(i){this._dashed=i,i?this.defines.USE_DASH="":delete this.defines.USE_DASH,this.needsUpdate=!0}}})}get three_color(){return this._three_color}set three_color(e){this._three_color=e,this.color=e}toJSON(){return{type:"FiveLineMaterial",color:this.color}}},ri=class extends Fr{constructor(e,n){super(e,n)}toJSON(){return{type:"Five_THREE_Line2",geometryAttributes:this.geometry.attributes}}};var Ao=Object.defineProperty,Oo=(t,e,n)=>e in t?Ao(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,si=(t,e,n)=>(Oo(t,typeof e!="symbol"?e+"":e,n),n);let Co=class extends _i{constructor(e){var n;super(e),si(this,"_three_color"),si(this,"_dashed"),Y(e==null?void 0:e.color)&&(this.three_color=(n=e==null?void 0:e.color)!=null?n:16777215),Object.keys(e).forEach(i=>{["color","dashed","dashScale","dashSize","gapSize","resolution"].includes(i)||i in this&&(this[i]=e[i])}),Object.defineProperties(this,{dashed:{get(){return this._dashed},set(i){this._dashed=i,i?this.defines.USE_DASH="":delete this.defines.USE_DASH,this.needsUpdate=!0}}})}get three_color(){return this._three_color}set three_color(e){this._three_color=e,this.color=e}toJSON(){return{type:"FiveLineMaterial",color:this.color}}};function Po(t,e="m",n=2){let i;if(e==="m")return i=t.toFixed(n),parseFloat(i)===0?void 0:i+"m";if(e==="mm")return i=(t*1e3).toFixed(0),i==="0"?void 0:i+"mm";if(e==="ft"){const r=Math.floor(t/.3048),l=Math.floor(t%.3048/.0254);return r===0&&l===0?void 0:`${r}′${l}″`}}function Ra(t,e="m"){let n;if(e==="m")return n=t.toFixed(2),n==="0.00"?void 0:n+"m²";if(e==="mm")return n=(t*1e3*1e3).toFixed(0),n==="0"?void 0:n+"mm²";if(e==="ft"){const i=(t*10.76).toFixed(1);return i==="0.0"?void 0:i+"ft²"}}var To=Object.defineProperty,Do=(t,e,n)=>e in t?To(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oi=(t,e,n)=>(Do(t,typeof e!="symbol"?e+"":e,n),n);const Te=class{static checkDom(t){let e=t,n=!0;for(;e.parent;)n===!0&&e.visible===!1&&(n=!1),e=e.parent;e.type==="Scene"?(t._onAdded(),n?t._onShowed():t._onHidden()):t._onRemoved()}static checkDomEveryFrame(){Te.checkDomEveryFrameIsRunning||(Te.checkDomEveryFrameIsRunning=!0,Te._checkDomEveryFrame())}static _checkDomEveryFrame(){Te.cacheObject.forEach(t=>Te.checkDom(t)),requestAnimationFrame(Te._checkDomEveryFrame)}};let he=Te;oi(he,"cacheObject",new Set),oi(he,"checkDomEveryFrameIsRunning",!1);var $o=Object.defineProperty,Io=Object.defineProperties,jo=Object.getOwnPropertyDescriptors,ai=Object.getOwnPropertySymbols,ko=Object.prototype.hasOwnProperty,Fo=Object.prototype.propertyIsEnumerable,rn=(t,e,n)=>e in t?$o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ze=(t,e)=>{for(var n in e||(e={}))ko.call(e,n)&&rn(t,n,e[n]);if(ai)for(var n of ai(e))Fo.call(e,n)&&rn(t,n,e[n]);return t},li=(t,e)=>Io(t,jo(e)),L=(t,e,n)=>(rn(t,typeof e!="symbol"?e+"":e,n),n);class za extends qi{constructor(e){var n,i,r,l;super(),L(this,"name","LineMesh"),L(this,"type","Line2"),L(this,"object"),L(this,"points",[]),L(this,"doms",[]),L(this,"highlighted",!1),L(this,"_geometry"),L(this,"line1"),L(this,"line2"),L(this,"opacityBeforeHighlight"),L(this,"colorBeforeHighlight"),L(this,"paramsStyle",{}),L(this,"lastRenderDomItem"),L(this,"lastFOV"),L(this,"_onAdded",()=>{this.doms.length===0&&this.paramsStyle.lengthEnable&&this.updateDomItems()}),L(this,"_onRemoved",()=>{this.doms.forEach(p=>p.destroy()),this.doms=[]}),L(this,"_onShowed",()=>{this.doms.forEach(p=>p.container.style.display="block")}),L(this,"_onHidden",()=>{this.doms.forEach(p=>p.container.style.display="none")}),L(this,"onCameraUpdate",()=>{var p;(p=this.five)!=null&&p.camera&&this.lastFOV!==this.five.camera.fov&&(this.lastFOV=this.five.camera.fov,this.updateDomItems({force:!0}))}),L(this,"onPanoArrived",()=>{setTimeout(()=>this.updateDomItems({force:!0}),100)}),this.paramsStyle=Ze({dashed:!1,lineOpacity:1},e),this.geometry=new Yt;const c={color:new mt((n=e==null?void 0:e.lineColor)!=null?n:bo),linewidth:(i=e==null?void 0:e.lineWidth)!=null?i:So,dashScale:1,dashSize:.02,gapSize:.02,opacity:(r=e==null?void 0:e.lineOpacity)!=null?r:1,depthWrite:!1,transparent:!0},u=new xo(li(Ze({},c),{dashed:!1,depthTest:!0})),a=new Co(li(Ze({},c),{dashed:!0,depthTest:!1}));if(this.line1=new ri(this.geometry,u),this.line2=new ri(this.geometry,a),this.line1.renderOrder=2,this.line2.renderOrder=2,this.line1.name="line1",this.line2.name="line2",this.add(this.line1),this.five){const p=(l=this.five.renderer)==null?void 0:l.getSize(new cn);p&&this.setResolution(p.width,p.height),this.five.on("cameraUpdate",this.onCameraUpdate),this.five.on("cameraFovUpdate",this.onCameraUpdate),this.five.on("panoArrived",this.onPanoArrived)}e&&this.setStyle(e),e!=null&&e.points&&this.setPoints(e.points),this.addEventListener("removed",()=>{this.five&&(this.five.off("cameraUpdate",this.onCameraUpdate),this.five.off("cameraFovUpdate",this.onCameraUpdate),this.five.off("panoArrived",this.onPanoArrived)),he.cacheObject.delete(this),he.checkDom(this)}),this.addEventListener("added",()=>{he.cacheObject.add(this)}),he.checkDomEveryFrame()}get style(){return{lineColor:this.color,lineWidth:this.lineWidth,lineOpacity:this.lineOpacity,dashed:this.dashed,occlusionVisibility:this.occlusionVisibility,occlusionMode:this.occlusionMode,lengthEnable:this.paramsStyle.lengthEnable,tip:this.paramsStyle.tip}}get lineOpacity(){var e;return(e=this.line1.material.opacity)!=null?e:this.paramsStyle.lineOpacity}get lineWidth(){var e;return(e=this.line1.material.linewidth)!=null?e:this.paramsStyle.lineWidth}get color(){var e;return new mt((e=this.line1.material.three_color)!=null?e:this.paramsStyle.lineColor)}get dashed(){return this.paramsStyle.dashed}get occlusionVisibility(){return this.paramsStyle.occlusionVisibility}get occlusionMode(){return this.paramsStyle.occlusionMode}get five(){var e,n;const i=(n=(e=window.globalModules)==null?void 0:e.five)!=null?n:window.$five;return i||console.error("请先调用 Sculpt.modules.init(five) "),i}set geometry(e){var n;this._geometry=e,this.line1&&(this.line1.geometry=e),this.line2&&(this.line2.geometry=e),(n=this.line1)==null||n.computeLineDistances()}get geometry(){return this._geometry}updateMatrixWorld(e){var n;if(super.updateMatrixWorld(e),this.points){const i=(n=nn(this,this.points))==null?void 0:n.map(r=>r.toArray().join(",")).join(",");i!==this.lastRenderDomItem&&(this.updateDomItems(),this.lastRenderDomItem=i)}}setPoints(e){if(this.points.length===0&&e.length===0)return;const n=e.map(ae).filter(Y);if(this.points=n,n.length<2){const r=new Yt;this.line1.geometry=r,this.line2.geometry=r,this.updateDomItems();return}const i=n.flatMap(r=>[r.x,r.y,r.z]);if(i.length>2){this.line1.geometry.dispose();const r=new Yt;this.line1.geometry=r,this.line2.geometry=r}this.line1.geometry.setPositions(i),this.line1.computeLineDistances(),this.updateDomItems(),this.needsRender=!0}setResolution(e,n){const i=this.line1.material.resolution;(i.x!==e||i.y!==n)&&(i.set(e,n),this.needsRender=!0);const r=this.line2.material.resolution;(r.x!==e||r.y!==n)&&(r.set(e,n),this.needsRender=!0)}setStyle(e){var n,i,r,l;if(this.paramsStyle=Ze(Ze({},this.paramsStyle),e),Y(e.lineColor)){const a=new mt(e.lineColor);this.line1.material.three_color=a,this.line2.material.three_color=a}Y(e.lineWidth)&&(this.line1.material.linewidth=e.lineWidth,this.line2.material.linewidth=e.lineWidth),Y(e.dashed)&&(this.line1.material.dashed=e.dashed),Y(e.lineOpacity)&&(this.line1.material.opacity=e.lineOpacity,this.line2.material.opacity=e.lineOpacity),this.updateDomItems({force:!0});const c=(i=(n=e.occlusionVisibility)!=null?n:this.paramsStyle.occlusionVisibility)!=null?i:!0,u=(l=(r=e.occlusionMode)!=null?r:this.paramsStyle.occlusionMode)!=null?l:"translucence";c?this.dashed?(this.remove(this.line2),this.line1.material.dashed=!0,this.line1.material.depthTest=!1):u==="depthTest"?(this.remove(this.line2),this.line1.material.dashed=!1,this.line1.material.depthTest=!1):u==="translucence"&&(this.line1.material.depthTest=!0,this.line2.material.depthTest=!1,this.line1.material.dashed=!0,this.line2.material.dashed=!0,this.addIfNotExists(this.line2)):(this.remove(this.line2),this.line1.material.depthTest=!0,this.line1.material.dashed=this.paramsStyle.dashed),this.doms.forEach(a=>a.intersectCheck=!c),this.needsRender=!0}highlight(e){var n,i;if(this.highlighted=!0,e!=null&&e.color){const r=new mt(e.color);this.colorBeforeHighlight=(n=this.colorBeforeHighlight)!=null?n:this.line1.material.three_color,this.line1.material.three_color=r,this.line2.material.three_color=r}else{this.opacityBeforeHighlight=(i=this.opacityBeforeHighlight)!=null?i:this.line1.material.opacity;const r=this.opacityBeforeHighlight*Gi;this.line1.material.opacity=r,this.line2.material.opacity=r}this.needsRender=!0}unhighlight(){this.highlighted&&(this.highlighted=!1,Y(this.opacityBeforeHighlight)&&(this.line1.material.opacity=this.opacityBeforeHighlight,this.line2.material.opacity=this.line1.material.opacity,this.opacityBeforeHighlight=void 0),Y(this.colorBeforeHighlight)&&(this.line1.material.three_color=this.colorBeforeHighlight,this.line2.material.three_color=this.colorBeforeHighlight,this.colorBeforeHighlight=void 0),this.needsRender=!0)}updateDomItems(e){const n=()=>{this.doms.forEach(r=>r.destroy()),this.doms=[]};if(!this.points||this.points.length<2||!this.paramsStyle.lengthEnable&&!this.paramsStyle.tip)return n();if(!this.five)return console.error("Five not found");const i=this.points.map((r,l)=>l!==0?[this.points[l-1],r]:null).filter(Y).map(r=>nn(this,r));i.forEach(([r,l],c)=>{var u;const a=Zt(r,l);this.doms[c]=(u=this.doms[c])!=null?u:(()=>{var d;const v=new Qi(this.five),b=(d=this.paramsStyle.occlusionVisibility)!=null?d:!0;return v.intersectCheck=!b,v.simulate3D=!0,v})(),this.doms[c].setPosition(a,[r,l]);const p=(d,v)=>{var b,x,_;const m=(b=v==null?void 0:v.force)!=null?b:!1;if(!(this.doms[c].__text===d&&!m))if(this.doms[c].__text=d,d instanceof HTMLElement)this.doms[c].container.innerHTML="",this.doms[c].container.appendChild(d);else if(d){const g=(()=>{if(!this.five||!this.five.camera)return 0;const I=this.five.getElement();if(!I)return 0;const E=I.clientWidth,T=I.clientHeight,V=E/2,B=T/2,H=r.clone().project(this.five.camera),K=l.clone().project(this.five.camera),ge={x:H.x*V,y:H.y*B},$e={x:K.x*V,y:K.y*B};return Math.sqrt(Math.pow($e.x-ge.x,2)+Math.pow($e.y-ge.y,2))})(),w=(()=>!this.five||!this.five.camera?20:Zt(r,l).distanceTo(this.five.camera.position))(),S=((_=(x=this.five)==null?void 0:x.camera)==null?void 0:_.fov)||60,M=2*Math.tan(.5*S/180*Math.PI),P=`--distance-scale: ${Math.max(Math.min(1-M*w/40,1),0)};`,$=I=>{const E=document.createElement("div");E.classList.add("LineLengthTag"),E.style.visibility="hidden",E.style.position="absolute",E.style.padding="2px 8px",E.style.fontFamily="Arial-BoldMT",E.style.fontSize="14px",E.innerText=I,document.body.appendChild(E);const T=E.offsetWidth;return document.body.removeChild(E),T};let C=0;const j=$(d);g>0&&j>g&&(C=-20),this.doms[c].container.innerHTML=Yi(d,{style:`${P} ${this.paramsStyle.cssStyle||""}`,offsetY:C})}else this.doms[c].container.innerHTML=""};if(this.paramsStyle.tip)p(this.paramsStyle.tip,e);else{const d=Po(r.distanceTo(l),this.paramsStyle.lengthUnit,this.paramsStyle.precision);p(d||null,e)}}),this.doms.length>i.length&&(this.doms.slice(i.length).forEach(r=>r.destroy()),this.doms.length=i.length)}}const Ro=new W;function La(t){const{raycaster:e,line:n,clampToLine:i=!0}=t,r=new Rr().setFromNormalAndCoplanarPoint(e.ray.direction.clone().normalize(),new W),l=r.projectPoint(n.start,new W),c=r.projectPoint(n.end,new W),u=new zr(l,c),a=u.closestPointToPoint(e.ray.origin,i,Ro),p=a.distanceTo(c),d=a.distanceTo(l),v=u.distance();if(p>d&&p>v){const b=-a.distanceTo(l)/v,x=n.start.clone().sub(n.end).normalize();return n.start.clone().sub(x.clone().multiplyScalar(b*n.distance()))}else{const b=a.distanceTo(l)/v;return new W().lerpVectors(n.start,n.end,b)}}var zo=Object.defineProperty,Lo=Object.defineProperties,Uo=Object.getOwnPropertyDescriptors,ci=Object.getOwnPropertySymbols,Wo=Object.prototype.hasOwnProperty,No=Object.prototype.propertyIsEnumerable,sn=(t,e,n)=>e in t?zo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hi=(t,e)=>{for(var n in e||(e={}))Wo.call(e,n)&&sn(t,n,e[n]);if(ci)for(var n of ci(e))No.call(e,n)&&sn(t,n,e[n]);return t},Vo=(t,e)=>Lo(t,Uo(e)),oe=(t,e,n)=>(sn(t,typeof e!="symbol"?e+"":e,n),n),gt=(t,e,n)=>new Promise((i,r)=>{var l=a=>{try{u(n.next(a))}catch(p){r(p)}},c=a=>{try{u(n.throw(a))}catch(p){r(p)}},u=a=>a.done?i(a.value):Promise.resolve(a.value).then(l,c);u((n=n.apply(t,e)).next())});const Bo=3,on="CSS3DRenderer",Ke=`${on}@${Bo}`,Fe=()=>{console.error(`${Ke} is disposed`)},U={css3DObjects:[],frontModeStore:{css3DRenderer:new ti},behindModeStore:{css3DRenderer:new ti}};function ui(t){return U.css3DObjects.find(e=>e.id===t)}function Ho(t){U.frontModeStore.css3DRenderer.setWrapper(t)}function Go(t){U.behindModeStore.css3DRenderer.setWrapper(t)}class di{constructor(e){oe(this,"hooks",new un),oe(this,"state",{enabled:!0,visible:!0,disposed:!1}),oe(this,"_scene"),oe(this,"store",{frontModeGroup:new fo}),oe(this,"create3DElement",(n,i,r)=>{if(this.state.disposed)return Fe();const l=(()=>{const C={ratio:.00216,devicePixelRatio:1,mode:"front",autoRender:!0,container:document.createElement("div"),pointerEvents:"none",wrapperStyle:{}};return Object.assign(C,r)})(),c=i.map(ae);if((c==null?void 0:c.length)<4)return console.error(`${Ke}: requires 4 point but params may have fewer`);const{ratio:u,devicePixelRatio:a,mode:p,autoRender:d,container:v,pointerEvents:b,wrapperStyle:x}=l;let _=!1;const m=this.createObject(c,{ratio:u,dpr:a,container:v,mode:p,pointerEvents:b,wrapperStyle:x});U.css3DObjects.push(m),l.scene&&this.setScene(l.scene);const g=()=>{if(_)return;const C=m.mode==="front"?this.getFrontCSS3DObjectGroup():this.getBehindCSS3DObjectGroup();C&&C.add(m)},w=()=>{_||(g(),this.render(n),this.hooks.emit("render"))},S=C=>this.setVisibleById(m.id,C),M=C=>this.setEnabledById(m.id,C),P=()=>(_=!0,m.removeFromParent(),!0),$=p==="front"?U.frontModeStore.css3DRenderer:U.behindModeStore.css3DRenderer;return d&&w(),{id:m.uuid,container:v,css3DObject:m,render:d?void 0:w,show:()=>S(!0),hide:()=>S(!1),setVisible:S,enable:()=>M(!0),disable:()=>M(!1),setEnabled:M,dispose:P,appendToElement:C=>$.setWrapper(C)}}),oe(this,"setVisibleById",(n,i)=>{var r;(r=ui(n))==null||r.setVisible(i)}),oe(this,"setEnabledById",(n,i)=>{const r=ui(n);if(!r)return;const l=r.mode==="front"?this.getFrontCSS3DObjectGroup({addGroupIfNotExists:!1}):this.getBehindCSS3DObjectGroup({addGroupIfNotExists:!1});l&&(i?l.add(r):l.remove(r))}),oe(this,"createObject",(n,i)=>{const r=new Zo(Vo(hi({cornerPoints:n},i),{style:i.wrapperStyle}));return r.element.classList.add(`${on}__container`),r.element.id=`${on}__container--${r.uuid}`,r}),e&&this.setScene(e)}get scene(){return this._scene||console.error("scene doesn't exist!, please call setScene(scene) first"),this._scene}static get frontModeCSS3DRenderer(){return U.frontModeStore.css3DRenderer}static get behindModeCSS3DRenderer(){return U.behindModeStore.css3DRenderer}get frontModeCSS3DRenderer(){return U.frontModeStore.css3DRenderer}get behindModeCSS3DRenderer(){return U.behindModeStore.css3DRenderer}setScene(e){this._scene=e}getCurrentState(){return this.state}setState(e,n={userAction:!0}){if(this.state.disposed)return Fe();const i=hi({},this.state);this.state=Object.assign(this.state,e),i.visible!==this.state.visible&&(e.visible?this.handleShow():this.handleHide()),i.enabled!==this.state.enabled&&(e.enabled?this.handleEnable():this.handleDisable()),i.disposed!==this.state.disposed&&this.handleDispose(),this.hooks.emit("stateChange",{state:this.state,prevState:i,userAction:n.userAction})}dispose(){this.setState({disposed:!0}),this.hooks.emit("dispose")}show(){return gt(this,arguments,function*({userAction:e}={userAction:!0}){if(this.state.disposed)return Fe();this.setState({visible:!0},{userAction:e}),this.hooks.emit("show",{userAction:e})})}hide(){return gt(this,arguments,function*({userAction:e}={userAction:!0}){if(this.state.disposed)return Fe();this.setState({visible:!1},{userAction:e}),this.hooks.emit("hide",{userAction:e})})}enable({userAction:e}={userAction:!0}){if(this.state.disposed)return Fe();this.setState({enabled:!0},{userAction:e}),this.hooks.emit("enable",{userAction:e})}disable({userAction:e}={userAction:!0}){if(this.state.disposed)return Fe();this.setState({enabled:!1},{userAction:e}),this.hooks.emit("disable",{userAction:e})}getFrontCSS3DScene({createSceneIfNotExists:e=!1}={}){var n;const i=(n=U.frontModeStore)==null?void 0:n.css3DScene;if(i)return i;if(e){const r=new co;U.frontModeStore.css3DScene=r}return U.frontModeStore.css3DScene}getBehindCSS3DScene({createSceneIfNotExists:e=!1}={}){var n,i;const r=(n=U.behindModeStore)==null?void 0:n.css3DScene;if(r)return r;if(e){const l=(i=U.behindModeStore.scene)!=null?i:this.scene;if(!l){console.error(`${Ke}: scene is required when mode is behind`);return}const c=new ho(l);U.behindModeStore.css3DScene=c,U.behindModeStore.scene=l}return U.behindModeStore.css3DScene}getFrontCSS3DObjectGroup({addGroupIfNotExists:e=!0}={}){const n=this.getFrontCSS3DScene({createSceneIfNotExists:e});return e&&n&&(n.getObjectById(this.store.frontModeGroup.id)||n.add(this.store.frontModeGroup)),this.store.frontModeGroup}getBehindCSS3DObjectGroup({addGroupIfNotExists:e=!0}={}){var n;const i=this.getBehindCSS3DScene({createSceneIfNotExists:e});if(e&&i&&this.scene){const r=(n=this.store.behindModeGroup)!=null?n:new mo(this.scene);this.store.behindModeGroup=r,i.getObjectById(r.id)||i.add(r)}return this.store.behindModeGroup}render(e){var n,i;if(this.getFrontCSS3DObjectGroup({addGroupIfNotExists:!1}).CSS3DObjectLength>0){const r=this.getFrontCSS3DScene({createSceneIfNotExists:!0});if(!r)return console.error(`${Ke}: css3DScene is required when mode is front`);U.frontModeStore.css3DRenderer.renderEveryFrame(r,e)}if(((i=(n=this.getBehindCSS3DObjectGroup({addGroupIfNotExists:!1}))==null?void 0:n.CSS3DObjectLength)!=null?i:0)>0){const r=this.getBehindCSS3DScene({createSceneIfNotExists:!0});if(!r)return console.error(`${Ke}: css3DScene is required when mode is behind`);U.behindModeStore.css3DRenderer.renderEveryFrame(r,e)}}handleShow(){return gt(this,null,function*(){var e;this.store.frontModeGroup.setVisible(!0),(e=this.store.behindModeGroup)==null||e.setVisible(!0)})}handleHide(){return gt(this,null,function*(){var e;this.store.frontModeGroup.setVisible(!1),(e=this.store.behindModeGroup)==null||e.setVisible(!1)})}handleEnable(){var e,n;(e=this.getFrontCSS3DScene())==null||e.add(this.store.frontModeGroup),this.store.behindModeGroup&&((n=this.getBehindCSS3DScene())==null||n.add(this.store.behindModeGroup))}handleDisable(){var e,n,i;this.store.frontModeGroup.children.forEach(r=>{r instanceof Me&&r.element instanceof Element&&r.element.parentNode!==null&&r.element.remove()}),(e=this.store.behindModeGroup)==null||e.children.forEach(r=>{r instanceof Me&&r.element instanceof Element&&r.element.parentNode!==null&&r.element.remove()}),(n=this.getFrontCSS3DScene())==null||n.remove(this.store.frontModeGroup),this.store.behindModeGroup&&((i=this.getBehindCSS3DScene())==null||i.remove(this.store.behindModeGroup))}handleDispose(){this.handleDisable()}}oe(di,"setFrontModeContainer",Ho),oe(di,"setBehindModeContainer",Go);var qo=Object.defineProperty,Yo=(t,e,n)=>e in t?qo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,N=(t,e,n)=>(Yo(t,typeof e!="symbol"?e+"":e,n),n);const Xi=1,pi=`CSS3DObjectPlus@${Xi}`,Xo=.00216,Qo=.003;class Zo extends Me{constructor(e){var n,i,r,l,c;if(Yn(e.cornerPoints)&&Yn(e.width))throw new Error("cornerPoints and width cannot be both empty");const u=(n=e.container)!=null?n:document.createElement("div"),a=(i=e.cornerPoints)!=null?i:(()=>{const E=e.width/2;return[new W(-E,E,0),new W(-E,-E,0),new W(E,-E,0),new W(E,E,0)]})(),p=(r=e.ratio)!=null?r:Qo,d=(l=e.dpr)!=null?l:1,v=(c=e.pointerEvents)!=null?c:"auto",b=Math.max(Xo,p),x=a[0].distanceTo(a[1]),_=a[1].distanceTo(a[2]),m=wt(x/p*d),g=wt(_/p*d),w=Zt(...a);let S;if(b===p)u.style.width=`${m}px`,u.style.height=`${g}px`,S=u;else{const E=document.createElement("div");E.style.width=`${m}px`,E.style.height=`${g}px`,E.style.pointerEvents="none";const T=p/b;u.style.position="absolute",u.style.left="0",u.style.top="0",u.style.width=`${T*m}px`,u.style.height=`${T*g}px`,E.appendChild(u),S=E}if(super(S),N(this,"version",Xi),N(this,"isCSS3DObjectPlus",!0),N(this,"isCSS3DObject",!0),N(this,"name",pi),N(this,"container"),N(this,"width"),N(this,"height"),N(this,"domWidthPx"),N(this,"domHeightPx"),N(this,"cornerPoints"),N(this,"centerPosition"),N(this,"ratio"),N(this,"mode","front"),N(this,"hooks",new un),N(this,"opacityMesh"),N(this,"selfVisible",!0),N(this,"setVisible",E=>{this.selfVisible=E,this.visible=Ei(this.parent)&&this.selfVisible,this.opacityMesh&&(this.opacityMesh.visible=this.visible)}),N(this,"updateVisible",()=>{this.setVisible(this.selfVisible)}),N(this,"createOpacityMesh",E=>{const{domWidthPx:T,domHeightPx:V}=E,B=new fs(T,V);return B.position.copy(E.position),B.rotation.copy(E.rotation),B.scale.copy(E.scale),B}),u.style.pointerEvents=v,Object.assign(u.style,e.style),this.scale.set(b,b,b),this.cornerPoints=a,this.ratio=p,this.container=u,e.mode&&(this.mode=e.mode),b===p)this.width=x,this.height=_,this.domWidthPx=m,this.domHeightPx=g,this.centerPosition=w;else{const E=p/b;this.width=E*x,this.height=E*_,this.domWidthPx=E*m,this.domHeightPx=E*g,this.centerPosition=new W().subVectors(w,a[0]).multiplyScalar(E).add(a[0])}u.classList.add(`${pi}__container`);const M=new W().subVectors(a[1],a[0]),P=new W().subVectors(a[3],a[0]),$=new W().crossVectors(M,P).normalize();this.lookAt($);const C=this.up.clone().applyQuaternion(this.quaternion),j=P.clone(),I=new W().crossVectors(C,j).normalize();this.rotateOnWorldAxis(I,C.angleTo(j)),this.position.copy(w),this.addEventListener("added",()=>{var E;this.mode==="front"&&((E=this.opacityMesh)==null||E.removeFromParent())}),this.addEventListener("removed",()=>{var E;(E=this.opacityMesh)==null||E.removeFromParent()})}removeFromParent(){var e;const n=this.parent;return n!==null&&n.remove(this),(e=this.opacityMesh)==null||e.removeFromParent(),this}removeOpacityMesh(){var e;return(e=this.opacityMesh)==null||e.removeFromParent(),this.opacityMesh=void 0,this}dispose(){var e;this.container.remove(),this.removeFromParent(),(e=this.opacityMesh)==null||e.removeFromParent()}getOpacityMesh(){if(this.opacityMesh)return this.opacityMesh;{const e=this.createOpacityMesh(this);return this.opacityMesh=e,e}}applyMatrix4(e){var n;super.applyMatrix4(e),(n=this.opacityMesh)==null||n.applyMatrix4(e)}applyQuaternion(e){var n;return super.applyQuaternion(e),(n=this.opacityMesh)==null||n.applyQuaternion(e),this}applyScaleMatrix4(e){var n;this.scale.applyMatrix4(e),(n=this.opacityMesh)==null||n.scale.applyMatrix4(e)}}var Jo=Object.defineProperty,Ko=(t,e,n)=>e in t?Jo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,k=(t,e,n)=>(Ko(t,typeof e!="symbol"?e+"":e,n),n),ea=(t,e,n)=>new Promise((i,r)=>{var l=a=>{try{u(n.next(a))}catch(p){r(p)}},c=a=>{try{u(n.throw(a))}catch(p){r(p)}},u=a=>a.done?i(a.value):Promise.resolve(a.value).then(l,c);u((n=n.apply(t,e)).next())});const ta=new cn;class Qi{constructor(e,n,i){k(this,"container"),k(this,"visible",!1),k(this,"enabled",!1),k(this,"visibles",[]),k(this,"wrapper"),k(this,"positionsForRotate"),k(this,"intersectCheck",!0),k(this,"extraObjectsForIntersectCheck",[]),k(this,"simulate3D",!1),k(this,"tagWrapper"),k(this,"five"),k(this,"originPosition"),k(this,"transformedPosition"),k(this,"disposer"),k(this,"config"),k(this,"fiveUtil"),k(this,"disposers",[]),k(this,"onModeChange",()=>{this.visibles[3]=void 0,this.updateVisible()}),k(this,"onPanoArrived",()=>{this.visibles[3]=void 0,this.updateVisible()}),k(this,"onCameraUpdate",()=>{this.visible!==!1&&this.updateScreenPosition()}),k(this,"onCameraFovUpdate",()=>{this.onCameraUpdate(),this.five.off("render.prepare",this.onCameraUpdate),this.five.on("render.prepare",this.onCameraUpdate),setTimeout(()=>{this.five.off("render.prepare",this.onCameraUpdate)},1e3)}),k(this,"onFiveEveryReady",()=>{this.five.state.mode!=="Panorama"&&this.updateVisible()}),k(this,"updateVisible",()=>{this.visible&&(this.updateIntersectCheckVisible(),this.needsRender=!0)}),k(this,"applyVisible",()=>{this.visibles[3]===!0||this.visibles.every(u=>u!==!1)?(this.container.style.opacity="1",this.container.style.pointerEvents="auto"):(this.container.style.opacity="0",this.container.style.pointerEvents="none")}),k(this,"updateIntersectCheckVisible",()=>{var u,a;if(!this.position)return;if(!this.intersectCheck){this.visibles[1]=!0;return}let p=!1,d=.01;this.fiveUtil.workUtil.fromType==="poincare"&&(d=.05);const v=this.transformedPosition.clone().sub(this.five.camera.position).normalize();bt.set(this.five.camera.position,v);const b=(u=Ct(this.five).intersectRaycaster(bt))!=null?u:[],x=(a=bt.intersectObjects(this.extraObjectsForIntersectCheck,!0))!=null?a:[],_=[...b,...x].sort((m,g)=>m.distance-g.distance)[0];_?p=(_==null?void 0:_.distance)+d>this.transformedPosition.distanceTo(this.five.camera.position):p=!0,this.visibles[1]=p});var r,l,c;this.five=e,this.fiveUtil=(r=e.__fiveUtil__)!=null?r:e.__fiveUtil__=new rs(e),this.originPosition=n?ae(n).clone():void 0,this.transformedPosition=(l=this.originPosition)==null?void 0:l.clone(),this.positionsForRotate=(c=i==null?void 0:i.positionsForRotate)==null?void 0:c.map(u=>ae(u).clone()),this.config=i??{},this.container=(()=>{const u=document.createElement("div");return u.classList.add("light-tag"),u.style.width="0",u.style.height="0",u.style.position="absolute",i!=null&&i.disableOpacityTransition||(u.style.transition="opacity 0.2s linear"),u})(),this.addResizeListener(),this.show(),this.enable(),setTimeout(()=>{this.updateVisible(),this.needsRender=!0},0)}get position(){return this.transformedPosition}set needsRender(e){this.applyVisible()}show(e){this.visible=!0,this.visibles[0]=!0,e!=null&&e.force&&(this.visibles[3]=!0),this.container.style.opacity="1",this.container.style.pointerEvents="auto",this.updateVisible(),this.onCameraUpdate()}hide(){this.visible=!1,this.visibles[0]=!1,this.container.style.opacity="0",this.container.style.pointerEvents="none"}enable(){return ea(this,null,function*(){var e,n,i,r;if(this.enabled||(this.enabled=!0,yield yo(this.five),!this.enabled))return;if(this.wrapper=(n=this.config.wrapper)!=null?n:(e=this.five.getElement())==null?void 0:e.parentElement,!this.wrapper){console.error("lighttag: wrapper is required");return}const l=`light-tag-wrapper-${(r=(i=this.config)==null?void 0:i.namespace)!=null?r:"default"}`;if(!this.tagWrapper){let u=Array.from(this.wrapper.children).find(a=>a.id===l);if(!u){const a=document.createElement("div");u=a,a.id=l,a.style.position="absolute",a.style.overflow="hidden",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.pointerEvents="none",a.style.zIndex="1",this.wrapper.appendChild(u)}this.tagWrapper=u}this.tagWrapper.appendChild(this.container),this.updateVisible();const c=cs(this.five,this.onFiveEveryReady);this.five.on("cameraUpdate",this.onCameraUpdate),this.five.on("cameraFovUpdate",this.onCameraFovUpdate),this.five.on("panoArrived",this.onPanoArrived),this.five.on("modeChange",this.onModeChange),this.disposer=()=>{c(),this.five.off("cameraUpdate",this.onCameraUpdate),this.five.off("cameraFovUpdate",this.onCameraFovUpdate),this.five.off("panoArrived",this.onPanoArrived),this.five.off("modeChange",this.onModeChange)}})}disable(){var e;this.enabled&&(this.enabled=!1,this.tagWrapper&&this.container&&this.tagWrapper.contains(this.container)&&this.tagWrapper.removeChild(this.container),(e=this.disposer)==null||e.call(this))}destroy(){this.disable(),this.container.remove(),this.disposers.forEach(e=>e())}setPosition(e,n){this.transformedPosition=ae(e).clone(),this.positionsForRotate=n==null?void 0:n.map(i=>ae(i).clone()),this.onCameraUpdate(),setTimeout(()=>this.onCameraUpdate(),0)}setTransformMatrix(e){var n;this.transformedPosition=(n=this.originPosition)==null?void 0:n.clone().applyMatrix4(e),this.onCameraUpdate()}updateScreenPosition(){var e;if(!this.transformedPosition){this.container.style.left="-100%",this.container.style.top="-100%";return}const n=(e=this.five.renderer)==null?void 0:e.getSize(ta);if(!n){this.container.style.left="-100%",this.container.style.top="-100%";return}const i=Vt(this.five.camera,this.transformedPosition,n);if(!i){this.container.style.left="-100%",this.container.style.top="-100%";return}const r=(()=>{if(!this.simulate3D)return 1;const c=3*Math.tan(.5*this.five.camera.fov/180*Math.PI),u=this.transformedPosition.distanceTo(this.five.camera.position);return Math.max(Math.min(1-c*u/40,1),.75)})(),l=(()=>{if(this.positionsForRotate===void 0||this.positionsForRotate.length!==2)return 0;const[c,u]=this.positionsForRotate,a=Vt(this.five.camera,c,n),p=Vt(this.five.camera,u,n);if(!a||!p)return 0;const d=a.leftPx>p.leftPx?p:a,v=a.leftPx>p.leftPx?a:p,b=v.leftPx-d.leftPx,x=v.topPx-d.topPx;return Math.atan2(x,b)*(180/Math.PI)})();this.container.style.left=i.leftPx+"px",this.container.style.top=i.topPx+"px",this.container.style.transformOrigin="center",this.container.style.transform=`scale(${r})`,l&&(this.container.style.transform+=` rotate(${l}deg)`)}addResizeListener(){const e=this.five.getElement();if(e){const{observe:n,unobserve:i}=as(this.onCameraUpdate,e);n(),this.disposers.push(i)}}}var na=Object.defineProperty,ia=Object.defineProperties,ra=Object.getOwnPropertyDescriptors,Ot=Object.getOwnPropertySymbols,Zi=Object.prototype.hasOwnProperty,Ji=Object.prototype.propertyIsEnumerable,an=(t,e,n)=>e in t?na(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fi=(t,e)=>{for(var n in e||(e={}))Zi.call(e,n)&&an(t,n,e[n]);if(Ot)for(var n of Ot(e))Ji.call(e,n)&&an(t,n,e[n]);return t},mi=(t,e)=>ia(t,ra(e)),sa=(t,e)=>{var n={};for(var i in t)Zi.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&Ot)for(var i of Ot(t))e.indexOf(i)<0&&Ji.call(t,i)&&(n[i]=t[i]);return n},Q=(t,e,n)=>(an(t,typeof e!="symbol"?e+"":e,n),n);const oa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sHDgwCEMBJZu0AAAAdaVRYdENvbW1lbnQAAAAAAENyZWF0ZWQgd2l0aCBHSU1QZC5lBwAABM5JREFUWMO1V0tPG2cUPZ4Hxh6DazIOrjFNqJs0FIMqWFgWQkatsmvVbtggKlSVRVf5AWz4AWz4AUSKEChll19QJYSXkECuhFxsHjEhxCYm+DWGMZ5HF72DJq4bAzFXurI0M/I5997v3u9cC65vTJVn2lX/xHINQOYSBLTLEuIuCWw4Z3IGAEvf6ASmVHjNzHCXBG4A0AjACsAOwEbO0nsFQBnAGYASAIl+ZRMR7SolMEdsByD09fV5R0ZGgg8ePPjW5/N1iqLYpuu6RZblciKR2I9Go69evnwZnZ+fjwI4IS8AKBIRzeQfJWCANwKwh0KhtrGxsYehUOin1tbW+zzP23ietzY2NnIAoGmaLsuyUiqVyvl8XtrY2NiamZn589mzZxsAUgCOAeQAnFI2tI+VxIjaAeDzoaGh7xYWFuZOTk6OZVk+12uYqqq6JEnn0Wg0OT4+/geAXwGEAdwDIFJQXC1wO4DWR48e/RCPxxclSSroVzRFUbSDg4P848ePFwH8DuAhkWih83TRQWxFOXgAwvDwcOfo6OhvXV1d39tsNtuVBwTDWBwOh1UUxVsMw1hXVlbSdCgNV43uYSvrHg6H24aHh38eHBz85TrgF9FYLHA4HLzH43FvbW2d7u/vG+dANp8FpqIlbd3d3V8Fg8EfBUFw4BONZVmL3+9vHhkZCQL4AoAHgJPK8G+yzC0XDofdoVAo5PP5vkadTBAEtr+/39ff3x8gAp/RPOEqx2qjx+NpvXv3bk9DQ0NDvQgwDIOWlhZrMBj8kgi0UJdxRgYMArzL5XJ7vd57qLPZ7Xamp6fnNgBXtQxcjFuHw+Hyer3t9SYgCAITCAScAJoBNNEY/08GOFVVrfVMv7kMNDntFD1vjIAPrlRN0xjckOm6biFQ3jwNPwDMZrOnqVTqfb3Bi8Wivru7W/VCYkwPlKOjo0IikXh7EwQikYgE4Nw0CfXKDCipVCoTj8df3QABbW1tLUc6oUgkFPMkVACUNjc337148eKvw8PDbJ2jP1taWkoCyNDVXDSECmNSK4qiKNLq6urW8+fPI/UicHx8rD59+jSVy+WOAKSJhKENwFItLtoxk8mwsixzHR0dHe3t7c5PAU+n09rs7OzJkydPYqVSaQfANoDXALIk31S2smU1TWMPDg7K5XKZ7+3t9TudTut1U7+wsFCcmJiIpdPpbQBxADsAknQWymYCOukBHYCuKApisdhpMpnURFEU79y503TVyKenpzOTk5M7e3t7MQKPV0Zv1gNm+awB0MvlshqLxfLb29uyJElWURSbXC4XXyvqxcXFs6mpqeTc3Nzu3t7e3wQcA7BPZ8Cov1pNlJplmQtAG8MwHV6v95tAINA5MDBwPxAIuLu6upr8fr/VAN3c3JQjkcjZ+vp6fnl5+d2bN29SuVzuNYAEpf01CdRChUL+X1VskHACuA3Ay3Fcu9vt7nA6nZ7m5uYWQRCaNE3jVVW15PP580KhIGUymWw2m00DOAJwSP4WwPtq4LX2Ao6USxNlQyS/RcQcdLGwlNIz6vEMAaZpNzCk2Pll94LK/cDYimxERiBwG10sxjgvEZBE0UpE6vxj+0Ct5bTaXthgEhRmja8QWNkkPGsuIpfdjpkK+cZUWTC0KredVmtD/gdlSl6EG4AMvQAAAABJRU5ErkJggg==";let vi=null;class Ua extends qi{constructor(e){var n,i,r;super(),Q(this,"name","PointMesh"),Q(this,"dom"),Q(this,"opacityBeforeHighlight"),Q(this,"highlighted",!1),Q(this,"fontMesh"),Q(this,"backgroundMesh"),Q(this,"lastRenderDomItem"),Q(this,"paramsStyle"),Q(this,"_visible",!0),Q(this,"_onAdded",()=>{this.dom||this.updateDom()}),Q(this,"_onRemoved",()=>{var x;(x=this.dom)==null||x.destroy(),this.dom=void 0}),Q(this,"_onShowed",()=>{this.dom&&(this.dom.container.style.display="block")}),Q(this,"_onHidden",()=>{this.dom&&(this.dom.container.style.display="none")});const l=e??{},c=sa(l,["point"]);this.paramsStyle=c??{};const u=new Lr;u.setAttribute("position",new Ur([0,0,0],3));const a={transparent:!0,side:gi,size:(n=e==null?void 0:e.size)!=null?n:8,map:vi||(vi=new Wr().load(oa)),sizeAttenuation:!1},p=new Vn(mi(fi({},a),{color:(i=e==null?void 0:e.color)!=null?i:16777215,depthTest:!0,opacity:(r=e==null?void 0:e.opacity)!=null?r:1})),d=new Vn(mi(fi({},a),{size:p.size,color:p.color,depthWrite:!1,depthTest:!1,opacity:p.opacity*.5})),v=new Bn(u,p),b=new Bn(u,d);this.fontMesh=v,this.backgroundMesh=b,v.name="FontMesh",b.name="BackgroundMesh",v.renderOrder=10,b.renderOrder=0,this.add(v,b),e!=null&&e.point&&this.position.copy(ae(e.point)),e&&this.setStyle(e),this.addEventListener("removed",()=>{he.cacheObject.delete(this),he.checkDom(this)}),this.addEventListener("added",()=>{he.cacheObject.add(this)}),he.checkDomEveryFrame()}get color(){return this.fontMesh.material.color}get size(){return this.fontMesh.material.size}get style(){return{color:this.color,size:this.size,opacity:this.fontMesh.material.opacity,occlusionVisibility:this.fontMesh.material.depthTest,occlusionMode:this.backgroundMesh.visible?"depthWrite":"depthTest"}}get five(){var e,n;return(n=(e=window.globalModules)==null?void 0:e.five)!=null?n:window.$five}setStyle(e){Y(e.color)&&(this.fontMesh.material.setValues({color:e.color}),this.backgroundMesh.material.setValues({color:e.color})),Y(e.size)&&(this.fontMesh.material.setValues({side:e.size}),this.backgroundMesh.material.setValues({side:e.size})),Y(e.occlusionVisibility)&&(e.occlusionVisibility?e.occlusionMode==="depthTest"?(this.fontMesh.material.depthTest=!1,this.backgroundMesh.visible=!1):(this.fontMesh.material.depthTest=!0,this.backgroundMesh.visible=!0):(this.fontMesh.material.depthTest=!0,this.backgroundMesh.visible=!1))}highlight(){this.highlighted||(this.highlighted=!0,this.opacityBeforeHighlight=this.fontMesh.material.opacity,this.fontMesh.material.setValues({opacity:this.opacityBeforeHighlight*Gi}))}unhighlight(){this.highlighted&&(this.highlighted=!1,this.fontMesh.material.setValues({opacity:this.opacityBeforeHighlight}))}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=nn(this,this.position).toArray().join(",");n!==this.lastRenderDomItem&&(this.updateDom(),this.lastRenderDomItem=n)}updateDom(){const e=this.paramsStyle.tip;e&&!this.dom&&(this.dom=new Qi(this.five),this.dom.intersectCheck=!1,this.dom.simulate3D=!0,this.dom.container.style.display=this.visible?"block":"none");const n=i=>{this.dom&&this.dom.__text!==i&&(this.dom.__text=i,i instanceof HTMLElement?(this.dom.container.innerHTML="",this.dom.container.appendChild(i)):i?this.dom.container.innerHTML=Yi(i,{style:""}):this.dom.container.innerHTML="")};e?(n(e),this.dom.setPosition(this.position.clone())):n(null)}}export{ss as A,Ei as B,Jt as C,qi as D,un as E,Ua as F,Ta as G,Gi as H,he as I,nn as J,Ra as K,Pa as L,la as M,Yi as N,za as O,$a as P,qn as Q,Qi as R,os as S,Yt as T,ti as W,Ea as Y,yo as a,ae as b,Zt as c,qr as d,rs as e,Hn as f,We as g,bt as h,Y as i,ca as j,Me as k,wt as l,wa as m,as as n,ua as o,fs as p,cs as q,Ct as r,ls as s,Yn as t,di as u,va as v,Zo as w,F as x,et as y,La as z};
