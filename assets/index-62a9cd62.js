import{Q as Fh,E as it,W as ja,a as xc,v as Oc,C as Nh,O as ft,r as jc,w as Wh,z as Ft,A as ro,e as Xh,c as xi,B as Qh,D as Et,b as he,i as xe,F as Dn,L as $h,G as Gh,H as _h,I as Vi,J as Ec,R as Uh,K as Vh,N as Yh,t as Ea,u as Mc,g as qh,P as Jh,S as Cc,T as Zh}from"./Point-d3172315.js";import{c as Nt,V as O,aC as Kh,aj as tn,aY as en,g as ta,D as We,h as eu,b7 as tu,b8 as nu,i as iu,b9 as ru,M as ue,m as jt,C as Ic,a$ as Dc,b0 as Sc,l as Ie,aX as ke,o as fr,aW as pt,u as Oi,a_ as su,a2 as Dr,s as On,L as ou,aB as au,aT as jn,z as kc,N as Ma,Q as js,U as lu,y as Ca,ap as Ia,aM as Da,aN as Es,aO as cu,x as ie,aP as hu,v as K,ai as Sa,ak as Yi,a9 as uu,a8 as Sr,ab as na,aA as du,aG as pu,B as ze,aQ as Bt,aR as fu,aS as vu,d as Ve,ah as gu,E as nt,ax as mu,t as ct,aU as re,ay as yu,az as bu,af as wu,ae as Pu,Y as ka,W as Au,Z as xu,al as za,P as Xe,aV as Ou,b4 as ju,b5 as zc,w as Lc,aa as Eu,aZ as Ye,a7 as Mu,bc as Cu,be as Iu,bf as Du}from"./index-85b64ddc.js";function Su(){console.debug("%c %c@realsee/dnalogel %cv3.70.4",["background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAMCAMAAACHgmeRAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABLFBMVEUAAAAapPoap/oaqvkbrfkbr/gZnfwZoPsaqfnD4v/E4/8Ylv0clPm93/+/4P/B4f8Yj/683/8Wif+33P8Uhv+x2f8ShP+s1v8Pgf+n0/8Nf/+h0f8Lff8Lff8Nf/9dl/+czv8KfP8KfP+Lxf+Uyv+Xy/+Hwv+Jw/+Mxf+Oxv+RyP8aovsapfoap/oZmfwZm/wZnvsYnPsYkf4YlP0NePsDYfgYcfi43f+63v8Xiv8Xjf4EWfwCV/sWZ/qz2v+02/8Vh/8WiP8EUf8CTf4WXv2u1/+v2P8Thf8Thv8ETf8CR/8VV/+o1f+q1f8Qgv8Rg/8DSv8BRf8UVP+j0v+k0v8OgP8Pgf8DR/8DQv9Nhf+dzv+fz/+Kv/+Vyv+Xy/+azf+Oxv+Qx/+SyP////8MUhLdAAAAK3RSTlMACEWQ2bd98uQECPXxqO7c+Pb49vj2+Pb49vj23Oul8fMHA+TwerXXjEIG2P+bHgAAAAFiS0dEY1y+LaoAAAB+SURBVAjXY2BgZGJmYWVgYGBgY9fW0eVg4ORi4NbTNzDk4eXjZxAwMjYxNTO3EGQQsrSytrG1sxdmEHFwdHJ2cXUTZRBz9/D08vbxFWeQ8PMPCAwKDpFkkAoNC4+IjIqWZpCRlZOPiY2LV2BQVGJQTkhMUlEFWaOmrqGpxQAAyg0S9Dq+VPYAAAAASUVORK5CYII=')","background-repeat: no-repeat","background-position: 0 center","padding-left: 8px"].join(";"),"","background-color: #12ce9b;color:black;padding:0 6px;border-radius: 3px")}function ku(){const n=typeof OffscreenCanvas<"u",e=n&&new OffscreenCanvas(1,1).getContext("webgl")!==null;n&&!e&&Object.assign(window,{OffscreenCanvas:function(t,i){const r=document.createElement("canvas");return r.width=t,r.height=i,r}})}function zu(){}const La=()=>Promise.resolve(),Ha={__queue:Promise.resolve()};function B0(n=La){Ha.__queue=Ha.__queue.then(n).catch(La)}function R0(n,e,t){const i=n.x,r=n.y,s=Math.floor(i/e*1e4)/1e4,o=Math.floor(r/t*1e4)/1e4;return{x:s,y:o}}function F0(n,e,t){const{x:i,y:r}=n,s=i*e,o=r*t;return{x:s,y:o}}function N0(n){if(n.length<2)return{};const e=n.slice(-2),t=e[0],i={x:(e[0].x+e[1].x)/2,y:(e[0].y+e[1].y)/2};return{control:t,end:i}}function W0(n,e,t=zu){new Promise(i=>{setTimeout(()=>{t(),i(!0)},e*n)})}const Lu=window,Ta=window.requestAnimationFrame||Lu.webkitRequestAnimationFrame||(n=>setTimeout(n,16));function Hu(n,e=0){e<=0?Ta(n):Ta(()=>Hu(n,e-1))}var Tu=Object.defineProperty,Bu=(n,e,t)=>e in n?Tu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ge=(n,e,t)=>(Bu(n,typeof e!="symbol"?e+"":e,t),t);let Ru=class{constructor(e,t){ge(this,"width"),ge(this,"height"),ge(this,"containerDom"),ge(this,"hooks",new it),ge(this,"canvas",document.createElement("canvas")),ge(this,"config"),ge(this,"state",{enabled:!1}),ge(this,"five"),ge(this,"scale"),ge(this,"offset",{x:0,y:0}),ge(this,"context"),ge(this,"renderCenter",new O),ge(this,"hammer"),ge(this,"offsetRange"),ge(this,"isPanning",!1),ge(this,"imageData",new ImageData(1,1)),ge(this,"onPanstart",()=>{this.isPanning=!0,this.canvas.style.boxShadow="0 2px 30px 0 rgba(0,0,0,0.20)"}),ge(this,"onPan",l=>{if(!this.isPanning||!this.offsetRange||this.hooks.emit("wantsPanGesture",l))return;const{translateX:d,translateY:f}=this.getPanOffset(l,this.offsetRange);this.canvas.style.transform=`translate3d(${d}px, ${f}px, 100px)`}),ge(this,"onPanend",l=>{if(this.isPanning=!1,this.canvas.style.boxShadow="none",!this.offsetRange)return;const{translateX:d,translateY:f}=this.getPanOffset(l,this.offsetRange);this.canvas.style.transform=`translate3d(${d}px, ${f}px, 100px)`,this.offset={x:d,y:f}});var i,r,s,o;if(!e.renderer){console.error("Five Render 未初始化");return}this.five=e,this.scale=(i=t==null?void 0:t.scale)!=null?i:2,this.width=(r=t==null?void 0:t.width)!=null?r:190,this.height=(o=(s=t==null?void 0:t.height)!=null?s:t==null?void 0:t.width)!=null?o:190,this.config={dragEnabled:(t==null?void 0:t.dragEnabled)||!1,autoFixPCPosition:(t==null?void 0:t.autoFixPCPosition)||!1,initialPosition:(t==null?void 0:t.initialPosition)||{left:"0",top:"0"},skipPanorama:(t==null?void 0:t.skipPanorama)||!1};const a=this.canvas.getContext("2d");if(!a)throw new Error("CANNOT CREATE CONTEXT2D");this.context=a,this.config.dragEnabled&&(this.hammer=new Fh(this.canvas),this.hammer.on("pan",this.onPan),this.hammer.on("panstart",this.onPanstart),this.hammer.on("panend",this.onPanend)),this.initStyle()}enable(){if(!this.state.enabled)return this.state.enabled=!0,this.containerDom&&this._appendTo(this.containerDom),this}disable(){if(this.state.enabled)return this.state.enabled=!1,this.canvas.style.visibility="hidden",this.canvas.remove(),this}dispose(){var e;this.clear(),this.disable(),(e=this.hammer)==null||e.destroy()}appendTo(e){var t;return this.containerDom&&((t=this.containerDom)==null||t.removeChild(this.canvas)),this.containerDom=e,this.state.enabled&&this._appendTo(e),this}clear(){var e;return(e=this.context)==null||e.clearRect(0,0,this.canvas.width,this.canvas.height),this}renderWithPoint(e){this.containerDom&&this.state.enabled&&(this.renderCenter=e,this.render(),this.config.autoFixPCPosition&&this.autoFixPCPosition())}renderWithScreenPoint(e){this.containerDom&&this.state.enabled&&(this.renderCenter=e,this.render(),this.config.autoFixPCPosition&&this.autoFixPCPosition())}resetOffset(){this.offset={x:0,y:0},this.canvas.style.transform="translate3d(0px, 0px, 100px)"}updateScale(e){e>0&&(this.scale=e)}updateSize(e,t){if(e>0){this.width=e,this.height=t||e;const i=1;this.canvas.setAttribute("width",(this.width*i).toString()),this.canvas.setAttribute("height",(this.height*i).toString()),this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px";const r=Math.floor(this.width*i),s=Math.floor(this.height*i);this.imageData=new ImageData(r,s),this.clear()}}render(){if(!this.five.renderer||!this.containerDom)return;const{scale:e,context:t,width:i,height:r}=this,s=this.five.renderer.getSize(new Nt),[o,a]=(()=>{if(this.renderCenter.isVector3){const w=this.renderCenter.clone().project(this.five.camera);return[(w.x+1)/2*s.x,(w.y+1)/2*s.y]}else return[this.renderCenter.x,s.y-this.renderCenter.y]})(),l=1,d=i/e,f=r/e,g=l*e,v=new Map;this.five.scene.traverse(w=>{w.disableGetPixel===!0&&(v.set(w,w.visible),w.visible=!1)});try{const w=this.five.getPixels({x:o-d/2,y:a-d/2,width:d,height:f,pixelRatio:g,skipPanorama:this.config.skipPanorama});v.forEach((D,B)=>{B.visible=D});const x=Math.floor(i*l),M=Math.floor(r*l),k=x*M*4;if(!w||w.length!==k){console.warn("Magnifier: Invalid pixel data",{pixelsLength:w==null?void 0:w.length,expectedLength:k,imageWidth:x,imageHeight:M});return}Fu(w,x,M),(this.imageData.width!==x||this.imageData.height!==M)&&(this.imageData=new ImageData(x,M)),this.imageData.data.length!==w.length&&(console.warn("Magnifier: ImageData size mismatch",{imageDataLength:this.imageData.data.length,pixelsLength:w.length,imageWidth:x,imageHeight:M}),this.imageData=new ImageData(x,M));try{this.imageData.data.set(w)}catch(D){console.error("Magnifier: Failed to set pixel data",{error:D,imageDataLength:this.imageData.data.length,pixelsLength:w.length,imageWidth:x,imageHeight:M});return}t.putImageData(this.imageData,0,0),this.canvas.style.visibility="visible"}catch(w){console.error("Magnifier render error:",w),v.forEach((x,M)=>{M.visible=x})}}getRenderCenter(){return this.renderCenter}_appendTo(e){if(this.resetOffset(),e.appendChild(this.canvas),!this.offsetRange){const t=this.canvas.getBoundingClientRect(),i=e.getBoundingClientRect(),r=i.right-t.right,s=i.bottom-t.bottom,o=i.left-t.left,a=i.top-t.top;this.offsetRange={min:{x:o,y:a},max:{x:r,y:s}}}}autoFixPCPosition(){if(!this.containerDom)return;const{width:e,height:t}=this,{clientWidth:i,clientHeight:r}=this.containerDom,[s,o,a]=(()=>{if(this.renderCenter.isVector3){const l=this.renderCenter.clone().project(this.five.camera);return[(l.x+1)/2*i,-(l.x-1)/2*i,-(l.y-1)/2*r]}else return[this.renderCenter.x,i-this.renderCenter.x,this.renderCenter.y]})();s<183?(this.canvas.style.top=-t/2+"px",this.canvas.style.left="90px"):a<183?(this.canvas.style.top="90px",this.canvas.style.left=-e/2+"px"):o<183?(this.canvas.style.top=-t/2+"px",this.canvas.style.left=-e-90+"px"):(this.canvas.style.left=-e/2+"px",this.canvas.style.top=-t-90+"px"),this.canvas.style.transform=`translate3d(${s}px, ${a}px, 10px)`,this.offset={x:s,y:a}}initStyle(){const e=this.canvas;e.classList.add("five-plugin__magnifier"),e.style.position="absolute",e.style.pointerEvents=this.config.dragEnabled?"all":"none",e.style.borderRadius="50%",e.style.zIndex="99";const t=1;e.setAttribute("width",(this.width*t).toString()),e.setAttribute("height",(this.height*t).toString()),e.style.border="2px solid rgba(255,255,255,0.20)",e.style.width=this.width+"px",e.style.height=this.height+"px",e.style.top=this.config.initialPosition.top,e.style.left=this.config.initialPosition.left,e.style.transform="translate(0,0,100px)",e.style.visibility="hidden",this.config.dragEnabled&&(this.canvas.style.cursor="pointer")}getPanOffset(e,t){const{min:{x:i,y:r},max:{x:s,y:o}}=t,a=this.offset.x+e.deltaX,l=this.offset.y+e.deltaY,d=Math.min(Math.max(a,i),s),f=Math.min(Math.max(l,r),o);return{translateX:d,translateY:f}}};function qi(n,e,t){if(!n||e<0||t<0||e>=n.length||t>=n.length){console.warn("exchange: Index out of bounds",{arrayLength:n==null?void 0:n.length,index1:e,index2:t});return}const i=n[e],r=n[t];n[e]=r,n[t]=i}function Fu(n,e,t){if(!n||e<=0||t<=0){console.warn("flipPixelsY: Invalid parameters",{pixelsLength:n==null?void 0:n.length,width:e,height:t});return}const i=e*t*4;if(n.length<i){console.warn("flipPixelsY: Pixel array too small",{actualLength:n.length,expectedLength:i,width:e,height:t});return}const r=t/2;for(let s=1;s<=r;s++){const o=t-(s-1);for(let a=1;a<=e;a++){const l=(s-1)*e+a-1,d=(o-1)*e+a-1,f=l*4,g=d*4;f+3<n.length&&g+3<n.length&&(qi(n,f+0,g+0),qi(n,f+1,g+1),qi(n,f+2,g+2),qi(n,f+3,g+3))}}}const Nu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbYAAAGwCAYAAADFUEBtAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABtqADAAQAAAABAAABsAAAAABTZ8U6AAAtiklEQVR4Ae2dAXJbSbJdp+d7AfYSHOGVeAPek5fkNXgLjviLmRkZl+CRbtc8UBKRRalZpyIesiorMx/eIcjb+QCh//Y3hwQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkMEbgj7FKFpLA4QS+fPnyx23czJc//V498h2Oy8uXwDYCf/oF3HYWC0vgAAI3QfuP22V+uR35vYplrOsX/03w/kWAVgISmCPwX+ZKWUkCErgR+PvtiKjF9uj/iMx+C1/HOZeABJ4koLA9CdB0CRQBxKxFrLa/Tung7Ni+InEigTkCCtscSytJIATo2BC3dGYIWfvs2Hy9SGATAYVtE1jLHkkgohbxQsACgTkWn8IWEg4JbCCgsG2AasljCXArMgB6DpAWs3/i1EpAArMEFLZZnlY7m0C6snwyMuPqFiT+2Cvhi98hAQk8SUBhexKg6RIoAtyKjItbj1jCWGPxayUggSECCtsQSMtI4EYgYhVx624tYOK/8mXPIQEJDBNQ2IaBWu5oAnRh3GZkHSiIG8J3NCgvXgI7CShsO+la+zQCEa0ciBgWDlnji3VIQAIbCChsG6Ba8mgCdGSxjCsRu/IRr5WABJ4goLA9Ac9UCSwE6Nj6Y/0RsBxXviXdpQQkMEFAYZugaA0J3AnQhdG1xYsPccPKTAIS2ERAYdsE1rJHEohocQsy8xwZdGuse+8e4aMEJDBGQGEbQ2khCXz94AgCxkf8gwZf5u3P2iEBCQwSUNgGYVpKAjcC+eYRRKw7NeaBpLCFgkMCmwgobJvAWvZIAhE1bkUGAAK3zq/W8TkkIIEBAgrbAERLSOCVQISsPzgSd3x0a8xjczgkIIENBBS2DVAteSwBBGsVrV4zxx4LywuXwC4CCtsustY9kUDEio4t8/W9tO7cTuTjNUvgQwgobB+C2ZMcQoD317BX4kanhj0EjZcpgY8joLB9HGvP9PkJRKwiai1odm2f/+fuFf5mBBS23+wH4tP5yxPgViRdWy6I7iwihx/fX/6CvQAJ/G4EFLbf7Sfi8/krE+DfsEW0umvrOdensEFCK4FhAgrbMFDLHU0AQUO0sHRq3JaMdUhAApsIKGybwFr2SAIRsr7ViLAFRsSsha33su+QgASGCChsQyAtI4EbgYhabkdmRLi6M1uFbF2/JPkgAQk8T0Bhe56hFSQAgYgVHVt8iBsWX2zHZe2QgASGCChsQyAtI4EbgQhYjh6s23Yn17HOJSCBAQIK2wBES0jglUC6sBy8l9Zg8MUmBqHrGOcSkMAAAYVtAKIlJPBKIGLFsULBT7emsK2EXEtgiIDCNgTSMhK4EUC8EK0WsZ6zLzQJSGADAYVtA1RLHksggtUfCmkB63kAretjoXnhEpgmoLBNE7XeyQQQNrqzlUX22VPYVjquJTBEQGEbAmkZCdwI8KGQt0SLPazgJCCBYQIK2zBQyx1PgE9FAiICli4NG7+iFgoOCWwioLBtAmvZIwnw/hpfhsxtxxUGQrf6XUtAAgMEFLYBiJaQwCuBCBu/UxEvhG4F9NbeGutaAhL4SQL8Ev5kmuESkMAFgdxi5Fbko9uNj/wX5XRJQALvIaCwvYeaORK4JhBRQ7hi37rlSNx1Jb0SkMC7CShs70ZnogT+jUDEiiObLV6ZR+gYvYdPKwEJDBBQ2AYgWkICrwQQNUSsxWt9X633BCgBCQwSUNgGYVrqeAIRKz4wsgrX99bHwxOABKYIKGxTJK0jgfutx/XDI7zPxm1IBA4rNwlIYJiAwjYM1HJHE+DDIy1azLFHA/LiJfARBBS2j6DsOU4hEPFaOzauvTu3xCl0kNFKYJiAwjYM1HJHE0CwEC3W3IZE3AKJmKOBefES2EFAYdtB1ZqnEki3lq/TYiBkLWL4iNFKQALDBBS2YaCWO5oAHRoQ1tuSLWrZc0hAAhsIKGwboFryWAIRKwQLEYvYPZofC8oLl8BOAgrbTrrWPo1Ad2x0a2FwNe/bk6dx8nolsJWAwrYVr8UPIxCxomPj0hGw2O7c2NdKQALDBBS2YaCWO5pAxGsVsgbSe8x737kEJDBAQGEbgGgJCbwSSLdGx5bujPkKiM5t9buWgAQGCChsAxAtIYFXAmvH9gjMI8F7FK9fAhL4CQIK20/AMlQC3yEQYYto0ZHFZvRtR/bad4/yUQISGCGgsI1gtIgEXgjQsSFa2MaDD9t7ziUggQECCtsAREtI4JVAurUIFscVmKsu7ipOnwQk8E4CCts7wZkmgQcE8jvF7cYrEbvyPSilWwISeA8Bhe091MyRwDWBfE9kd2tXtxvxYa8r6ZWABN5NQGF7NzoTJfBvBBC1WDozgvC1ZU8rAQkMElDYBmFa6ngCES0+Fbl+pD9Chy9xORwSkMAGAgrbBqiWPJYAgoW4NQj24lu7uY5zLgEJPElAYXsSoOkSKAIRtO7KEDC6M9aJwVfpTiUggQkCCtsERWtI4E6gu7J4unPLHsKWPYUtFBwS2EBAYdsA1ZLHEohY0bFFxBC6R/NjQXnhEthJQGHbSdfapxFAyHLd3a09mp/Gx+uVwIcQUNg+BLMnOYRABIyOjUtmna6NW5HxeSsSQloJDBNQ2IaBWu54AnRtCFeLGbck/3WjxP7xwAQggWkCCts0UeudTCDfPJKjRwsYc76hpOOcS0ACQwQUtiGQlpHAjUCEK7cZ6cwChTmdG+KGTYxDAhIYJKCwDcK01PEEIlYcwEDAsKuftVYCEhgioLANgbSMBG4EHolad22JYS00CUhgAwGFbQNUSx5LILch+RRkQ6Bba8u845xLQAIDBBS2AYiWkMArgYhVv8fW76vRpeETmgQksImAwrYJrGWPJBBh4wiAtSt7a+9IYF60BHYQUNh2ULXmqQQQrti1M0Pk2GN9KiuvWwLbCChs29Ba+EACvMcWUVvfa+NWZLBE1BS2kHBIYAMBhW0DVEseTQDRamFrUcs8h0MCEthEQGHbBNayRxKImPGtIi1e3Z1l3kJ3JCgvWgI7CShsO+la+zQCb92KbBYKW9NwLoFhAgrbMFDLHU2A25DdoV0ByX7fqryK0ScBCbyTgML2TnCmSeCCAILVHRlzbNIyd0hAApsIKGybwFr2SALpwujaAED3ho1/jSFWKwEJDBBQ2AYgWkICrwRasBCytTvDLzQJSGATAYVtE1jLHkkgorW+d/ZIyNa4I4F50RLYQUBh20HVmqcSQNjo0rJmDpNHQse+VgISeJKAwvYkQNMlUATW99giao86MwWuwDmVwCQBhW2SprUk8OevyqKD+9cNDN1bW3lJQAIbCChsG6Ba8lgC6c440q0hYvk2Egb+7DkkIIENBBS2DVAteSyBiFVEbL0F2SKWPYcEJLCRgMK2Ea6ljyPQ3RoXH1HLgaAhco/eeyNPKwEJvJOAwvZOcKZJ4IIAYhW7Chni1vaihC4JSOBZAgrbswTNl8A3AhEtxI3ODCFLVPu+ZTmTgARGCShsozgtdjiBCBdHUKRruxKz9ifOIQEJDBJQ2AZhWup4AhGxdGyxLV6IG4CyXn3saSUggScJKGxPAjRdAkUgYsX7a9ySbIEjND6HBCSwiYDCtgmsZY8kQLfW3VjPgRLflZ99rQQk8AQBhe0JeKZK4IIAHRvCRceGTUrPL0rokoAEniGgsD1Dz1wJ/JnA2rGtnVm+Witj9d+9PkpAAiMEFLYRjBaRwAsBhC2W0d0Z++0jTisBCQwRUNiGQFpGAq8E8pVa6cgQLyyAWHOrEr9WAhIYIqCwDYG0jARuBNKR5Yh4ddeGiLUf3y3UIQEJTBJQ2CZpWut0AtxqjGjl6O6MOYwUNkhoJTBMQGEbBmq5owkgaIgWlk4NccMeDcuLl8AuAgrbLrLWPZEAtyK59ghbixjC1z5itRKQwBABhW0IpGUk8EqA99jo1uLuuaLmS0UCmwkobJsBW/4oAnRsES9Gd2nxIXJY4rQSkMAQAYVtCKRlJHAjgFjRtQVKfBE6fKyz55CABDYQUNg2QLXksQQiWhGwDESuhax9zO/RPkpAAmMEFLYxlBaSwIuYRbA4rpCke/N9tisy+iQwREBhGwJpGQncCETQeJ8tQHivLf51Hp9DAhLYQEBh2wDVkscSiFjlK7UYLV49Z18rAQlsIKCwbYBqyWMJRNT4kMgVhIhbd25XMfokIIEnCShsTwI0XQJFIMJFZ4Zlm/fV8PMhE/a1EpDAEAGFbQikZSRwIxDRWju2+CJq7Y8PgbtNHRKQwCQBhW2SprVOJ0AXhg0PRA02CBoWv1YCEhgioLANgbSMBG4EIlYRtVhuPcZm4LuvfJSABLYRUNi2obXwoQS45dhdG6IWmyMDe1/5KAEJjBFQ2MZQWkgCLx/1R7xi6dqYNyKFrWk4l8AgAYVtEKaljifQohYY3bVF5BA6bk8eD0wAEthBQGHbQdWaJxNAzBC5sEDQ6NxYn8zJa5fANgIK2za0Fj6QQIQrwhbbo9eZ/+t2tK9jnUtAAk8SUNieBGi6BIpARC3fPtIdGfPYDAQNe/f6KAEJjBFQ2MZQWkgCL6IVwWrRYo4Npv4+SbFJQALDBBS2YaCWO5rA+l2RLWbducXfe0dD8+IlME1AYZsmar2TCSBYV6KFD8uHTE7m5bVLYAsBhW0LVoseSmAVtn5fjXnQIG6HYvKyJbCXgMK2l6/VzyPQnVgLWM9DpePOo+QVS2AjAYVtI1xLH0cgYpWju7OGEHFjbxW6jnMuAQk8QUBhewKeqRJYCETUECwsIRG0+HIgbuxpJSCBQQIK2yBMS0ngRqA7NoQMMPmH2Rmr/+71UQISGCGgsI1gtIgEXghE1DJiW+BenLcH/vE2a60EJLCBgMK2AaoljyWQTqxFDaFrIN21td+5BCQwREBhGwJpGQncCCBsb91qpGtLjEMCEthAQGHbANWSxxJIh4aoxfIhkRaxK9+xwLxwCewgoLDtoGrNkwn090C2oMEkPm5H4tNKQAKDBBS2QZiWOp5Ad2x8vD9Q6NIyj7ARl7VDAhIYJqCwDQO13NEEEK1AoFuLqK0fImnROxqYFy+BHQQUth1UrXkqAYQN4cLGn3kGc4Tv7vVRAhIYI6CwjaG0kARe/p1aBKtFizk2mHouNglIYJiAwjYM1HLHE8htR7qzfi+tPzASYVPcjn+pCGAXAYVtF1nrnkiA99KwLV78+zW49B4+rQQkMEBAYRuAaAkJvBKIoHWXBhhEjK4ta3zEaCUggSECCtsQSMtI4JVAhC23IhE4bksiZr0WmgQksIGAwrYBqiWPJRDxQtgQstiIGevu2o4F5YVLYCcBhW0nXWufRgDxynX3e2qIXfzME+uQgAQ2EFDYNkC15LEEIlqrcCFgsd6GPPal4YV/JAGF7SNpe65TCETEELi+ZsWtaTiXwCYCCtsmsJY9kgCChqhh42f4HhsktBLYREBh2wTWskcSQNhyyzGiltGiljX+zB0SkMAGAscI25cvX/IHhj8y+ePCmj807QvqK3/7EkMNbO8zZ++RTdy6l9rk9/6Vb41lfRW7nidr6pPXMfERs+53feKI7Rr4Oqb3OX/73po/E881XFmeZyz7PA+ulfVqEx/ff3+1mSen31Pjk5F0bP/r9pr8H68x2SM2+6yxN9fX/9UN+T9iiaHO9+zVuR/l/ExsarwVv14fzxvLc2Dddt1jvdrkxIddz5l175PPua7W1GLvkU3tf77WJyY+ancd5uwnnnnb+FMzg5rYl7p//PEH9e9RBz3mF/CIUcLWfxjzyTXWWP4oscYmlr237Fs11zxi8zPIeTjXapPHf4QkJ4P42AxyqMm58K9xWa+xySEPS17Oj6/j2E8t/Fd1E7fmX8URs8ZTf/Wva/K7Nr63bNd/VLPzmV/FZi9HRvb5gxObwR8c/ohhs88c2778IYu/97LffzTZw2b/H7ej6/Temk9s/OQQv1rOu/rJw2afA99b9lHd9TzUbD/ztT6x+L8X92h/zU8cz5e9tsw7rmtnP/kZ8ffRudknjvNhqYcl78tN3DI/buSX7tTRf3xggC82Lwj+OF3tx3e1T+yP2h954fHHkfPFMu98fFfn5nrIJbbzH+Vx/t7vfObZT2zWnC++jPU8iem8xLSv89e4xDK6buJy/hw/Ovqcb51nrbcKZ+dSExZXNvU6Z62/ruGxXh/X/1YtePC8sDkHdcnnua7nz5o8LHWJpQZrLPGssWt8r3lexLYlLpbrz37W7K35+BOXwfpR/j3q22PHrfl93m8Z386Bjzhs/OvzJLZt4juO/B/l37WOmK9gPvtF8wLJdeaFwos1/gzWvIiIaU74Ov6t/MSxj8XH+fCzXm3iGZwfG3/nM8dSa81nPzYHce0nJxY/cdj2r/PEXMVR79Fe7yeGutjsM+Jb/dSNfZTfeeR3Xup3fmLyOiCPvcSR3zEdmzlHxxLfIpl6/Zx5TvFnsE5u1+rnc5Wf82cQh717v/m7bmIyOE/m5GGv4snDJi+j62TNPv5ex5d1DvaxxMXC+Tb9Wi/zq/yOoUbi1rqPfJ2feY/Uy0GtWHyJw48Pm72MrDPIyxxf5gzysPF37ayzhy/r4wYv9k9/4a8tef/A84Pnhx//jwziyMPiTw3q9rmofRXHXudSF9sxV3HU/dGf51r36rlyzr4ezt2245ivNjV4jn1u5uyteVn3Na1xa37WHMntedbkU3PNT8w6Eksce6yx1GUfm33yiY3lIK7zE5+jfcTFdp2sE8ugLjH4Y1MP/2qzT27mGTzv++r+yHMiljr4OzZz9vE/Wnc+tcnBJqbj4qfe6ienY/CRg43/rXzyiOm8dd5r8rDkZ524PvDFZvAzfVRvzb2q3b571YMeAfjpL/n1Pba+zrw4+OH3PDH9guo5+eRhOx9fYpljyWfvkZ+43ud5cK7ssc8eddtSizwsfmpc2fiI73N0/TUvex17lc8+ucRQt9f4YtfR+WvNxLKPJZ81ltzVEo9NfD+3zo8fMcDGx4Gva2VOjbbUwpe4+HqwF9t77WeePGJi8WOzz7xtzxOTQX722Mf3EvAakzn7+B+t33pu1CaGWmt9aseusexd5RLfMZyz49eanJ+/oeSvljxqYhPHQa2265w19ThP/PioHd/fTn1/LdfODyXzTz0e/JB5QeTae86Lpn0dgx+77nV+Yoh7ZJPfo/Px44td6xATyx4+1uRhiWW/4zlX7+HrOOarJfYqfz3/mpucNYY6jyznoxbrjseXmPaT05bYxBGb/cyzhw+bPQYxWWfOQU0sudi38rNHHpa678knB8u5Y+N7dA72yMOSx3rNz34G+6u97357TH5iOo6aiWp/1j2yR2zH4cNmjwMfdXpNjfYRxx7r2PgSu+7hwxIb26PzMl/XV8+j8zN/ibn4j/k17tOujxG2+lQkP8x8goixvlh4MeHHrvHxc/Re56/7iVvrxUdOz78Xl1gG+Vc5xMQmjueExR8bH7WyZsTX/vU87LW/5+THwj77HFf5OTf7mTPwYePPnLHWyh7nJ2a12adG5+MjvuPwJSZHrquvjXUsMV375r48Z/xdJ2tG51Mztv3MyYmND3/i19F7PeccxLPHOpZ6WGLIxU9O+5l3nc7HH9/qp17s1R7njWUfy3mJaT/ztX77yefnxB7noi412Mfix+LvPM7RPuLIi+39rK9i4j9mHCNsrz9RXihZXv3wr3zJwc8LiHUs80c128/51xz8if3e4DkQl1rk9x7naB9x2euDWm2pm1/crtX1Et97VzWJ59ysySW/1+27On+fp2NT42oQc/UcEo+fuK7B3vfisr/m57nnWGskltE5mRPLnDhs9nsQv/qpiz+Wj4uzlzqchzhq95r4+NpPPjnEscbih0XWfaxxrGNzPvI5P+uOy/yqJn5ief5Xsfg6h3jOzZrY2Az899WfnzP71CAmlvz2vVVr3eu8P80f3KX6U8xnXZwmbPk58kLqF8jqYy/+HPmFzFjj7t5/93c+MdjUyD4xsWtd9vAnt+dZM9b8R3Hx9x5/ZDgXlpi1LudjnzV5WfOHE1+fkzwsTK/Oc5XP+ZLPfizz7HfNrDlX5gzyk0c8cdTC4k9ufBzkxZ9BXPyJiSWG9ZVdfc0ve9S9Tb/O8WU/R0b77p5ve71+FNf+zHnu+FMj817Hl5HnjJ/ng8WfOOax7MefwR7+Pv8av66JTS75WOq+nOT1AR/xxGabeWoyf037+hy/l8/+Vd66lxjOg01Mz7vOVX728ZP3Yr0VCbozLD98XgyPrjpxxK4x5LKPTVz2Hu3jX+utecRR961fNGr1eeMjl3mv4+McmWes67v3/sgfj6yos8ZzfvZjmd+r3B/xJT5zbMdk3vmcfz1n4lZf53Eu7NW5spf62buqdXN/vY7OJy+5OThH4vGtlpyOTXwG58fevffHxJPDudbnSt7qT4Xk9CD2ytexnLPPT05qJPbqfPg6n1h8qdPzrMlj72q/fT3v3DU/cVwXOcRjk3M12CcPi5+crNtHHPucn3XHxtfrnmcvtdZ6iemaWZOHvbnOHEcBuP0XTDpUXgBYutZ13X7y2kf8lU3cz8RSI69C8mLxY/FdxcXXcdTBh1391GT/LftWLM+J/D7P1RzfWzUf1cLfdj0/e12fmCvb8ez3c4yPmNWy9z9vk/+WxW2Qmz9Iicfyx+g/b77/9+rnD9dqb9tf/3iRF9txicn60X7HMu9Y8qlBzCOb+OSvz+Mqntiuje+RvapDfnJ6/3vPoc+RzjK5Gev1v1Vnje3zrx127/U85/zR8/dzuXquXZfzr8+R9bHfPMLXNAXgpx+3e878wD/9tXqBH0/g9h9O//d21v96O/LHpwfr2LwGI3T/5/Z6/N8d5FwCEpghcJSwzSCzigQeEmjhajFLAl1b/BwPC7khAQm8n4DC9n52ZkpgJYBgxUbIesSXQcx95aMEJDBOQGEbR2rBwwlwu/vqPbagQfQQusNxefkSmCegsM0zteK5BOjGrsQLISPmXEpeuQQ2E1DYNgO2/FEE0q3RsWEDIPN+jy0+hC5zhwQkMEhAYRuEaanjCXQ31mIWMAjZao+HJgAJTBNQ2KaJWu9kAhEtOrV0aHRpfJCkhQ+BO5mX1y6BLQQUti1YLXoogVW4ELTg6D3Wh2LysiWwl4DCtpev1c8ikG5tvQWZT0ciarF0cZk7JCCBDQQUtg1QLXk0gQgW4hYQfO1Ri9rRgLx4CewmoLDtJmz9kwhExBC12Aw6tPvq/hiRs2NrIs4lMEhAYRuEaanjCSBYLVrrPOsrsTsengAkMEVAYZsiaR0J/Pt7aWGCkPU83VwLXvYcEpDAEAGFbQikZSRwIxCx4hZkC9c677XgJCCBYQIK2zBQyx1NIKKW99lyqzFHRkSMW4/47Nhe0PgggT0EFLY9XK16JoGIGN0YNiSYt2V+JimvWgIbCShsG+Fa+jgCEat0Y2vHFhB0bYlhHr9DAhIYJqCwDQO13NEEIlociFvWDPZ4Hw6/VgISGCSgsA3CtNTxBHjvDDHjW0cicuxlnkHMfeWjBCQwRkBhG0NpIQm8EOhu7B83D0IGHgQNi18rAQkMEVDYhkBaRgI3AhG1FjagRMQicG0VNuhoJTBMQGEbBmq5owlErFbBYr3ao0F58RLYSUBh20nX2qcRQNhi6dDCgDk2vqvOLn6HBCTwJAGF7UmApkugCETQECw6tGwzx1aKUwlIYJqAwjZN1HonE+A9tu7M4IEPiwCyr5WABIYIKGxDIC0jgRuBiFW6sqvODB9WYBKQwCYCCtsmsJY9kkBEK+JGVxYIzGMZCCBrrQQkMEhAYRuEaanjCUTY8iXI/3E76MxWG0jx4c/aIQEJDBJQ2AZhWup4AnRi+YfZ+daRq5GYDIXtzsFHCYwTUNjGkVrwcAII1ipu+GP7tuThuLx8CcwTUNjmmVrxXALpxujIIl65LZnB+2zM6exeNn2QgARmCShsszytdjaBdGPdmdGdtY9uDd/ZxLx6CWwgoLBtgGrJYwlErLpjy3oVsKy7gzsWlhcugV0EFLZdZK17IoEWslXQmgfi1z7nEpDAEAGFbQikZSRwI8B7Z4jaVWfmrUhfKhLYTEBh2wzY8kcRiKB1N5Y5QgYIRA+LXysBCQwRUNiGQFpGAjcCq7ABJX66N2wLIHFaCUhggIDCNgDREhJ4JcCtyAZCZ7bajnEuAQkMElDYBmFa6ngCEbb827V0ZXRmgZI5IwLHgU8rAQkMElDYBmFa6ngCCFYErr9Si24tgJhjj4cmAAlME1DYpola72QCESveO+NbRx7xUNgekdEvgScJKGxPAjRdAkUgYsXRtx8TEv/qi98hAQkME1DYhoFa7mgCES86tsyvBn7sVYw+CUjgCQIK2xPwTJXAQgBhozNDvFgjelmzt5RwKQEJPEtAYXuWoPkS+EYgwhXBQrQQsKyZJ7pjsnZIQAKDBBS2QZiWOp5ACxZiFiiP5scDE4AEdhBQ2HZQteapBCJgfbvxrXliHRKQwAYCCtsGqJY8lkDECsFi3rcgA6b3jwXlhUtgJwGFbSdda59GIP92rbs0xG3lsIrduu9aAhJ4goDC9gQ8UyWwEIiQRdzyrSN0ZkvIyzIxb+1f5eiTgAR+kIDC9oOgDJPADxCgQ+NbR1aBazHr+Q+UNkQCEvhRAgrbj5IyTgLfJ4CwxeZ24z9eU7j1iI1bYXuFo5HANAGFbZqo9U4mELHiPbYWLubYMOr5ycy8dgmME1DYxpFa8GACEasIG51ZbEaLGL77jo8SkMA4AYVtHKkFDyYQUYuIIWTYRoIP23vOJSCBAQIK2wBES0jglUDEahWsrOngEkbHtsZlzyEBCQwQUNgGIFpCAq8EIlZ9KxIwq4hlvfqI1UpAAk8SUNieBGi6BIoAgoW41daLkHXn1nvOJSCBQQIK2yBMSx1PIIKWI+OtjgwBvEf6KAEJjBJQ2EZxWuxwAqtgIW68r4boZc38cGRevgTmCShs80yteC6BfONIDoSMW48RuJ6fS8grl8AHEFDYPgCypziGAB1bd2P5Wi3WiFuA0M0dA8cLlcBHEVDYPoq05zmFACLG9fK9kVm3mPWcWK0EJDBAQGEbgGgJCbwSiKjRtdGdxTIQM/bwayUggUECCtsgTEsdTyDCxXtsiBg2cDJX1ELCIYGNBBS2jXAtfRwBRCy2Ray7Nm5VEnscJC9YArsJKGy7CVv/JAIRK4Qr1414YWFh1wYJrQQ2EFDYNkC15LEEImAcLV7dsWW/946F5YVLYBcBhW0XWeueSCDdGh1bd2k9DxfE70RGXrMEthNQ2LYj9gQHEYhgRdjoyK46tYNweKkS+DUEFLZfw92zfk4C+UQk3VhEje6Nq6Vz686OPa0EJDBEQGEbAmkZCdwI0LHF5htHMjLvDg6xQ+RegnyQgATmCChscyytJIEQ4N+x0b1d3Y5U1HytSGAjAYVtI1xLH0eAbgxLpxYQiFl3cMcB8oIl8BEEFLaPoOw5TiEQ0aJjyzUjZuv1x/9ob411LQEJ/CQBhe0ngRkugTcIrIKFeHXnlvR1/UZJtyQggZ8loLD9LDHjJfCYQG5BruKWaASOzHWNXysBCQwQUNgGIFpCAq8EELVHwtWd2qMYYUpAAk8SUNieBGi6BIpAxIoPjpT767TFrOdfA5xIQALPE1DYnmdoBQlAIGLFQXcWy0DM2MOvlYAEBgkobIMwLXU8gQhXd2yI3ArmkX+Ncy0BCbyDgML2DmimSOABgXzUP0e+dSQCR2e2dm0K2w2OQwK7CChsu8ha90QCCNY/bhePmCFudHL4E+uQgAQ2EFDYNkC15NEEELBAQLwQt/YdDcmLl8BOAgrbTrrWPo1ARK1vQXL97UPkED1itBKQwBABhW0IpGUkcCPArUhECxELHHzMex2fQwISGCKgsA2BtIwEbgTSmSFuiFrWmTPYV9ggopXAMAGFbRio5Y4msIpWi1fPj4bkxUtgNwGFbTdh659EIOKVri0DkaNzu3u/PSp031g4k8AoAYVtFKfFDieAmCFaLWr4gqj9hyPz8iUwT0Bhm2dqxXMJRLzo2EKhxaypxP9or+OcS0AC7yCgsL0DmikSeEAg3zrCR/sTgnitHdq6flBOtwQk8B4CCtt7qJkjgWsCETI+GZmv1WIgcFlnzsG+VgISGCSgsA3CtNTxBBC2gEj35pCABH4BAYXtF0D3lJ+WAN1aBC63GzOYY/H1e3EvgT5IQAIzBBS2GY5WkQAEImAc7cs8fkbP8WklIIEBAgrbAERLSOCVQMSKW5DdsWWbD4ys/tdUjQQkMEVAYZsiaR0JfPvgSFhE5BAz2MRnpwYNrQQ2EVDYNoG17JEE1vfYELIIHO+p2bEd+dLwoj+SgML2kbQ91wkEELBca3dnzLEnsPAaJfBLCChsvwS7J/2kBCJaEbb1FmT72FPgPumLwMv69QQUtl//M/AZfB4CESsEKxYRyxXiZ97r+BwSkMAQAYVtCKRlJHAjkE9ERrAQLea8rxZI+PqWZfwOCUhgiIDCNgTSMhK4EYho8XH/ALkStPgdEpDARgIK20a4lj6OQLqwfj+tAXBbEktX1zHOJSCBAQIK2wBES0igCHCrsVwvU4RstWucawlI4EkCCtuTAE2XQBG46tjo0LwtWaCcSmAnAYVtJ11rn0agu7W1M2N9GhOvVwIfTkBh+3DknvATE0DYeJ/t0aUmLjEOCUhgAwGFbQNUSx5LoAXLDu3Yl4EX/qsJKGy/+ifg+T8TgXRhdG28p5b1+j4bMZ/p2r0WCfw2BBS23+ZH4RP5BAQQLGwuKaLGrcm+/ZgYhwQksIGAwrYBqiWPJRCxyj/QplsLCEQNseu97DskIIFhAgrbMFDLHU0gIpbj77cjQsYtSOY318s+cVk7JCCBYQIK2zBQyx1NIIIVEfvHKwWEraHQsSXOIQEJbCCgsG2AasmjCUTcGJkjZPgUNEhoJbCJgMK2CaxljySw3mKkY+NWZFsF7siXiBf9EQQUto+g7DlOIRCxasG6muPDnsLG65TAhxFQ2D4MtSc6gEDEioNuLZfdtyMRNOwBWLxECXwsAYXtY3l7ts9NIGLFe2wtXD3/3AS8Ogn8BgQUtt/gh+BT+DQEELa1W4sfH1ax+zQ/di/kdyOgsP1uPxGfz1+ZQLq1CNYqWu1jD/tXvl6fuwR+SwIK22/5Y/FJ/UUJRKz6I/5Z06HFMuJX2KChlcAwAYVtGKjljieAYD2yAGKftVYCEhgioLANgbSMBG4E8o0j/E7la7XWwQdL4lfYVjquJTBEgF/CoXKWkcDxBBCsiBy3H+Nb58QdD0wAEpgmoLBNE7XeyQTSkdGV8d4aotZ+5iez8tolsI2AwrYNrYUPJBARoxPDBsPVvH0HovKSJbCPgMK2j62VzyMQsaIbo2O7ovDW3lW8PglI4CcIKGw/ActQCXyHQISNTgx7ldJxV/v6JCCBJwgobE/AM1UCC4F0ay1adGbYhGee8Zbw3SN8lIAE3kVAYXsXNpMkcEkgYsWtyAQgXtj2Ze6QgAQ2EFDYNkC15LEEEDY6tO7O2pe4FrtjgXnhEthBQGHbQdWapxJAsFq0mGPDhrhTOXndEthKQGHbitfihxH45+168zsV4UqHxm1JOreb68WnsIWEQwKbCChsm8Ba9lgCEbceiFxsBiLH+u71UQISGCOgsI2htJAEXrqxdGm8nwaSVcSyXn3EaiUggScJKGxPAjRdAkUAwULcauvr7UkEDdsxziUggQECCtsAREtI4JVAxIr31d4Sruy9tS9QCUjgCQIK2xPwTJXAQmAVLMSL99UQPdZLuksJSGCCgMI2QdEaErgTWG9B8l5bBI55IlcBvGf7KAEJjBBQ2EYwWkQCLwRasBCzbFzN43NIQAIbCChsG6Ba8lgCCBtCxjrdWt+GZH4sKC9cAjsJKGw76Vr7NAIRMkQrc8bVvH3EaSUggQECCtsAREtI4JVAC1u/p7YCemtvjXUtAQn8JAGF7SeBGS6BNwjkW0f+/rof8boaVx3dVZw+CUjgnQQUtneCM00CFwS6Y7vY/uqyY/uKwokE5gkobPNMrXguAd43i23x6u5t3TuXllcugU0EFLZNYC17JIGIVosbEPD1evWxp5WABJ4koLA9CdB0CRQBhI1u7apTq3CnEpDADgIK2w6q1jyVQH8wJKLGunnYqTUN5xLYQEBh2wDVkscSaNF6mf/xxx9fbuNm7vZYMl64BCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQn8NQn8fyHnyuSABiy2AAAAAElFTkSuQmCC",Ms=new O;let Wu=class extends Kh{expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ms.subVectors(e,this.center);const t=Ms.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(Ms,r/i),this.radius+=r}return this}};const Xu="data:image/png;base64,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";let Zn=[null,null,()=>null];function Hc(n){var e;if(Zn){if(Zn[0]===n)return Zn[2];(e=Zn[1])==null||e.dispose()}const t=new ja("front");t.domElementWrapper.style.zIndex="1";const i=new ja("behind");xc(n).then(()=>{var s;const o=(s=n.getElement())==null?void 0:s.parentElement,a=Oc(n);if(!o)return console.error("initialCSS3DRender: five element is not exist"),()=>null;if(t.appendToElement(o),t.renderEveryFrame(n.scene,n.camera),!a)return console.error("initialCSS3DRender: behindWrapper is not exist"),()=>null;i.appendToElement(a),i.renderEveryFrame(n.scene,n.camera)});const r=()=>{t.dispose(),i.dispose()};return Zn=[n,t,r],r}var Qu=Object.defineProperty,$u=(n,e,t)=>e in n?Qu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ba=(n,e,t)=>($u(n,typeof e!="symbol"?e+"":e,t),t);let Gu=class extends Nh{constructor(){super(...arguments),Ba(this,"isCSS3DSprite",!0),Ba(this,"isCSS3DObject",!0)}};var _u=Object.defineProperty,Uu=Object.defineProperties,Vu=Object.getOwnPropertyDescriptors,Ra=Object.getOwnPropertySymbols,Yu=Object.prototype.hasOwnProperty,qu=Object.prototype.propertyIsEnumerable,so=(n,e,t)=>e in n?_u(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Fa=(n,e)=>{for(var t in e||(e={}))Yu.call(e,t)&&so(n,t,e[t]);if(Ra)for(var t of Ra(e))qu.call(e,t)&&so(n,t,e[t]);return n},Na=(n,e)=>Uu(n,Vu(e)),Yt=(n,e,t)=>(so(n,typeof e!="symbol"?e+"":e,t),t);const Ju=`
varying vec2 vUv;
varying float vRadius;
varying float vDistanceToCamera;
varying float vCenterDistanceToCamera;
void main() {
  vUv = uv;
  // 计算顶点到圆心的距离
  vRadius = length(position.xy);
  // 计算顶点到摄像机的距离
  vec3 worldPosition = vec3(modelViewMatrix * vec4(position, 1.0));
  vDistanceToCamera = distance(cameraPosition, worldPosition);
  vCenterDistanceToCamera = distance(cameraPosition, vec3(0.0));

  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);
}
`,Zu=`
varying vec2 vUv;
varying float vRadius;

uniform float borderWidth;
uniform float radius;

void main() {
  vec2 uv = vUv;

  if (vRadius > radius - borderWidth && vRadius < radius) {
    // 如果顶点在边框区域，则使用边框颜色
    gl_FragColor = vec4(1.0, 1.0, 1.0, 0.3);
  } else {
    // 如果顶点在填充区域，则使用填充颜色
    gl_FragColor = vec4(1.0, 1.0, 1.0, 0.2);
  }
}
`;function Ku(){const n=new en(.2,64),e=new ta({side:We,uniforms:{borderWidth:{value:.01},radius:{value:.2}},vertexShader:Ju,fragmentShader:Zu,depthTest:!1,transparent:!0,blending:eu,blendEquation:tu,blendSrc:nu,blendDst:iu,blendDstAlpha:ru});return new ue(n,e)}function ed(){const n=new jt,e={lineWidth:1,lineColor:3407837,lineOpacity:.7,occlusionVisibility:!0},t=new ft(Na(Fa({points:[{x:-.5},{x:.5}]},e),{lineColor:3407837})),i=new ft(Na(Fa({points:[{y:-.5},{y:.5}]},e),{lineColor:3407837}));return n.add(t,i),n}function td(n){const e=new Ic;e.add(new Dc(new O(0,0,0),new O(0,0,n)));const t=new Sc(e,32,.003),i=new Ie({color:10994687,depthTest:!1,transparent:!0});return new ue(t,i)}function nd(){const n=new ke(.03,.035,64),e=new Ie({color:16777215,depthTest:!1,transparent:!0,side:We});return new ue(n,e)}function id(){const n=new fr(.018,32,32),e=new Ie({color:5085183,depthTest:!1,transparent:!0});return new ue(n,e)}function rd(){const n=document.createElement("img");n.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAVCAMAAAB8FU7dAAAAw1BMVEUAAACDuuiAsu11q/x8r/+HxtKHxtKIx9J4ut6Hx9Jcn/uNwNlmmf+RuP9ppf9orel3ud2HxtJrpf9oremev/9ppP9orelQmP9ZoPWSuP92q/9cnv9prel4ut53qv9orelYoPWIxdJPmP+HxtGRuP9oo/+Suf9Qmf92q/+RuP+DsP9Pmv+FxdFtre2SyMiRuP9PmP+evv9ppf9cnv+rxf9orepZofV4ut52q/+Dsf+Esv+5y/93q/9aofbF0f93rP9qpf8IzZ1iAAAAL3RSTlMAEg4s3dK5nodgVQoF/Pf39vbt7evr39rV1NTOzs6srJ+fiIZ9fWlpW09ERCwcHMH8LhIAAADRSURBVBjTjdDHkoMwEIThBrzOm3POOQwSYCRhe/f9n2p75FD2zX/VXL5qOAjzkixLsFL6fOFF5PwpXUj/eEwx7Oh9Jq+FdV5MqZkXlU9K4KZsmqY02x/A8LSwv14o0ylJWkP087WVhDfcjmjj5b/E3+CEpDPdGY58C7tKfzSiiA9uB4dV/NIF7yVQ7AGuq0lOIzrvnLP2Et2aMzUqryge8FVX0Zjl5XkG3KsR593pM2zVEScjvbMU7IdGjF19IzZ43Ceyve4Ai5Jep93u9BJs3j/gXjHbRgy31AAAAABJRU5ErkJggg==";const e=new Gu(n);return n.style.pointerEvents="none",e.scale.set(.003,.003,.003),e}let sd=class extends tn{constructor(e){super(),Yt(this,"disableGetPixel",!0),Yt(this,"planeMesh"),Yt(this,"ringMesh"),Yt(this,"crossline"),Yt(this,"lineMesh"),Yt(this,"ballMesh"),Yt(this,"cssBallMesh");const t=.18;this.planeMesh=Ku(),this.ringMesh=nd(),this.crossline=ed(),this.lineMesh=td(t),this.ballMesh=id(),this.cssBallMesh=rd(),this.ballMesh.position.setZ(t),this.cssBallMesh.position.setZ(t),this.planeMesh.renderOrder=0,this.ringMesh.renderOrder=1,this.crossline.renderOrder=2,this.lineMesh.renderOrder=3,this.ballMesh.renderOrder=4,this.add(this.planeMesh,this.lineMesh,this.ballMesh,this.ringMesh,this.cssBallMesh),Hc(e)}updateWithIntersect(e){if(!e.face)return;const t=(()=>{const r=e.face.normal.clone().normalize();return r.y>.99?new O(0,1,0):r.y<-.99?new O(0,-1,0):r.x>.99?new O(1,0,0):r.x<-.99?new O(-1,0,0):r.z>.99?new O(0,0,1):r.z<-.99?new O(0,0,-1):r.y<.01&&r.y>-.01?new O(r.x,0,r.z):r})(),i=new O().addVectors(e.point,t);this.position.copy(e.point),this.lookAt(i)}show(){this.visible=!0,this.add(this.cssBallMesh)}hide(){this.visible=!1,this.remove(this.cssBallMesh)}dispose(){}};const od="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;var ad=Object.defineProperty,ld=Object.defineProperties,cd=Object.getOwnPropertyDescriptors,Wa=Object.getOwnPropertySymbols,hd=Object.prototype.hasOwnProperty,ud=Object.prototype.propertyIsEnumerable,Xa=(n,e,t)=>e in n?ad(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dd=(n,e)=>{for(var t in e||(e={}))hd.call(e,t)&&Xa(n,t,e[t]);if(Wa)for(var t of Wa(e))ud.call(e,t)&&Xa(n,t,e[t]);return n},pd=(n,e)=>ld(n,cd(e));function ji(n,e,t){const i=fd(n,e);return t!=null&&t.virtualPoint?i??Tc(e):i}function Tc(n,e=3){const t=new O().addVectors(n.ray.origin,n.ray.direction.clone().normalize().multiplyScalar(e)),i=n.ray.direction.clone().negate();return{distance:e,point:t,object:new tn,face:new pt(0,0,0,i),raycaster:n,isVirtual:!0}}function fd(n,e){const t=jc(n).intersectRaycaster(e)[0];if(t)return pd(dd({},t),{raycaster:e,isVirtual:!1})}function vd(n,e){const{x:t,y:i}=e,r=t*2-1,s=i*2-1,o=new Oi;return o.setFromCamera({x:r,y:s},n.camera),o.params.Points.threshold=.02,o}const Qa=`url("data:image/svg+xml,%3Csvg width='12px' height='12px' viewBox='0 0 12 12' xmlns='http://www.w3.org/2000/svg'%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cpath d='M6,12 C9.3137085,12 12,9.3137085 12,6 C12,2.6862915 9.3137085,0 6,0 C2.6862915,0 0,2.6862915 0,6 C0,9.3137085 2.6862915,12 6,12 Z' fill='%23FF5959'%3E%3C/path%3E%3Cg transform='translate(2, 2)' stroke='%23FFFFFF'%3E%3Ccircle cx='4' cy='4' r='4'%3E%3C/circle%3E%3Cline x1='1.07141075' y1='1.23997894' x2='6.64700843' y2='6.81557662'%3E%3C/line%3E%3C/g%3E%3C/g%3E%3C/svg%3E") 6 6, auto`;var gd=Object.defineProperty,md=(n,e,t)=>e in n?gd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Kn=(n,e,t)=>(md(n,typeof e!="symbol"?e+"":e,t),t);const yd=`
varying vec2 vUv;
void main() {
  vUv = uv;
  vec4 mvPosition = modelViewMatrix * vec4(position, 1);
  gl_Position = projectionMatrix * mvPosition;
}
`,bd=`
varying vec2 vUv;
void main() {
  vec2 uv = vec2(vUv.x, vUv.y);
  float a = 1.0;
  float match = 1.0 - uv.x;
  gl_FragColor = vec4(1.0,1.0,1.0,match);
}
`;function wd(){const n=new su(.4,.4),e=Nu,t=new Dr().load(e);t.encoding=On,t.minFilter=ou;const i=new Ie({map:t,transparent:!0,depthTest:!1});return new ue(n,i)}function Pd(){const n=new Ic;n.add(new Dc(new O(0,0,0),new O(0,0,.1)));const e=new Sc(n,8,.003),t=new ta({vertexShader:yd,fragmentShader:bd,depthTest:!1,transparent:!0});return new ue(e,t)}function Ad(){const n=new fr(.01,20,20),e=new Ie({color:10349931,depthTest:!1,transparent:!0,side:We}),t=new ue(n,e);return t.position.set(0,0,.1),t}function xd(){const n=new Wh({pointerEvents:"none",cornerPoints:[new O(-.2,.2,0),new O(-.2,-.2,0),new O(.2,-.2,0),new O(.2,.2,0)]}),e=document.createElement("div");return e.style.width="100%",e.style.height="100%",e.style.backgroundImage=`url(${Xu})`,e.style.backgroundSize="100%",e.style.backgroundRepeat="no-repeat",n.container.appendChild(e),n}let Od=class extends tn{constructor(e){super(),Kn(this,"planeMesh"),Kn(this,"lineMesh"),Kn(this,"ballMesh"),Kn(this,"borderMesh"),Kn(this,"five"),this.planeMesh=wd(),this.lineMesh=Pd(),this.ballMesh=Ad(),this.borderMesh=xd(),this.addEventListener("added",()=>{this.add(this.planeMesh,this.lineMesh,this.ballMesh,this.borderMesh)}),this.addEventListener("removed",()=>{this.remove(this.planeMesh,this.lineMesh,this.ballMesh,this.borderMesh)}),Hc(e),this.five=e}updateWithIntersect(e){var t;const i=(t=e==null?void 0:e.face)!=null&&t.normal?new O().addVectors(e.point,e.face.normal):this.five.camera.position;this.position.copy(e.point),this.lookAt(i)}show(){this.visible=!0,this.borderMesh.parent||this.add(this.borderMesh)}hide(){this.visible=!1,this.remove(this.borderMesh)}dispose(){var e;(e=this.planeMesh.material.map)==null||e.dispose()}};var jd=Object.defineProperty,Ed=Object.defineProperties,Md=Object.getOwnPropertyDescriptors,$a=Object.getOwnPropertySymbols,Cd=Object.prototype.hasOwnProperty,Id=Object.prototype.propertyIsEnumerable,oo=(n,e,t)=>e in n?jd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Dd=(n,e)=>{for(var t in e||(e={}))Cd.call(e,t)&&oo(n,t,e[t]);if($a)for(var t of $a(e))Id.call(e,t)&&oo(n,t,e[t]);return n},Sd=(n,e)=>Ed(n,Md(e)),et=(n,e,t)=>(oo(n,typeof e!="symbol"?e+"":e,t),t);let kd=class{constructor(e,t){et(this,"five"),et(this,"hooks",new it),et(this,"position",null),et(this,"magnifier",null),et(this,"pointHelper",null),et(this,"state",{enabled:!1,visible:!0}),et(this,"group",new jt),et(this,"show",()=>{var d,f;this.state.visible||(this.state.visible=!0,(d=this.pointHelper)==null||d.show(),(f=this.magnifier)==null||f.enable(),this.five.needsRender=!0)}),et(this,"hide",()=>{var d,f;this.state.visible&&(this.state.visible=!1,(d=this.pointHelper)==null||d.hide(),(f=this.magnifier)==null||f.disable(),this.five.needsRender=!0)}),et(this,"updateWithIntersect",(d,f={emitEvent:!0})=>{var g;if(!d)return;this.abortUpdateMagnifier(),this.position=d,f.emitEvent&&this.hooks.emit("intersectionUpdate",d),(g=this.pointHelper)==null||g.updateWithIntersect(d);const v=()=>{var w;return(w=this.magnifier)==null?void 0:w.renderWithPoint(d.point)};this.abortUpdateMagnifier=()=>this.five.off("renderFrame",v),this.five.once("renderFrame",v),this.five.needsRender=!0}),et(this,"abortUpdateMagnifier",()=>{});var i,r,s,o,a;this.five=e,this.magnifier=(t==null?void 0:t.magnifier)!==void 0?t.magnifier:new Ru(e,Sd(Dd({dragEnabled:!0},t==null?void 0:t.magnifierParams),{skipPanorama:(i=t==null?void 0:t.skipPanorama)!=null?i:!1}));let l=null;(t==null?void 0:t.pointHelper)==="default"||(t==null?void 0:t.pointHelper)===void 0?l=new Od(e):(t==null?void 0:t.pointHelper)==="highlight"?l=new sd(e):(t==null?void 0:t.pointHelper)===null?l=null:l=t.pointHelper,this.pointHelper=l,this.group.name="five-point-selector",this.five.scene.add(this.group),(a=this.magnifier)==null||a.appendTo((o=(s=t.container)!=null?s:(r=e.getElement())==null?void 0:r.parentElement)!=null?o:document.body)}enable(){var e;this.state.enabled||(this.state.enabled=!0,this.pointHelper&&this.group.add(this.pointHelper),(e=this.magnifier)==null||e.enable(),this.five.needsRender=!0,this.hooks.emit("enabled"))}disable(){var e;this.state.enabled&&(this.state.enabled=!1,this.pointHelper&&this.group.remove(this.pointHelper),(e=this.magnifier)==null||e.disable(),this.hooks.emit("disabled"))}dispose(){this.hooks.off(),this.disable(),this.magnifier=null,this.pointHelper=null}};var zd=Object.defineProperty,Ld=Object.defineProperties,Hd=Object.getOwnPropertyDescriptors,Ga=Object.getOwnPropertySymbols,Td=Object.prototype.hasOwnProperty,Bd=Object.prototype.propertyIsEnumerable,ao=(n,e,t)=>e in n?zd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qt=(n,e)=>{for(var t in e||(e={}))Td.call(e,t)&&ao(n,t,e[t]);if(Ga)for(var t of Ga(e))Bd.call(e,t)&&ao(n,t,e[t]);return n},_a=(n,e)=>Ld(n,Hd(e)),V=(n,e,t)=>(ao(n,typeof e!="symbol"?e+"":e,t),t);const Ua=new O,Pn=()=>!1;let Rd=class extends it{constructor(e,t){var i,r,s,o,a;super(),V(this,"_cursorError",!1),V(this,"actionIfNoIntersection","virtualPoint"),V(this,"plane"),V(this,"planeMode","onlyVirtual"),V(this,"pointSelectorHelper"),V(this,"five"),V(this,"hook",this),V(this,"adhereEnabled",!0),V(this,"adhereRadius",.1),V(this,"adherePlane",[]),V(this,"adhereLine",[]),V(this,"_outOfFive",!1),V(this,"_enabled",!1),V(this,"mode"),V(this,"pressDown",!1),V(this,"adherePoints"),V(this,"setPressDown"),V(this,"lastFiveHelperVisible"),V(this,"lastIntersection"),V(this,"mousePosition"),V(this,"_mouseDownInfo"),V(this,"_touchStartInfo"),V(this,"config",{}),V(this,"select",f=>{f&&this.updatePointSelectorHelperIntersect(f);const g=this.emit("wantsSelect",this.position);return g||(this.pointSelectorHelper.hide(),this.emit("select",this.position),console.debug(this.position)),!g}),V(this,"onKeyDown",f=>{f.key==="Shift"&&(this.adhereEnabled=!1)}),V(this,"onKeyUp",f=>{f.key==="Shift"&&(this.adhereEnabled=!0)}),V(this,"onMouseWheel",f=>{this.updateByMousePosition(f);const g=()=>this.updateByMousePosition();this.five.off("render.prepare",g),this.five.on("render.prepare",g),setTimeout(()=>{this.five.off("render.prepare",g)},200)}),V(this,"onEnter",()=>{this.cursorError||this.pointSelectorHelper.show(),this.outOfFive=!1}),V(this,"onMouseEnter",()=>{this.onEnter(),this.emit("intersectionUpdate",this.position)}),V(this,"onMouseLeave",()=>{this.pointSelectorHelper.hide(),this.outOfFive=!0,this.emit("intersectionUpdate",void 0)}),V(this,"onMouseDown",f=>{this._mouseDownInfo={clientX:f.clientX,clientY:f.clientY,timestamp:performance.now()}}),V(this,"onMouseUp",f=>{if(!this._mouseDownInfo)return;const{clientX:g,clientY:v,timestamp:w}=this._mouseDownInfo;Math.abs(f.clientX-g)<2&&Math.abs(f.clientY-v)<2&&performance.now()-w<500?this.select():this._mouseDownInfo=null}),V(this,"onTouchStart",f=>{this._touchStartInfo={clientX:f.touches[0].clientX,clientY:f.touches[0].clientY,timestamp:performance.now()},this.setPressDown=setTimeout(()=>{if(this.setPressDown=void 0,this.mousePosition={clientX:f.touches[0].clientX,clientY:f.touches[0].clientY},!this.mouseNdcPosition)return;const g=this.updateByNdcPosition(this.mouseNdcPosition);this.pressDown=g},200)}),V(this,"onTouchMove",f=>{if(this.setPressDown){let g=!1;if(this._touchStartInfo){const{clientX:v,clientY:w}=this._touchStartInfo;(Math.abs(f.touches[0].clientX-v)>2||Math.abs(f.touches[0].clientY-w)>2)&&(g=!0)}g&&(clearTimeout(this.setPressDown),this.setPressDown=void 0);return}if(this.pressDown){if(this.mousePosition={clientX:f.touches[0].clientX,clientY:f.touches[0].clientY},!this.mouseNdcPosition)return;this.updateByNdcPosition(this.mouseNdcPosition)}}),V(this,"onTouchEnd",f=>{if(this.setPressDown){clearTimeout(this.setPressDown),this.setPressDown=void 0;return}this.pressDown&&(setTimeout(()=>{this.pressDown=!1},100),this.select())}),V(this,"updateByMousePosition",f=>{if(this.five.getElement()){if(!f||(f==null?void 0:f.buttons)!==0){this.pointSelectorHelper.hide();return}else this.pointSelectorHelper.show();f&&(this.mousePosition={clientX:f.clientX,clientY:f.clientY}),this.updateByNdcPosition(this.mouseNdcPosition)}}),V(this,"updateByNdcPosition",f=>{var g,v,w;const x=vd(this.five,f);let M=ji(this.five,x);if(M){if(this.plane&&this.planeMode==="vertical"&&(M=_a(qt({},M),{point:this.plane.projectPoint(M.point,new O),face:new pt(0,0,0,this.plane.normal.clone()),originalPoint:M.point.clone()})),this.plane&&this.planeMode==="onlyPlane"){const k=x.ray.intersectPlane(this.plane,Ua);if(!k)return!1;M={distance:this.five.camera.position.distanceTo(k),point:k.clone(),originalPoint:M.point.clone(),face:new pt(0,0,0,this.plane.normal.clone()),raycaster:x}}return this.updatePointSelectorHelperIntersect(M),this.lastIntersection=M,!0}if(this.plane){const k=x.ray.intersectPlane(this.plane,Ua);if(k){const D={distance:this.five.camera.position.distanceTo(k),point:k.clone(),object:new tn,face:new pt(0,0,0,this.plane.normal.clone()),raycaster:x,isVirtual:!0};return this.updatePointSelectorHelperIntersect(D),!0}}if(this.actionIfNoIntersection==="lastPoint")return this.updatePointSelectorHelperIntersect(this.lastIntersection),!0;if(this.actionIfNoIntersection==="virtualPoint"){const k=Tc(x,(g=this.lastIntersection)==null?void 0:g.distance);return k.face=new pt(0,0,0,(w=(v=this.lastIntersection)==null?void 0:v.face)==null?void 0:w.normal),k.isVirtual=!0,this.lastIntersection=k,this.updatePointSelectorHelperIntersect(k),!0}else if(this.actionIfNoIntersection==="disable")return this.updatePointSelectorHelperIntersect(null),!1}),V(this,"updatePointSelectorHelperIntersect",f=>{var g,v,w,x,M,k,D,B;if(!f){this.pointSelectorHelper.hide(),this.pointSelectorHelper.position=f,this.emit("intersectionUpdate",f),this.five.getElement().style.cursor=Qa;return}this.onEnter(),this.cursorError||(this.five.getElement().style.cursor="");const S=qt({},f);if(this.adhereEnabled&&this.mouseNdcPosition&&this.five.renderer){const C={x:this.mouseNdcPosition.x,y:1-this.mouseNdcPosition.y},W=this.five.renderer.getSize(new Nt);if(this.adhereEnabled&&typeof this.adherePoints=="function"&&typeof this.adhereRadius=="number"){for(const T of this.adherePlane){const R=T.distanceToPoint(f.point);let N=T.projectPoint(f.point,new O);(!this.plane||this.plane.distanceToPoint(N)<.01)&&(N=(v=(g=this.plane)==null?void 0:g.projectPoint(N,new O))!=null?v:N,R<this.adhereRadius&&(S.point=N.clone(),S.adherePoint=N.clone(),this.plane||(S.face=new pt(0,0,0,T.normal.clone())),S.isAdsorbed=!0))}for(const T of this.adhereLine){let R=T.closestPointToPoint(f.point,!1,new O);if(R.distanceTo(f.point)<this.adhereRadius)(!this.plane||this.plane.distanceToPoint(R)<.01)&&(R=(x=(w=this.plane)==null?void 0:w.projectPoint(R,new O))!=null?x:R,S.point=R.clone(),S.adhereLine=T.clone(),S.isAdsorbed=!0);else{const N=Ft({raycaster:new ro(this.five.camera.position,f.point.clone().sub(this.five.camera.position).normalize()),line:T,clampToLine:!1}),Q=N.clone().project(this.five.camera);if(Q.z<=1){const h={x:(Q.x+1)/2,y:(1-Q.y)/2},u={x:Math.abs(h.x-C.x)*W.width,y:Math.abs(h.y-C.y)*W.height};let p=N.clone();u.x<10&&u.y<10&&(!this.plane||this.plane.distanceToPoint(p)<.01)&&(p=(k=(M=this.plane)==null?void 0:M.projectPoint(p,new O))!=null?k:p,S.point=p.clone(),S.adhereLine=T.clone(),S.isAdsorbed=!0)}}}for(const T of this.adherePoints({intersection:f,pointSelectorInstance:this})){const R=T instanceof pt?new O(T.a,T.b,T.c):T;if(R.IsAlwaysVisible=T.IsAlwaysVisible,!(this.plane&&this.plane.distanceToPoint(R)>.01))if(R.distanceTo(f.point)<this.adhereRadius){S.point=(B=(D=this.plane)==null?void 0:D.projectPoint(R,new O))!=null?B:R.clone(),!this.plane&&T instanceof pt&&(S.face=T),S.isAdsorbed=!0;break}else{const N=R.clone().project(this.five.camera);if(N.z>1)continue;const Q=this.five.renderer.getSize(new Nt),h={x:(N.x+1)/2,y:(1-N.y)/2},u={x:Math.abs(h.x-C.x)*Q.width,y:Math.abs(h.y-C.y)*Q.height};if(u.x<10&&u.y<10){let p=!1;if(R.IsAlwaysVisible)p=!0;else{const y=new Oi;y.setFromCamera(R.clone(),this.five.camera);const b=this.five.model.intersectRaycaster(y,void 0,!0)[0],A=.1,j=this.five.camera.position.distanceTo(R);b&&b.distance<j+A&&(p=!0)}if(p){S.point=R.clone(),!this.plane&&T instanceof pt&&(S.face=T),S.isAdsorbed=!0;break}}}}}}this.pointSelectorHelper.updateWithIntersect(S,{emitEvent:!1}),this.emit("intersectionUpdate",S)}),V(this,"mousePositionToNdcPosition",f=>{const g=this.five.getElement();if(!g)return null;const{top:v,left:w,width:x,height:M}=g.getBoundingClientRect(),{clientX:k,clientY:D}=f;return{x:(k-w)/x,y:1-(D-v)/M}}),V(this,"onFiveWantsPanGesture",()=>{if(this.pressDown)return!1}),V(this,"renderScreenCenter",()=>{this.updateByNdcPosition({x:.5,y:.5})}),V(this,"emitIntersectionUpdate",f=>{this.emit("intersectionUpdate",f)}),this.five=e,this.config=qt(qt({},this.config),t),this.actionIfNoIntersection=(r=(i=t==null?void 0:t.actionIfNoIntersection)!=null?i:t==null?void 0:t.actionIfNoModelUnderMouse)!=null?r:"virtualPoint";const l=(s=t==null?void 0:t.mode)!=null?s:"auto";l==="auto"?this.mode=od?"fixed":"cursor":this.mode=l;const d={autoFixPCPosition:this.mode==="cursor",initialPosition:this.mode==="fixed"?{left:"35%",top:"20%"}:void 0};this.pointSelectorHelper=new kd(this.five,_a(qt({},t==null?void 0:t.helper),{magnifierParams:qt(qt({},d),(o=t==null?void 0:t.helper)==null?void 0:o.magnifierParams),skipPanorama:(a=t==null?void 0:t.skipPanorama)!=null?a:!1})),this.pointSelectorHelper.hide()}get position(){if(!this.outOfFive)return this.pointSelectorHelper.position}get outOfFive(){return this._outOfFive}get enabled(){return this._enabled}get cursorError(){return this._cursorError}set cursorError(e){this._cursorError=e,this.five.getElement().style.cursor=e?Qa:"",e?this.pointSelectorHelper.hide():this.pointSelectorHelper.show()}set outOfFive(e){this._outOfFive=e}set enabled(e){this._enabled=e}get mouseNdcPosition(){return this.mousePosition?this.mousePositionToNdcPosition(this.mousePosition):null}enable(){if(this.enabled)return;this.enabled=!0,this.outOfFive=!1,this.pointSelectorHelper.enable(),this.pointSelectorHelper.hide();const e=this.five.getElement();if(!e)throw new Error("five element not found");this.mode==="cursor"?(this.five.on("wantsMoveToPano",Pn),this.five.on("wantsChangeMode",Pn),this.five.on("wantsTapGesture",Pn),e.addEventListener("touchstart",this.onTouchStart,{passive:!0}),e.addEventListener("touchmove",this.onTouchMove),e.addEventListener("touchend",this.onTouchEnd),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),e.addEventListener("mousemove",this.updateByMousePosition),e.addEventListener("wheel",this.onMouseWheel),e.addEventListener("mouseenter",this.onMouseEnter),e.addEventListener("mouseout",this.onMouseLeave),this.five.on("wantsPanGesture",this.onFiveWantsPanGesture)):this.mode==="fixed"&&(this.five.on("panoArrived",this.renderScreenCenter),this.five.on("panGesture",this.renderScreenCenter),this.five.on("interiaPan",this.renderScreenCenter),this.renderScreenCenter(),this.pointSelectorHelper.show()),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),this.pointSelectorHelper.hooks.on("intersectionUpdate",this.emitIntersectionUpdate),this.lastFiveHelperVisible=this.five.helperVisible,this.five.helperVisible=!1,this.emit("enable")}disable(){if(!this.enabled)return;this.enabled=!1,this.adherePoints=null,this.adhereLine=[],this.adherePlane=[],this.plane=void 0,this.pointSelectorHelper.disable(),this.five.getElement().style.cursor="";const e=this.five.getElement();this.five.off("wantsPanGesture",this.onFiveWantsPanGesture),this.five.off("wantsMoveToPano",Pn),this.five.off("wantsChangeMode",Pn),this.five.off("wantsTapGesture",Pn),this.five.helperVisible=this.lastFiveHelperVisible,e==null||e.removeEventListener("touchstart",this.onTouchStart),e==null||e.removeEventListener("touchmove",this.onTouchMove),e==null||e.removeEventListener("touchend",this.onTouchEnd),e==null||e.removeEventListener("mousedown",this.onMouseDown),e==null||e.removeEventListener("mouseup",this.onMouseUp),e==null||e.removeEventListener("mousemove",this.updateByMousePosition),e==null||e.removeEventListener("wheel",this.onMouseWheel),e==null||e.removeEventListener("mouseenter",this.onMouseEnter),e==null||e.removeEventListener("mouseout",this.onMouseLeave),this.five.off("panoArrived",this.renderScreenCenter),this.five.off("panGesture",this.renderScreenCenter),this.five.off("interiaPan",this.renderScreenCenter),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),this.pointSelectorHelper.hooks.off("intersectionUpdate",this.emitIntersectionUpdate),this.emit("disable")}dispose(){this.disable(),this.pointSelectorHelper.dispose()}setAdherePoints(e,t){e?typeof e=="function"?this.adherePoints=e:this.adherePoints=()=>e:this.adherePoints=null}};function ia(n){return Rc(n,"box3")}function Fd(n){return Rc(n,"sphere")}function Va(n){return Bc(n,"box3")}function Bc(n,e){const t=e==="box3"?new au:new Wu,i=new O;if(n.updateWorldMatrix(!1,!1),n.traverse(r=>{var s;if(r.name==="shadow"||r.type==="Line2")return;const o=r.geometry;if(r.updateWorldMatrix(!1,!1),o!==void 0){const a=(s=o==null?void 0:o.attributes)==null?void 0:s.position;if(a)for(let l=0,d=a.count;l<d;l++)i.fromBufferAttribute(a,l).applyMatrix4(r.matrixWorld),t.expandByPoint(i);else o.vertices&&o.vertices.forEach(l=>{const d=l.clone().applyMatrix4(r.matrixWorld);t.expandByPoint(d)})}}),!t.isEmpty())return t}function Rc(n,e){const t=Bc(n,e);return t&&t.applyMatrix4(Nd(n.matrixWorld.clone())),t}const Nd=n=>{const e=n.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],d=e[7],f=e[8],g=e[9],v=e[10],w=e[11],x=e[12],M=e[13],k=e[14],D=e[15],B=g*k*d-M*v*d+M*l*w-a*k*w-g*l*D+a*v*D,S=x*v*d-f*k*d-x*l*w+o*k*w+f*l*D-o*v*D,C=f*M*d-x*g*d+x*a*w-o*M*w-f*a*D+o*g*D,W=x*g*l-f*M*l-x*a*v+o*M*v+f*a*k-o*g*k,T=t*B+i*S+r*C+s*W;if(T===0)return n.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const R=1/T;return e[0]=B*R,e[1]=(M*v*s-g*k*s-M*r*w+i*k*w+g*r*D-i*v*D)*R,e[2]=(a*k*s-M*l*s+M*r*d-i*k*d-a*r*D+i*l*D)*R,e[3]=(g*l*s-a*v*s-g*r*d+i*v*d+a*r*w-i*l*w)*R,e[4]=S*R,e[5]=(f*k*s-x*v*s+x*r*w-t*k*w-f*r*D+t*v*D)*R,e[6]=(x*l*s-o*k*s-x*r*d+t*k*d+o*r*D-t*l*D)*R,e[7]=(o*v*s-f*l*s+f*r*d-t*v*d-o*r*w+t*l*w)*R,e[8]=C*R,e[9]=(x*g*s-f*M*s-x*i*w+t*M*w+f*i*D-t*g*D)*R,e[10]=(o*M*s-x*a*s+x*i*d-t*M*d-o*i*D+t*a*D)*R,e[11]=(f*a*s-o*g*s-f*i*d+t*g*d+o*i*w-t*a*w)*R,e[12]=W*R,e[13]=(f*M*r-x*g*r+x*i*v-t*M*v-f*i*k+t*g*k)*R,e[14]=(x*a*r-o*M*r-x*i*l+t*M*l+o*i*k-t*a*k)*R,e[15]=(o*g*r-f*a*r+f*i*l-t*g*l-o*i*v+t*a*v)*R,n},Wd="//vr-image-4.realsee-cdn.cn",Y0="//vr-image-4.realsee-cdn.cn/release/web/arrow1.ebe7d0ff.png",q0="//vr-image-4.realsee-cdn.cn/release/web/arrow-white.5c2c79a5.png",J0="//vr-image-4.realsee-cdn.cn/release/web/PanoSpatialTagPlugin__blur.png",Z0="//vr-image-4.realsee-cdn.cn/release/web/test.09dee741.png",K0="//vr-image-4.realsee-cdn.cn/release/web/dipan2.f38a21cc.FBX",e1="//vr-public.realsee-cdn.cn/release/web/entryDoorMini/Anim_Door1.fbx",t1="//vr-image-4.realsee-cdn.cn/release/web/saas/missing-floorplan.e274c596.png";var Fc=function(){if(typeof Map<"u")return Map;function n(e,t){var i=-1;return e.some(function(r,s){return r[0]===t?(i=s,!0):!1}),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var i=n(this.__entries__,t),r=this.__entries__[i];return r&&r[1]},e.prototype.set=function(t,i){var r=n(this.__entries__,t);~r?this.__entries__[r][1]=i:this.__entries__.push([t,i])},e.prototype.delete=function(t){var i=this.__entries__,r=n(i,t);~r&&i.splice(r,1)},e.prototype.has=function(t){return!!~n(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,i){i===void 0&&(i=null);for(var r=0,s=this.__entries__;r<s.length;r++){var o=s[r];t.call(i,o[1],o[0])}},e}()}(),lo=typeof window<"u"&&typeof document<"u"&&window.document===document,vr=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Xd=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(vr):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),Qd=2;function $d(n,e){var t=!1,i=!1,r=0;function s(){t&&(t=!1,n()),i&&a()}function o(){Xd(s)}function a(){var l=Date.now();if(t){if(l-r<Qd)return;i=!0}else t=!0,i=!1,setTimeout(o,e);r=l}return a}var Gd=20,_d=["top","right","bottom","left","width","height","size","weight"],Ud=typeof MutationObserver<"u",Vd=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=$d(this.refresh.bind(this),Gd)}return n.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},n.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},n.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},n.prototype.connect_=function(){!lo||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Ud?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!lo||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=t===void 0?"":t,r=_d.some(function(s){return!!~i.indexOf(s)});r&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),Nc=function(n,e){for(var t=0,i=Object.keys(e);t<i.length;t++){var r=i[t];Object.defineProperty(n,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return n},Sn=function(n){var e=n&&n.ownerDocument&&n.ownerDocument.defaultView;return e||vr},Wc=kr(0,0,0,0);function gr(n){return parseFloat(n)||0}function Ya(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(i,r){var s=n["border-"+r+"-width"];return i+gr(s)},0)}function Yd(n){for(var e=["top","right","bottom","left"],t={},i=0,r=e;i<r.length;i++){var s=r[i],o=n["padding-"+s];t[s]=gr(o)}return t}function qd(n){var e=n.getBBox();return kr(0,0,e.width,e.height)}function Jd(n){var e=n.clientWidth,t=n.clientHeight;if(!e&&!t)return Wc;var i=Sn(n).getComputedStyle(n),r=Yd(i),s=r.left+r.right,o=r.top+r.bottom,a=gr(i.width),l=gr(i.height);if(i.boxSizing==="border-box"&&(Math.round(a+s)!==e&&(a-=Ya(i,"left","right")+s),Math.round(l+o)!==t&&(l-=Ya(i,"top","bottom")+o)),!Kd(n)){var d=Math.round(a+s)-e,f=Math.round(l+o)-t;Math.abs(d)!==1&&(a-=d),Math.abs(f)!==1&&(l-=f)}return kr(r.left,r.top,a,l)}var Zd=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof Sn(n).SVGGraphicsElement}:function(n){return n instanceof Sn(n).SVGElement&&typeof n.getBBox=="function"}}();function Kd(n){return n===Sn(n).document.documentElement}function ep(n){return lo?Zd(n)?qd(n):Jd(n):Wc}function tp(n){var e=n.x,t=n.y,i=n.width,r=n.height,s=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,o=Object.create(s.prototype);return Nc(o,{x:e,y:t,width:i,height:r,top:t,right:e+i,bottom:r+t,left:e}),o}function kr(n,e,t,i){return{x:n,y:e,width:t,height:i}}var np=function(){function n(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=kr(0,0,0,0),this.target=e}return n.prototype.isActive=function(){var e=ep(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},n}(),ip=function(){function n(e,t){var i=tp(t);Nc(this,{target:e,contentRect:i})}return n}(),rp=function(){function n(e,t,i){if(this.activeObservations_=[],this.observations_=new Fc,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return n.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Sn(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new np(e)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Sn(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(i){return new ip(i.target,i.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),Xc=typeof WeakMap<"u"?new WeakMap:new Fc,Qc=function(){function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=Vd.getInstance(),i=new rp(e,t,this);Xc.set(this,i)}return n}();["observe","unobserve","disconnect"].forEach(function(n){Qc.prototype[n]=function(){var e;return(e=Xc.get(this))[n].apply(e,arguments)}});var n1=function(){return typeof vr.ResizeObserver<"u"?vr.ResizeObserver:Qc}();function ht(n){return n*180/Math.PI}var sp=Object.defineProperty,op=(n,e,t)=>e in n?sp(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Jt=(n,e,t)=>(op(n,typeof e!="symbol"?e+"":e,t),t);let ap=class{constructor(e,t){Jt(this,"VERSION","3.70.4"),Jt(this,"NAME"),Jt(this,"five"),Jt(this,"workUtil"),Jt(this,"fiveUtil"),Jt(this,"hooks",new it),Jt(this,"staticPrefix",Wd),this.five=e,this.fiveUtil=new Xh(e),this.workUtil=this.fiveUtil.workUtil,t!=null&&t.staticPrefix&&(this.staticPrefix=t.staticPrefix)}set workCode(e){this.workUtil.workCode=e,this.onWorkCodeChange()}get workCode(){return this.workUtil.workCode}updateFive(e){this.five=e,this.fiveUtil.five=e,this.workUtil.five=e}getCurrentState(){return this.state}onWorkCodeChange(){}};function co(n,e,t=4){return Math.abs(n-e)<Math.pow(10,-t)}function lp(n,e,t=4){const i=Math.PI*2,r=n%i,s=e%i,o=Math.min(r,s),a=Math.max(r,s);return co(o,a,t)||co(o+i,a,t)}Object.assign(window,{nearlyEqual:co,nearlyEqualRad:lp});/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */var $c={},Fe=void 0,cp=$c;function ra(n,e){var t=n.split("."),i=cp;!(t[0]in i)&&i.execScript&&i.execScript("var "+t[0]);for(var r;t.length&&(r=t.shift());)!t.length&&e!==Fe?i[r]=e:i=i[r]?i[r]:i[r]={}}var se=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u"&&typeof DataView<"u";function hi(n){var e=n.length,t=0,i=Number.POSITIVE_INFINITY,r,s,o,a,l,d,f,g,v,w;for(g=0;g<e;++g)n[g]>t&&(t=n[g]),n[g]<i&&(i=n[g]);for(r=1<<t,s=new(se?Uint32Array:Array)(r),o=1,a=0,l=2;o<=t;){for(g=0;g<e;++g)if(n[g]===o){for(d=0,f=a,v=0;v<o;++v)d=d<<1|f&1,f>>=1;for(w=o<<16|g,v=d;v<r;v+=l)s[v]=w;++a}++o,a<<=1,l<<=1}return[s,t,i]}function Wt(n,e){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=se?new Uint8Array(n):n,this.m=!1,this.i=mr,this.r=!1,(e||!(e={}))&&(e.index&&(this.a=e.index),e.bufferSize&&(this.h=e.bufferSize),e.bufferType&&(this.i=e.bufferType),e.resize&&(this.r=e.resize)),this.i){case sa:this.b=32768,this.c=new(se?Uint8Array:Array)(32768+this.h+258);break;case mr:this.b=0,this.c=new(se?Uint8Array:Array)(this.h),this.e=this.z,this.n=this.v,this.j=this.w;break;default:throw Error("invalid inflate mode")}}var sa=0,mr=1,qa={t:sa,s:mr};Wt.prototype.k=function(){for(;!this.m;){var n=_e(this,3);switch(n&1&&(this.m=!0),n>>>=1,n){case 0:var e=this.input,t=this.a,i=this.c,r=this.b,s=e.length,o=Fe,a=Fe,l=i.length,d=Fe;if(this.d=this.f=0,t+1>=s)throw Error("invalid uncompressed block header: LEN");if(o=e[t++]|e[t++]<<8,t+1>=s)throw Error("invalid uncompressed block header: NLEN");if(a=e[t++]|e[t++]<<8,o===~a)throw Error("invalid uncompressed block header: length verify");if(t+o>e.length)throw Error("input buffer is broken");switch(this.i){case sa:for(;r+o>i.length;){if(d=l-r,o-=d,se)i.set(e.subarray(t,t+d),r),r+=d,t+=d;else for(;d--;)i[r++]=e[t++];this.b=r,i=this.e(),r=this.b}break;case mr:for(;r+o>i.length;)i=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(se)i.set(e.subarray(t,t+o),r),r+=o,t+=o;else for(;o--;)i[r++]=e[t++];this.a=t,this.b=r,this.c=i;break;case 1:this.j(hp,up);break;case 2:for(var f=_e(this,5)+257,g=_e(this,5)+1,v=_e(this,4)+4,w=new(se?Uint8Array:Array)(Cs.length),x=Fe,M=Fe,k=Fe,D=Fe,B=Fe,S=Fe,C=Fe,T=Fe,W=Fe,T=0;T<v;++T)w[Cs[T]]=_e(this,3);if(!se)for(T=v,v=w.length;T<v;++T)w[Cs[T]]=0;for(x=hi(w),D=new(se?Uint8Array:Array)(f+g),T=0,W=f+g;T<W;)switch(B=gi(this,x),B){case 16:for(C=3+_e(this,2);C--;)D[T++]=S;break;case 17:for(C=3+_e(this,3);C--;)D[T++]=0;S=0;break;case 18:for(C=11+_e(this,7);C--;)D[T++]=0;S=0;break;default:S=D[T++]=B}M=hi(se?D.subarray(0,f):D.slice(0,f)),k=hi(se?D.subarray(f):D.slice(f)),this.j(M,k);break;default:throw Error("unknown BTYPE: "+n)}}return this.n()};var Ja=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Cs=se?new Uint16Array(Ja):Ja,Za=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],Gc=se?new Uint16Array(Za):Za,Ka=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],yr=se?new Uint8Array(Ka):Ka,el=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],_c=se?new Uint16Array(el):el,tl=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],br=se?new Uint8Array(tl):tl,ho=new(se?Uint8Array:Array)(288),Kt,nl;Kt=0;for(nl=ho.length;Kt<nl;++Kt)ho[Kt]=143>=Kt?8:255>=Kt?9:279>=Kt?7:8;var hp=hi(ho),uo=new(se?Uint8Array:Array)(30),hr,il;hr=0;for(il=uo.length;hr<il;++hr)uo[hr]=5;var up=hi(uo);function _e(n,e){for(var t=n.f,i=n.d,r=n.input,s=n.a,o=r.length,a;i<e;){if(s>=o)throw Error("input buffer is broken");t|=r[s++]<<i,i+=8}return a=t&(1<<e)-1,n.f=t>>>e,n.d=i-e,n.a=s,a}function gi(n,e){for(var t=n.f,i=n.d,r=n.input,s=n.a,o=r.length,a=e[0],l=e[1],d,f;i<l&&!(s>=o);)t|=r[s++]<<i,i+=8;if(d=a[t&(1<<l)-1],f=d>>>16,f>i)throw Error("invalid code length: "+f);return n.f=t>>f,n.d=i-f,n.a=s,d&65535}Wt.prototype.j=function(n,e){var t=this.c,i=this.b;this.o=n;for(var r=t.length-258,s,o,a,l;(s=gi(this,n))!==256;)if(256>s)i>=r&&(this.b=i,t=this.e(),i=this.b),t[i++]=s;else for(o=s-257,l=Gc[o],0<yr[o]&&(l+=_e(this,yr[o])),s=gi(this,e),a=_c[s],0<br[s]&&(a+=_e(this,br[s])),i>=r&&(this.b=i,t=this.e(),i=this.b);l--;)t[i]=t[i++-a];for(;8<=this.d;)this.d-=8,this.a--;this.b=i};Wt.prototype.w=function(n,e){var t=this.c,i=this.b;this.o=n;for(var r=t.length,s,o,a,l;(s=gi(this,n))!==256;)if(256>s)i>=r&&(t=this.e(),r=t.length),t[i++]=s;else for(o=s-257,l=Gc[o],0<yr[o]&&(l+=_e(this,yr[o])),s=gi(this,e),a=_c[s],0<br[s]&&(a+=_e(this,br[s])),i+l>r&&(t=this.e(),r=t.length);l--;)t[i]=t[i++-a];for(;8<=this.d;)this.d-=8,this.a--;this.b=i};Wt.prototype.e=function(){var n=new(se?Uint8Array:Array)(this.b-32768),e=this.b-32768,t,i,r=this.c;if(se)n.set(r.subarray(32768,n.length));else for(t=0,i=n.length;t<i;++t)n[t]=r[t+32768];if(this.g.push(n),this.l+=n.length,se)r.set(r.subarray(e,e+32768));else for(t=0;32768>t;++t)r[t]=r[e+t];return this.b=32768,r};Wt.prototype.z=function(n){var e,t=this.input.length/this.a+1|0,i,r,s,o=this.input,a=this.c;return n&&(typeof n.p=="number"&&(t=n.p),typeof n.u=="number"&&(t+=n.u)),2>t?(i=(o.length-this.a)/this.o[2],s=258*(i/2)|0,r=s<a.length?a.length+s:a.length<<1):r=a.length*t,se?(e=new Uint8Array(r),e.set(a)):e=a,this.c=e};Wt.prototype.n=function(){var n=0,e=this.c,t=this.g,i,r=new(se?Uint8Array:Array)(this.l+(this.b-32768)),s,o,a,l;if(t.length===0)return se?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(s=0,o=t.length;s<o;++s)for(i=t[s],a=0,l=i.length;a<l;++a)r[n++]=i[a];for(s=32768,o=this.b;s<o;++s)r[n++]=e[s];return this.g=[],this.buffer=r};Wt.prototype.v=function(){var n,e=this.b;return se?this.r?(n=new Uint8Array(e),n.set(this.c.subarray(0,e))):n=this.c.subarray(0,e):(this.c.length>e&&(this.c.length=e),n=this.c),this.buffer=n};function oa(n,e){var t,i;switch(this.input=n,this.a=0,(e||!(e={}))&&(e.index&&(this.a=e.index),e.verify&&(this.A=e.verify)),t=n[this.a++],i=n[this.a++],t&15){case rl:this.method=rl;break;default:throw Error("unsupported compression method")}if(((t<<8)+i)%31!==0)throw Error("invalid fcheck flag:"+((t<<8)+i)%31);if(i&32)throw Error("fdict flag is not supported");this.q=new Wt(n,{index:this.a,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})}oa.prototype.k=function(){var n=this.input,e,t;if(e=this.q.k(),this.a=this.q.a,this.A){t=(n[this.a++]<<24|n[this.a++]<<16|n[this.a++]<<8|n[this.a++])>>>0;var i=e;if(typeof i=="string"){var r=i.split(""),s,o;for(s=0,o=r.length;s<o;s++)r[s]=(r[s].charCodeAt(0)&255)>>>0;i=r}for(var a=1,l=0,d=i.length,f,g=0;0<d;){f=1024<d?1024:d,d-=f;do a+=i[g++],l+=a;while(--f);a%=65521,l%=65521}if(t!==(l<<16|a)>>>0)throw Error("invalid adler-32 checksum")}return e};var rl=8;ra("Zlib.Inflate",oa);ra("Zlib.Inflate.prototype.decompress",oa.prototype.k);var po={ADAPTIVE:qa.s,BLOCK:qa.t},ui,di,Cn,sl;if(Object.keys)ui=Object.keys(po);else for(di in ui=[],Cn=0,po)ui[Cn++]=di;Cn=0;for(sl=ui.length;Cn<sl;++Cn)di=ui[Cn],ra("Zlib.Inflate.BufferType."+di,po[di]);var ol=$c.Zlib,Uc={findSpan:function(n,e,t){var i=t.length-n-1;if(e>=t[i])return i-1;if(e<=t[n])return n;for(var r=n,s=i,o=Math.floor((r+s)/2);e<t[o]||e>=t[o+1];)e<t[o]?s=o:r=o,o=Math.floor((r+s)/2);return o},calcBasisFunctions:function(n,e,t,i){var r=[],s=[],o=[];r[0]=1;for(var a=1;a<=t;++a){s[a]=e-i[n+1-a],o[a]=i[n+a]-e;for(var l=0,d=0;d<a;++d){var f=o[d+1],g=s[a-d],v=r[d]/(f+g);r[d]=l+f*v,l=g*v}r[a]=l}return r},calcBSplinePoint:function(n,e,t,i){for(var r=this.findSpan(n,i,e),s=this.calcBasisFunctions(r,i,n,e),o=new jn(0,0,0,0),a=0;a<=n;++a){var l=t[r-n+a],d=s[a],f=l.w*d;o.x+=l.x*f,o.y+=l.y*f,o.z+=l.z*f,o.w+=l.w*d}return o},calcBasisFunctionDerivatives:function(n,e,t,i,r){for(var s=[],o=0;o<=t;++o)s[o]=0;for(var a=[],o=0;o<=i;++o)a[o]=s.slice(0);for(var l=[],o=0;o<=t;++o)l[o]=s.slice(0);l[0][0]=1;for(var d=s.slice(0),f=s.slice(0),g=1;g<=t;++g){d[g]=e-r[n+1-g],f[g]=r[n+g]-e;for(var v=0,w=0;w<g;++w){var x=f[w+1],M=d[g-w];l[g][w]=x+M;var k=l[w][g-1]/l[g][w];l[w][g]=v+x*k,v=M*k}l[g][g]=v}for(var g=0;g<=t;++g)a[0][g]=l[g][t];for(var w=0;w<=t;++w){for(var D=0,B=1,S=[],o=0;o<=t;++o)S[o]=s.slice(0);S[0][0]=1;for(var C=1;C<=i;++C){var W=0,T=w-C,R=t-C;w>=C&&(S[B][0]=S[D][0]/l[R+1][T],W=S[B][0]*l[T][R]);for(var N=T>=-1?1:-T,Q=w-1<=R?C-1:t-w,g=N;g<=Q;++g)S[B][g]=(S[D][g]-S[D][g-1])/l[R+1][T+g],W+=S[B][g]*l[T+g][R];w<=R&&(S[B][C]=-S[D][C-1]/l[R+1][w],W+=S[B][C]*l[w][R]),a[C][w]=W;var g=D;D=B,B=g}}for(var w=t,C=1;C<=i;++C){for(var g=0;g<=t;++g)a[C][g]*=w;w*=t-C}return a},calcBSplineDerivatives:function(n,e,t,i,r){for(var s=r<n?r:n,o=[],a=this.findSpan(n,i,e),l=this.calcBasisFunctionDerivatives(a,i,n,s,e),d=[],f=0;f<t.length;++f){var g=t[f].clone(),v=g.w;g.x*=v,g.y*=v,g.z*=v,d[f]=g}for(var w=0;w<=s;++w){for(var g=d[a-n].clone().multiplyScalar(l[w][0]),x=1;x<=n;++x)g.add(d[a-n+x].clone().multiplyScalar(l[w][x]));o[w]=g}for(var w=s+1;w<=r+1;++w)o[w]=new jn(0,0,0);return o},calcKoverI:function(n,e){for(var t=1,i=2;i<=n;++i)t*=i;for(var r=1,i=2;i<=e;++i)r*=i;for(var i=2;i<=n-e;++i)r*=i;return t/r},calcRationalCurveDerivatives:function(n){for(var e=n.length,t=[],i=[],r=0;r<e;++r){var s=n[r];t[r]=new O(s.x,s.y,s.z),i[r]=s.w}for(var o=[],a=0;a<e;++a){for(var l=t[a].clone(),r=1;r<=a;++r)l.sub(o[a-r].clone().multiplyScalar(this.calcKoverI(a,r)*i[r]));o[a]=l.divideScalar(i[0])}return o},calcNURBSDerivatives:function(n,e,t,i,r){var s=this.calcBSplineDerivatives(n,e,t,i,r);return this.calcRationalCurveDerivatives(s)},calcSurfacePoint:function(n,e,t,i,r,s,o,a){for(var l=this.findSpan(n,s,t),d=this.findSpan(e,o,i),f=this.calcBasisFunctions(l,s,n,t),g=this.calcBasisFunctions(d,o,e,i),v=[],w=0;w<=e;++w){v[w]=new jn(0,0,0,0);for(var x=0;x<=n;++x){var M=r[l-n+x][d-e+w].clone(),k=M.w;M.x*=k,M.y*=k,M.z*=k,v[w].add(M.multiplyScalar(f[x]))}}for(var D=new jn(0,0,0,0),w=0;w<=e;++w)D.add(v[w].multiplyScalar(g[w]));D.divideScalar(D.w),a.set(D.x,D.y,D.z)}},sn=function(n,e,t,i,r){kc.call(this),this.degree=n,this.knots=e,this.controlPoints=[],this.startKnot=i||0,this.endKnot=r||this.knots.length-1;for(var s=0;s<t.length;++s){var o=t[s];this.controlPoints[s]=new jn(o.x,o.y,o.z,o.w)}};sn.prototype=Object.create(kc.prototype);sn.prototype.constructor=sn;sn.prototype.getPoint=function(n,e){var t=e||new O,i=this.knots[this.startKnot]+n*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=Uc.calcBSplinePoint(this.degree,this.knots,this.controlPoints,i);return r.w!=1&&r.divideScalar(r.w),t.set(r.x,r.y,r.z)};sn.prototype.getTangent=function(n,e){var t=e||new O,i=this.knots[0]+n*(this.knots[this.knots.length-1]-this.knots[0]),r=Uc.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,i,1);return t.copy(r[1]).normalize(),t};var r1=function(){var n,e,t;function i(h){Ma.call(this,h)}i.prototype=Object.assign(Object.create(Ma.prototype),{constructor:i,load:function(h,u,p,y){var b=this,A=b.path===""?js.extractUrlBase(h):b.path,j=new lu(this.manager);j.setPath(b.path),j.setResponseType("arraybuffer"),j.load(h,function(E){try{u(b.parse(E,A))}catch(L){y?y(L):console.error(L),b.manager.itemError(h)}},p,y)},parse:function(h,u){if(g(h))n=new l().parse(h);else{var p=T(h);if(!v(p))throw new Error("THREE.FBXLoader: Unknown format.");if(w(p)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+w(p));n=new a().parse(p)}var y=new Dr(this.manager).setPath(this.resourcePath||u).setCrossOrigin(this.crossOrigin);return new r(y,this.manager).parse(n)}});function r(h,u){this.textureLoader=h,this.manager=u}r.prototype={constructor:r,parse:function(){e=this.parseConnections();var h=this.parseImages(),u=this.parseTextures(h),p=this.parseMaterials(u),y=this.parseDeformers(),b=new s().parse(y);return this.parseScene(y,b,p),t},parseConnections:function(){var h=new Map;if("Connections"in n){var u=n.Connections.connections;u.forEach(function(p){var y=p[0],b=p[1],A=p[2];h.has(y)||h.set(y,{parents:[],children:[]});var j={ID:b,relationship:A};h.get(y).parents.push(j),h.has(b)||h.set(b,{parents:[],children:[]});var E={ID:y,relationship:A};h.get(b).children.push(E)})}return h},parseImages:function(){var h={},u={};if("Video"in n.Objects){var p=n.Objects.Video;for(var y in p){var b=p[y],A=parseInt(y);if(h[A]=b.RelativeFilename||b.Filename,"Content"in b){var j=b.Content instanceof ArrayBuffer&&b.Content.byteLength>0,E=typeof b.Content=="string"&&b.Content!=="";if(j||E){var L=this.parseImage(p[y]);u[b.RelativeFilename||b.Filename]=L}}}}for(var A in h){var F=h[A];u[F]!==void 0?h[A]=u[F]:h[A]=h[A].split("\\").pop()}return h},parseImage:function(h){var u=h.Content,p=h.RelativeFilename||h.Filename,y=p.slice(p.lastIndexOf(".")+1).toLowerCase(),b;switch(y){case"bmp":b="image/bmp";break;case"jpg":case"jpeg":b="image/jpeg";break;case"png":b="image/png";break;case"tif":b="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",p),b="image/tga";break;default:console.warn('FBXLoader: Image type "'+y+'" is not supported.');return}if(typeof u=="string")return"data:"+b+";base64,"+u;var A=new Uint8Array(u);return window.URL.createObjectURL(new Blob([A],{type:b}))},parseTextures:function(h){var u=new Map;if("Texture"in n.Objects){var p=n.Objects.Texture;for(var y in p){var b=this.parseTexture(p[y],h);u.set(parseInt(y),b)}}return u},parseTexture:function(h,u){var p=this.loadTexture(h,u);p.ID=h.id,p.name=h.attrName;var y=h.WrapModeU,b=h.WrapModeV,A=y!==void 0?y.value:0,j=b!==void 0?b.value:0;if(p.wrapS=A===0?Ca:Ia,p.wrapT=j===0?Ca:Ia,"Scaling"in h){var E=h.Scaling.value;p.repeat.x=E[0],p.repeat.y=E[1]}return p},loadTexture:function(h,u){var p,y=this.textureLoader.path,b=e.get(h.id).children;b!==void 0&&b.length>0&&u[b[0].ID]!==void 0&&(p=u[b[0].ID],(p.indexOf("blob:")===0||p.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));var A,j=h.FileName.slice(-3).toLowerCase();if(j==="tga"){var E=this.manager.getHandler(".tga");E===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",h.RelativeFilename),A=new Da):A=E.load(p)}else j==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",h.RelativeFilename),A=new Da):A=this.textureLoader.load(p);return this.textureLoader.setPath(y),A},parseMaterials:function(h){var u=new Map;if("Material"in n.Objects){var p=n.Objects.Material;for(var y in p){var b=this.parseMaterial(p[y],h);b!==null&&u.set(parseInt(y),b)}}return u},parseMaterial:function(h,u){var p=h.id,y=h.attrName,b=h.ShadingModel;if(typeof b=="object"&&(b=b.value),!e.has(p))return null;var A=this.parseParameters(h,u,p),j;switch(b.toLowerCase()){case"phong":j=new Es;break;case"lambert":j=new cu;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',b),j=new Es;break}return j.setValues(A),j.name=y,j},parseParameters:function(h,u,p){var y={};h.BumpFactor&&(y.bumpScale=h.BumpFactor.value),h.Diffuse?y.color=new ie().fromArray(h.Diffuse.value):h.DiffuseColor&&h.DiffuseColor.type==="Color"&&(y.color=new ie().fromArray(h.DiffuseColor.value)),h.DisplacementFactor&&(y.displacementScale=h.DisplacementFactor.value),h.Emissive?y.emissive=new ie().fromArray(h.Emissive.value):h.EmissiveColor&&h.EmissiveColor.type==="Color"&&(y.emissive=new ie().fromArray(h.EmissiveColor.value)),h.EmissiveFactor&&(y.emissiveIntensity=parseFloat(h.EmissiveFactor.value)),h.Opacity&&(y.opacity=parseFloat(h.Opacity.value)),y.opacity<1&&(y.transparent=!0),h.ReflectionFactor&&(y.reflectivity=h.ReflectionFactor.value),h.Shininess&&(y.shininess=h.Shininess.value),h.Specular?y.specular=new ie().fromArray(h.Specular.value):h.SpecularColor&&h.SpecularColor.type==="Color"&&(y.specular=new ie().fromArray(h.SpecularColor.value));var b=this;return e.get(p).children.forEach(function(A){var j=A.relationship;switch(j){case"Bump":y.bumpMap=b.getTexture(u,A.ID);break;case"Maya|TEX_ao_map":y.aoMap=b.getTexture(u,A.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":y.map=b.getTexture(u,A.ID),y.map.encoding=On;break;case"DisplacementColor":y.displacementMap=b.getTexture(u,A.ID);break;case"EmissiveColor":y.emissiveMap=b.getTexture(u,A.ID),y.emissiveMap.encoding=On;break;case"NormalMap":case"Maya|TEX_normal_map":y.normalMap=b.getTexture(u,A.ID);break;case"ReflectionColor":y.envMap=b.getTexture(u,A.ID),y.envMap.mapping=hu,y.envMap.encoding=On;break;case"SpecularColor":y.specularMap=b.getTexture(u,A.ID),y.specularMap.encoding=On;break;case"TransparentColor":case"TransparencyFactor":y.alphaMap=b.getTexture(u,A.ID),y.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",j);break}}),y},getTexture:function(h,u){return"LayeredTexture"in n.Objects&&u in n.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),u=e.get(u).children[0].ID),h.get(u)},parseDeformers:function(){var h={},u={};if("Deformer"in n.Objects){var p=n.Objects.Deformer;for(var y in p){var b=p[y],A=e.get(parseInt(y));if(b.attrType==="Skin"){var j=this.parseSkeleton(A,p);j.ID=y,A.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),j.geometryID=A.parents[0].ID,h[y]=j}else if(b.attrType==="BlendShape"){var E={id:y};E.rawTargets=this.parseMorphTargets(A,p),E.id=y,A.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),u[y]=E}}}return{skeletons:h,morphTargets:u}},parseSkeleton:function(h,u){var p=[];return h.children.forEach(function(y){var b=u[y.ID];if(b.attrType==="Cluster"){var A={ID:y.ID,indices:[],weights:[],transformLink:new K().fromArray(b.TransformLink.a)};"Indexes"in b&&(A.indices=b.Indexes.a,A.weights=b.Weights.a),p.push(A)}}),{rawBones:p,bones:[]}},parseMorphTargets:function(h,u){for(var p=[],y=0;y<h.children.length;y++){var b=h.children[y],A=u[b.ID],j={name:A.attrName,initialWeight:A.DeformPercent,id:A.id,fullWeights:A.FullWeights.a};if(A.attrType!=="BlendShapeChannel")return;j.geoID=e.get(parseInt(b.ID)).children.filter(function(E){return E.relationship===void 0})[0].ID,p.push(j)}return p},parseScene:function(h,u,p){t=new jt;var y=this.parseModels(h.skeletons,u,p),b=n.Objects.Model,A=this;y.forEach(function(E){var L=b[E.ID];A.setLookAtProperties(E,L);var F=e.get(E.ID).parents;F.forEach(function(I){var H=y.get(I.ID);H!==void 0&&H.add(E)}),E.parent===null&&t.add(E)}),this.bindSkeleton(h.skeletons,u,y),this.createAmbientLight(),this.setupMorphMaterials(),t.traverse(function(E){if(E.userData.transformData){E.parent&&(E.userData.transformData.parentMatrixWorld=E.parent.matrix);var L=S(E.userData.transformData);E.applyMatrix4(L)}});var j=new o().parse();t.children.length===1&&t.children[0].isGroup&&(t.children[0].animations=j,t=t.children[0]),t.animations=j},parseModels:function(h,u,p){var y=new Map,b=n.Objects.Model;for(var A in b){var j=parseInt(A),E=b[A],L=e.get(j),F=this.buildSkeleton(L,h,j,E.attrName);if(!F){switch(E.attrType){case"Camera":F=this.createCamera(L);break;case"Light":F=this.createLight(L);break;case"Mesh":F=this.createMesh(L,u,p);break;case"NurbsCurve":F=this.createCurve(L,u);break;case"LimbNode":case"Root":F=new Sa;break;case"Null":default:F=new jt;break}F.name=E.attrName?Yi.sanitizeNodeName(E.attrName):"",F.ID=j}this.getTransformData(F,E),y.set(j,F)}return y},buildSkeleton:function(h,u,p,y){var b=null;return h.parents.forEach(function(A){for(var j in u){var E=u[j];E.rawBones.forEach(function(L,F){if(L.ID===A.ID){var I=b;b=new Sa,b.matrixWorld.copy(L.transformLink),b.name=y?Yi.sanitizeNodeName(y):"",b.ID=p,E.bones[F]=b,I!==null&&b.add(I)}})}}),b},createCamera:function(h){var u,p;if(h.children.forEach(function(H){var X=n.Objects.NodeAttribute[H.ID];X!==void 0&&(p=X)}),p===void 0)u=new tn;else{var y=0;p.CameraProjectionType!==void 0&&p.CameraProjectionType.value===1&&(y=1);var b=1;p.NearPlane!==void 0&&(b=p.NearPlane.value/1e3);var A=1e3;p.FarPlane!==void 0&&(A=p.FarPlane.value/1e3);var j=window.innerWidth,E=window.innerHeight;p.AspectWidth!==void 0&&p.AspectHeight!==void 0&&(j=p.AspectWidth.value,E=p.AspectHeight.value);var L=j/E,F=45;p.FieldOfView!==void 0&&(F=p.FieldOfView.value);var I=p.FocalLength?p.FocalLength.value:null;switch(y){case 0:u=new Pu(F,L,b,A),I!==null&&u.setFocalLength(I);break;case 1:u=new wu(-j/2,j/2,E/2,-E/2,b,A);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+y+"."),u=new tn;break}}return u},createLight:function(h){var u,p;if(h.children.forEach(function(I){var H=n.Objects.NodeAttribute[I.ID];H!==void 0&&(p=H)}),p===void 0)u=new tn;else{var y;p.LightType===void 0?y=0:y=p.LightType.value;var b=16777215;p.Color!==void 0&&(b=new ie().fromArray(p.Color.value));var A=p.Intensity===void 0?1:p.Intensity.value/100;p.CastLightOnObject!==void 0&&p.CastLightOnObject.value===0&&(A=0);var j=0;p.FarAttenuationEnd!==void 0&&(p.EnableFarAttenuation!==void 0&&p.EnableFarAttenuation.value===0?j=0:j=p.FarAttenuationEnd.value);var E=1;switch(y){case 0:u=new ka(b,A,j,E);break;case 1:u=new xu(b,A);break;case 2:var L=Math.PI/3;p.InnerAngle!==void 0&&(L=ct.degToRad(p.InnerAngle.value));var F=0;p.OuterAngle!==void 0&&(F=ct.degToRad(p.OuterAngle.value),F=Math.max(F,1)),u=new Au(b,A,j,L,F,E);break;default:console.warn("THREE.FBXLoader: Unknown light type "+p.LightType.value+", defaulting to a PointLight."),u=new ka(b,A);break}p.CastShadows!==void 0&&p.CastShadows.value===1&&(u.castShadow=!0)}return u},createMesh:function(h,u,p){var y,b=null,A=null,j=[];return h.children.forEach(function(E){u.has(E.ID)&&(b=u.get(E.ID)),p.has(E.ID)&&j.push(p.get(E.ID))}),j.length>1?A=j:j.length>0?A=j[0]:(A=new Es({color:13421772}),j.push(A)),"color"in b.attributes&&j.forEach(function(E){E.vertexColors=!0}),b.FBX_Deformer?(j.forEach(function(E){E.skinning=!0}),y=new uu(b,A),y.normalizeSkinWeights()):y=new ue(b,A),y},createCurve:function(h,u){var p=h.children.reduce(function(b,A){return u.has(A.ID)&&(b=u.get(A.ID)),b},null),y=new Sr({color:3342591,linewidth:1});return new na(p,y)},getTransformData:function(h,u){var p={};"InheritType"in u&&(p.inheritType=parseInt(u.InheritType.value)),"RotationOrder"in u?p.eulerOrder=C(u.RotationOrder.value):p.eulerOrder="ZYX","Lcl_Translation"in u&&(p.translation=u.Lcl_Translation.value),"PreRotation"in u&&(p.preRotation=u.PreRotation.value),"Lcl_Rotation"in u&&(p.rotation=u.Lcl_Rotation.value),"PostRotation"in u&&(p.postRotation=u.PostRotation.value),"Lcl_Scaling"in u&&(p.scale=u.Lcl_Scaling.value),"ScalingOffset"in u&&(p.scalingOffset=u.ScalingOffset.value),"ScalingPivot"in u&&(p.scalingPivot=u.ScalingPivot.value),"RotationOffset"in u&&(p.rotationOffset=u.RotationOffset.value),"RotationPivot"in u&&(p.rotationPivot=u.RotationPivot.value),h.userData.transformData=p},setLookAtProperties:function(h,u){if("LookAtProperty"in u){var p=e.get(h.ID).children;p.forEach(function(y){if(y.relationship==="LookAtProperty"){var b=n.Objects.Model[y.ID];if("Lcl_Translation"in b){var A=b.Lcl_Translation.value;h.target!==void 0?(h.target.position.fromArray(A),t.add(h.target)):h.lookAt(new O().fromArray(A))}}})}},bindSkeleton:function(h,u,p){var y=this.parsePoseNodes();for(var b in h){var A=h[b],j=e.get(parseInt(A.ID)).parents;j.forEach(function(E){if(u.has(E.ID)){var L=E.ID,F=e.get(L);F.parents.forEach(function(I){if(p.has(I.ID)){var H=p.get(I.ID);H.bind(new du(A.bones),y[I.ID])}})}})}},parsePoseNodes:function(){var h={};if("Pose"in n.Objects){var u=n.Objects.Pose;for(var p in u)if(u[p].attrType==="BindPose"){var y=u[p].PoseNode;Array.isArray(y)?y.forEach(function(b){h[b.Node]=new K().fromArray(b.Matrix.a)}):h[y.Node]=new K().fromArray(y.Matrix.a)}}return h},createAmbientLight:function(){if("GlobalSettings"in n&&"AmbientColor"in n.GlobalSettings){var h=n.GlobalSettings.AmbientColor.value,u=h[0],p=h[1],y=h[2];if(u!==0||p!==0||y!==0){var b=new ie(u,p,y);t.add(new pu(b,1))}}},setupMorphMaterials:function(){var h=this;t.traverse(function(u){u.isMesh&&u.geometry.morphAttributes.position&&u.geometry.morphAttributes.position.length&&(Array.isArray(u.material)?u.material.forEach(function(p,y){h.setupMorphMaterial(u,p,y)}):h.setupMorphMaterial(u,u.material))})},setupMorphMaterial:function(h,u,p){var y=h.uuid,b=u.uuid,A=!1;if(t.traverse(function(E){E.isMesh&&(Array.isArray(E.material)?E.material.forEach(function(L){L.uuid===b&&E.uuid!==y&&(A=!0)}):E.material.uuid===b&&E.uuid!==y&&(A=!0))}),A===!0){var j=u.clone();j.morphTargets=!0,p===void 0?h.material=j:h.material[p]=j}else u.morphTargets=!0}};function s(){}s.prototype={constructor:s,parse:function(h){var u=new Map;if("Geometry"in n.Objects){var p=n.Objects.Geometry;for(var y in p){var b=e.get(parseInt(y)),A=this.parseGeometry(b,p[y],h);u.set(parseInt(y),A)}}return u},parseGeometry:function(h,u,p){switch(u.attrType){case"Mesh":return this.parseMeshGeometry(h,u,p);case"NurbsCurve":return this.parseNurbsGeometry(u)}},parseMeshGeometry:function(h,u,p){var y=p.skeletons,b=[],A=h.parents.map(function(I){return n.Objects.Model[I.ID]});if(A.length!==0){var j=h.children.reduce(function(I,H){return y[H.ID]!==void 0&&(I=y[H.ID]),I},null);h.children.forEach(function(I){p.morphTargets[I.ID]!==void 0&&b.push(p.morphTargets[I.ID])});var E=A[0],L={};"RotationOrder"in E&&(L.eulerOrder=C(E.RotationOrder.value)),"InheritType"in E&&(L.inheritType=parseInt(E.InheritType.value)),"GeometricTranslation"in E&&(L.translation=E.GeometricTranslation.value),"GeometricRotation"in E&&(L.rotation=E.GeometricRotation.value),"GeometricScaling"in E&&(L.scale=E.GeometricScaling.value);var F=S(L);return this.genGeometry(u,j,b,F)}},genGeometry:function(h,u,p,y){var b=new ze;h.attrName&&(b.name=h.attrName);var A=this.parseGeoNode(h,u),j=this.genBuffers(A),E=new Bt(j.vertex,3);if(E.applyMatrix4(y),b.setAttribute("position",E),j.colors.length>0&&b.setAttribute("color",new Bt(j.colors,3)),u&&(b.setAttribute("skinIndex",new fu(j.weightsIndices,4)),b.setAttribute("skinWeight",new Bt(j.vertexWeights,4)),b.FBX_Deformer=u),j.normal.length>0){var L=new vu().getNormalMatrix(y),F=new Bt(j.normal,3);F.applyNormalMatrix(L),b.setAttribute("normal",F)}if(j.uvs.forEach(function(q,$){var ee="uv"+($+1).toString();$===0&&(ee="uv"),b.setAttribute(ee,new Bt(j.uvs[$],2))}),A.material&&A.material.mappingType!=="AllSame"){var I=j.materialIndex[0],H=0;if(j.materialIndex.forEach(function(q,$){q!==I&&(b.addGroup(H,$-H,I),I=q,H=$)}),b.groups.length>0){var X=b.groups[b.groups.length-1],_=X.start+X.count;_!==j.materialIndex.length&&b.addGroup(_,j.materialIndex.length-_,I)}b.groups.length===0&&b.addGroup(0,j.materialIndex.length,j.materialIndex[0])}return this.addMorphTargets(b,h,p,y),b},parseGeoNode:function(h,u){var p={};if(p.vertexPositions=h.Vertices!==void 0?h.Vertices.a:[],p.vertexIndices=h.PolygonVertexIndex!==void 0?h.PolygonVertexIndex.a:[],h.LayerElementColor&&(p.color=this.parseVertexColors(h.LayerElementColor[0])),h.LayerElementMaterial&&(p.material=this.parseMaterialIndices(h.LayerElementMaterial[0])),h.LayerElementNormal&&(p.normal=this.parseNormals(h.LayerElementNormal[0])),h.LayerElementUV){p.uv=[];for(var y=0;h.LayerElementUV[y];)p.uv.push(this.parseUVs(h.LayerElementUV[y])),y++}return p.weightTable={},u!==null&&(p.skeleton=u,u.rawBones.forEach(function(b,A){b.indices.forEach(function(j,E){p.weightTable[j]===void 0&&(p.weightTable[j]=[]),p.weightTable[j].push({id:A,weight:b.weights[E]})})})),p},genBuffers:function(h){var u={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},p=0,y=0,b=!1,A=[],j=[],E=[],L=[],F=[],I=[],H=this;return h.vertexIndices.forEach(function(X,_){var q=!1;X<0&&(X=X^-1,q=!0);var $=[],ee=[];if(A.push(X*3,X*3+1,X*3+2),h.color){var le=k(_,p,X,h.color);E.push(le[0],le[1],le[2])}if(h.skeleton){if(h.weightTable[X]!==void 0&&h.weightTable[X].forEach(function(be){ee.push(be.weight),$.push(be.id)}),ee.length>4){b||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),b=!0);var ce=[0,0,0,0],De=[0,0,0,0];ee.forEach(function(be,ye){var je=be,qe=$[ye];De.forEach(function(Je,Ct,Hn){if(je>Je){Hn[Ct]=je,je=Je;var Tn=ce[Ct];ce[Ct]=qe,qe=Tn}})}),$=ce,ee=De}for(;ee.length<4;)ee.push(0),$.push(0);for(var Oe=0;Oe<4;++Oe)F.push(ee[Oe]),I.push($[Oe])}if(h.normal){var le=k(_,p,X,h.normal);j.push(le[0],le[1],le[2])}if(h.material&&h.material.mappingType!=="AllSame")var $e=k(_,p,X,h.material)[0];h.uv&&h.uv.forEach(function(be,ye){var je=k(_,p,X,be);L[ye]===void 0&&(L[ye]=[]),L[ye].push(je[0]),L[ye].push(je[1])}),y++,q&&(H.genFace(u,h,A,$e,j,E,L,F,I,y),p++,y=0,A=[],j=[],E=[],L=[],F=[],I=[])}),u},genFace:function(h,u,p,y,b,A,j,E,L,F){for(var I=2;I<F;I++)h.vertex.push(u.vertexPositions[p[0]]),h.vertex.push(u.vertexPositions[p[1]]),h.vertex.push(u.vertexPositions[p[2]]),h.vertex.push(u.vertexPositions[p[(I-1)*3]]),h.vertex.push(u.vertexPositions[p[(I-1)*3+1]]),h.vertex.push(u.vertexPositions[p[(I-1)*3+2]]),h.vertex.push(u.vertexPositions[p[I*3]]),h.vertex.push(u.vertexPositions[p[I*3+1]]),h.vertex.push(u.vertexPositions[p[I*3+2]]),u.skeleton&&(h.vertexWeights.push(E[0]),h.vertexWeights.push(E[1]),h.vertexWeights.push(E[2]),h.vertexWeights.push(E[3]),h.vertexWeights.push(E[(I-1)*4]),h.vertexWeights.push(E[(I-1)*4+1]),h.vertexWeights.push(E[(I-1)*4+2]),h.vertexWeights.push(E[(I-1)*4+3]),h.vertexWeights.push(E[I*4]),h.vertexWeights.push(E[I*4+1]),h.vertexWeights.push(E[I*4+2]),h.vertexWeights.push(E[I*4+3]),h.weightsIndices.push(L[0]),h.weightsIndices.push(L[1]),h.weightsIndices.push(L[2]),h.weightsIndices.push(L[3]),h.weightsIndices.push(L[(I-1)*4]),h.weightsIndices.push(L[(I-1)*4+1]),h.weightsIndices.push(L[(I-1)*4+2]),h.weightsIndices.push(L[(I-1)*4+3]),h.weightsIndices.push(L[I*4]),h.weightsIndices.push(L[I*4+1]),h.weightsIndices.push(L[I*4+2]),h.weightsIndices.push(L[I*4+3])),u.color&&(h.colors.push(A[0]),h.colors.push(A[1]),h.colors.push(A[2]),h.colors.push(A[(I-1)*3]),h.colors.push(A[(I-1)*3+1]),h.colors.push(A[(I-1)*3+2]),h.colors.push(A[I*3]),h.colors.push(A[I*3+1]),h.colors.push(A[I*3+2])),u.material&&u.material.mappingType!=="AllSame"&&(h.materialIndex.push(y),h.materialIndex.push(y),h.materialIndex.push(y)),u.normal&&(h.normal.push(b[0]),h.normal.push(b[1]),h.normal.push(b[2]),h.normal.push(b[(I-1)*3]),h.normal.push(b[(I-1)*3+1]),h.normal.push(b[(I-1)*3+2]),h.normal.push(b[I*3]),h.normal.push(b[I*3+1]),h.normal.push(b[I*3+2])),u.uv&&u.uv.forEach(function(H,X){h.uvs[X]===void 0&&(h.uvs[X]=[]),h.uvs[X].push(j[X][0]),h.uvs[X].push(j[X][1]),h.uvs[X].push(j[X][(I-1)*2]),h.uvs[X].push(j[X][(I-1)*2+1]),h.uvs[X].push(j[X][I*2]),h.uvs[X].push(j[X][I*2+1])})},addMorphTargets:function(h,u,p,y){if(p.length!==0){h.morphTargetsRelative=!0,h.morphAttributes.position=[];var b=this;p.forEach(function(A){A.rawTargets.forEach(function(j){var E=n.Objects.Geometry[j.geoID];E!==void 0&&b.genMorphGeometry(h,u,E,y,j.name)})})}},genMorphGeometry:function(h,u,p,y,b){for(var A=u.PolygonVertexIndex!==void 0?u.PolygonVertexIndex.a:[],j=p.Vertices!==void 0?p.Vertices.a:[],E=p.Indexes!==void 0?p.Indexes.a:[],L=h.attributes.position.count*3,F=new Float32Array(L),I=0;I<E.length;I++){var H=E[I]*3;F[H]=j[I*3],F[H+1]=j[I*3+1],F[H+2]=j[I*3+2]}var X={vertexIndices:A,vertexPositions:F},_=this.genBuffers(X),q=new Bt(_.vertex,3);q.name=b||p.attrName,q.applyMatrix4(y),h.morphAttributes.position.push(q)},parseNormals:function(h){var u=h.MappingInformationType,p=h.ReferenceInformationType,y=h.Normals.a,b=[];return p==="IndexToDirect"&&("NormalIndex"in h?b=h.NormalIndex.a:"NormalsIndex"in h&&(b=h.NormalsIndex.a)),{dataSize:3,buffer:y,indices:b,mappingType:u,referenceType:p}},parseUVs:function(h){var u=h.MappingInformationType,p=h.ReferenceInformationType,y=h.UV.a,b=[];return p==="IndexToDirect"&&(b=h.UVIndex.a),{dataSize:2,buffer:y,indices:b,mappingType:u,referenceType:p}},parseVertexColors:function(h){var u=h.MappingInformationType,p=h.ReferenceInformationType,y=h.Colors.a,b=[];return p==="IndexToDirect"&&(b=h.ColorIndex.a),{dataSize:4,buffer:y,indices:b,mappingType:u,referenceType:p}},parseMaterialIndices:function(h){var u=h.MappingInformationType,p=h.ReferenceInformationType;if(u==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:p};for(var y=h.Materials.a,b=[],A=0;A<y.length;++A)b.push(A);return{dataSize:1,buffer:y,indices:b,mappingType:u,referenceType:p}},parseNurbsGeometry:function(h){if(sn===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new ze;var u=parseInt(h.Order);if(isNaN(u))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",h.Order,h.id),new ze;for(var p=u-1,y=h.KnotVector.a,b=[],A=h.Points.a,j=0,E=A.length;j<E;j+=4)b.push(new jn().fromArray(A,j));var L,F;if(h.Form==="Closed")b.push(b[0]);else if(h.Form==="Periodic"){L=p,F=y.length-1-L;for(var j=0;j<p;++j)b.push(b[j])}var I=new sn(p,y,b,L,F),H=I.getPoints(b.length*7),X=new Float32Array(H.length*3);H.forEach(function(q,$){q.toArray(X,$*3)});var _=new ze;return _.setAttribute("position",new Ve(X,3)),_}};function o(){}o.prototype={constructor:o,parse:function(){var h=[],u=this.parseClips();if(u!==void 0)for(var p in u){var y=u[p],b=this.addClip(y);h.push(b)}return h},parseClips:function(){if(n.Objects.AnimationCurve!==void 0){var h=this.parseAnimationCurveNodes();this.parseAnimationCurves(h);var u=this.parseAnimationLayers(h),p=this.parseAnimStacks(u);return p}},parseAnimationCurveNodes:function(){var h=n.Objects.AnimationCurveNode,u=new Map;for(var p in h){var y=h[p];if(y.attrName.match(/S|R|T|DeformPercent/)!==null){var b={id:y.id,attr:y.attrName,curves:{}};u.set(b.id,b)}}return u},parseAnimationCurves:function(h){var u=n.Objects.AnimationCurve;for(var p in u){var y={id:u[p].id,times:u[p].KeyTime.a.map(x),values:u[p].KeyValueFloat.a},b=e.get(y.id);if(b!==void 0){var A=b.parents[0].ID,j=b.parents[0].relationship;j.match(/X/)?h.get(A).curves.x=y:j.match(/Y/)?h.get(A).curves.y=y:j.match(/Z/)?h.get(A).curves.z=y:j.match(/d|DeformPercent/)&&h.has(A)&&(h.get(A).curves.morph=y)}}},parseAnimationLayers:function(h){var u=n.Objects.AnimationLayer,p=new Map;for(var y in u){var b=[],A=e.get(parseInt(y));if(A!==void 0){var j=A.children;j.forEach(function(E,L){if(h.has(E.ID)){var F=h.get(E.ID);if(F.curves.x!==void 0||F.curves.y!==void 0||F.curves.z!==void 0){if(b[L]===void 0){var I=e.get(E.ID).parents.filter(function(ee){return ee.relationship!==void 0})[0].ID;if(I!==void 0){var H=n.Objects.Model[I.toString()];if(H===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",E);return}var X={modelName:H.attrName?Yi.sanitizeNodeName(H.attrName):"",ID:H.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};t.traverse(function(ee){ee.ID===H.id&&(X.transform=ee.matrix,ee.userData.transformData&&(X.eulerOrder=ee.userData.transformData.eulerOrder))}),X.transform||(X.transform=new K),"PreRotation"in H&&(X.preRotation=H.PreRotation.value),"PostRotation"in H&&(X.postRotation=H.PostRotation.value),b[L]=X}}b[L]&&(b[L][F.attr]=F)}else if(F.curves.morph!==void 0){if(b[L]===void 0){var _=e.get(E.ID).parents.filter(function(De){return De.relationship!==void 0})[0].ID,q=e.get(_).parents[0].ID,$=e.get(q).parents[0].ID,I=e.get($).parents[0].ID,H=n.Objects.Model[I],X={modelName:H.attrName?Yi.sanitizeNodeName(H.attrName):"",morphName:n.Objects.Deformer[_].attrName};b[L]=X}b[L][F.attr]=F}}}),p.set(parseInt(y),b)}}return p},parseAnimStacks:function(h){var u=n.Objects.AnimationStack,p={};for(var y in u){var b=e.get(parseInt(y)).children;b.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var A=h.get(b[0].ID);p[y]={name:u[y].attrName,layer:A}}return p},addClip:function(h){var u=[],p=this;return h.layer.forEach(function(y){u=u.concat(p.generateTracks(y))}),new gu(h.name,-1,u)},generateTracks:function(h){var u=[],p=new O,y=new re,b=new O;if(h.transform&&h.transform.decompose(p,y,b),p=p.toArray(),y=new nt().setFromQuaternion(y,h.eulerOrder).toArray(),b=b.toArray(),h.T!==void 0&&Object.keys(h.T.curves).length>0){var A=this.generateVectorTrack(h.modelName,h.T.curves,p,"position");A!==void 0&&u.push(A)}if(h.R!==void 0&&Object.keys(h.R.curves).length>0){var j=this.generateRotationTrack(h.modelName,h.R.curves,y,h.preRotation,h.postRotation,h.eulerOrder);j!==void 0&&u.push(j)}if(h.S!==void 0&&Object.keys(h.S.curves).length>0){var E=this.generateVectorTrack(h.modelName,h.S.curves,b,"scale");E!==void 0&&u.push(E)}if(h.DeformPercent!==void 0){var L=this.generateMorphTrack(h);L!==void 0&&u.push(L)}return u},generateVectorTrack:function(h,u,p,y){var b=this.getTimesForAllAxes(u),A=this.getKeyframeTrackValues(b,u,p);return new mu(h+"."+y,b,A)},generateRotationTrack:function(h,u,p,y,b,A){u.x!==void 0&&(this.interpolateRotations(u.x),u.x.values=u.x.values.map(ct.degToRad)),u.y!==void 0&&(this.interpolateRotations(u.y),u.y.values=u.y.values.map(ct.degToRad)),u.z!==void 0&&(this.interpolateRotations(u.z),u.z.values=u.z.values.map(ct.degToRad));var j=this.getTimesForAllAxes(u),E=this.getKeyframeTrackValues(j,u,p);y!==void 0&&(y=y.map(ct.degToRad),y.push(A),y=new nt().fromArray(y),y=new re().setFromEuler(y)),b!==void 0&&(b=b.map(ct.degToRad),b.push(A),b=new nt().fromArray(b),b=new re().setFromEuler(b).inverse());for(var L=new re,F=new nt,I=[],H=0;H<E.length;H+=3)F.set(E[H],E[H+1],E[H+2],A),L.setFromEuler(F),y!==void 0&&L.premultiply(y),b!==void 0&&L.multiply(b),L.toArray(I,H/3*4);return new yu(h+".quaternion",j,I)},generateMorphTrack:function(h){var u=h.DeformPercent.curves.morph,p=u.values.map(function(b){return b/100}),y=t.getObjectByName(h.modelName).morphTargetDictionary[h.morphName];return new bu(h.modelName+".morphTargetInfluences["+y+"]",u.times,p)},getTimesForAllAxes:function(h){var u=[];return h.x!==void 0&&(u=u.concat(h.x.times)),h.y!==void 0&&(u=u.concat(h.y.times)),h.z!==void 0&&(u=u.concat(h.z.times)),u=u.sort(function(p,y){return p-y}).filter(function(p,y,b){return b.indexOf(p)==y}),u},getKeyframeTrackValues:function(h,u,p){var y=p,b=[],A=-1,j=-1,E=-1;return h.forEach(function(L){if(u.x&&(A=u.x.times.indexOf(L)),u.y&&(j=u.y.times.indexOf(L)),u.z&&(E=u.z.times.indexOf(L)),A!==-1){var F=u.x.values[A];b.push(F),y[0]=F}else b.push(y[0]);if(j!==-1){var I=u.y.values[j];b.push(I),y[1]=I}else b.push(y[1]);if(E!==-1){var H=u.z.values[E];b.push(H),y[2]=H}else b.push(y[2])}),b},interpolateRotations:function(h){for(var u=1;u<h.values.length;u++){var p=h.values[u-1],y=h.values[u]-p,b=Math.abs(y);if(b>=180){for(var A=b/180,j=y/A,E=p+j,L=h.times[u-1],F=h.times[u]-L,I=F/A,H=L+I,X=[],_=[];H<h.times[u];)X.push(H),H+=I,_.push(E),E+=j;h.times=Q(h.times,u,X),h.values=Q(h.values,u,_)}}}};function a(){}a.prototype={constructor:a,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(h){this.nodeStack.push(h),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(h,u){this.currentProp=h,this.currentPropName=u},parse:function(h){this.currentIndent=0,this.allNodes=new f,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var u=this,p=h.split(/[\r\n]+/);return p.forEach(function(y,b){var A=y.match(/^[\s\t]*;/),j=y.match(/^[\s\t]*$/);if(!(A||j)){var E=y.match("^\\t{"+u.currentIndent+"}(\\w+):(.*){",""),L=y.match("^\\t{"+u.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),F=y.match("^\\t{"+(u.currentIndent-1)+"}}");E?u.parseNodeBegin(y,E):L?u.parseNodeProperty(y,L,p[++b]):F?u.popStack():y.match(/^[^\s\t}]/)&&u.parseNodePropertyContinued(y)}}),this.allNodes},parseNodeBegin:function(h,u){var p=u[1].trim().replace(/^"/,"").replace(/"$/,""),y=u[2].split(",").map(function(E){return E.trim().replace(/^"/,"").replace(/"$/,"")}),b={name:p},A=this.parseNodeAttr(y),j=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(p,b):p in j?(p==="PoseNode"?j.PoseNode.push(b):j[p].id!==void 0&&(j[p]={},j[p][j[p].id]=j[p]),A.id!==""&&(j[p][A.id]=b)):typeof A.id=="number"?(j[p]={},j[p][A.id]=b):p!=="Properties70"&&(p==="PoseNode"?j[p]=[b]:j[p]=b),typeof A.id=="number"&&(b.id=A.id),A.name!==""&&(b.attrName=A.name),A.type!==""&&(b.attrType=A.type),this.pushStack(b)},parseNodeAttr:function(h){var u=h[0];h[0]!==""&&(u=parseInt(h[0]),isNaN(u)&&(u=h[0]));var p="",y="";return h.length>1&&(p=h[1].replace(/^(\w+)::/,""),y=h[2]),{id:u,name:p,type:y}},parseNodeProperty:function(h,u,p){var y=u[1].replace(/^"/,"").replace(/"$/,"").trim(),b=u[2].replace(/^"/,"").replace(/"$/,"").trim();y==="Content"&&b===","&&(b=p.replace(/"/g,"").replace(/,$/,"").trim());var A=this.getCurrentNode(),j=A.name;if(j==="Properties70"){this.parseNodeSpecialProperty(h,y,b);return}if(y==="C"){var E=b.split(",").slice(1),L=parseInt(E[0]),F=parseInt(E[1]),I=b.split(",").slice(3);I=I.map(function(H){return H.trim().replace(/^"/,"")}),y="connections",b=[L,F],R(b,I),A[y]===void 0&&(A[y]=[])}y==="Node"&&(A.id=b),y in A&&Array.isArray(A[y])?A[y].push(b):y!=="a"?A[y]=b:A.a=b,this.setCurrentProp(A,y),y==="a"&&b.slice(-1)!==","&&(A.a=W(b))},parseNodePropertyContinued:function(h){var u=this.getCurrentNode();u.a+=h,h.slice(-1)!==","&&(u.a=W(u.a))},parseNodeSpecialProperty:function(h,u,p){var y=p.split('",').map(function(F){return F.trim().replace(/^\"/,"").replace(/\s/,"_")}),b=y[0],A=y[1],j=y[2],E=y[3],L=y[4];switch(A){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":L=parseFloat(L);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":L=W(L);break}this.getPrevNode()[b]={type:A,type2:j,flag:E,value:L},this.setCurrentProp(this.getPrevNode(),b)}};function l(){}l.prototype={constructor:l,parse:function(h){var u=new d(h);u.skip(23);var p=u.getUint32();console.info("THREE.FBXLoader: FBX binary version: "+p);for(var y=new f;!this.endOfContent(u);){var b=this.parseNode(u,p);b!==null&&y.add(b.name,b)}return y},endOfContent:function(h){return h.size()%16===0?(h.getOffset()+160+16&-16)>=h.size():h.getOffset()+160+16>=h.size()},parseNode:function(h,u){var p={},y=u>=7500?h.getUint64():h.getUint32(),b=u>=7500?h.getUint64():h.getUint32();u>=7500?h.getUint64():h.getUint32();var A=h.getUint8(),j=h.getString(A);if(y===0)return null;for(var E=[],L=0;L<b;L++)E.push(this.parseProperty(h));var F=E.length>0?E[0]:"",I=E.length>1?E[1]:"",H=E.length>2?E[2]:"";for(p.singleProperty=b===1&&h.getOffset()===y;y>h.getOffset();){var X=this.parseNode(h,u);X!==null&&this.parseSubNode(j,p,X)}return p.propertyList=E,typeof F=="number"&&(p.id=F),I!==""&&(p.attrName=I),H!==""&&(p.attrType=H),j!==""&&(p.name=j),p},parseSubNode:function(h,u,p){if(p.singleProperty===!0){var y=p.propertyList[0];Array.isArray(y)?(u[p.name]=p,p.a=y):u[p.name]=y}else if(h==="Connections"&&p.name==="C"){var b=[];p.propertyList.forEach(function(H,X){X!==0&&b.push(H)}),u.connections===void 0&&(u.connections=[]),u.connections.push(b)}else if(p.name==="Properties70"){var A=Object.keys(p);A.forEach(function(H){u[H]=p[H]})}else if(h==="Properties70"&&p.name==="P"){var j=p.propertyList[0],E=p.propertyList[1],L=p.propertyList[2],F=p.propertyList[3],I;j.indexOf("Lcl ")===0&&(j=j.replace("Lcl ","Lcl_")),E.indexOf("Lcl ")===0&&(E=E.replace("Lcl ","Lcl_")),E==="Color"||E==="ColorRGB"||E==="Vector"||E==="Vector3D"||E.indexOf("Lcl_")===0?I=[p.propertyList[4],p.propertyList[5],p.propertyList[6]]:I=p.propertyList[4],u[j]={type:E,type2:L,flag:F,value:I}}else u[p.name]===void 0?typeof p.id=="number"?(u[p.name]={},u[p.name][p.id]=p):u[p.name]=p:p.name==="PoseNode"?(Array.isArray(u[p.name])||(u[p.name]=[u[p.name]]),u[p.name].push(p)):u[p.name][p.id]===void 0&&(u[p.name][p.id]=p)},parseProperty:function(h){var u=h.getString(1);switch(u){case"C":return h.getBoolean();case"D":return h.getFloat64();case"F":return h.getFloat32();case"I":return h.getInt32();case"L":return h.getInt64();case"R":var p=h.getUint32();return h.getArrayBuffer(p);case"S":var p=h.getUint32();return h.getString(p);case"Y":return h.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var y=h.getUint32(),b=h.getUint32(),A=h.getUint32();if(b===0)switch(u){case"b":case"c":return h.getBooleanArray(y);case"d":return h.getFloat64Array(y);case"f":return h.getFloat32Array(y);case"i":return h.getInt32Array(y);case"l":return h.getInt64Array(y)}typeof ol>"u"&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var j=new ol.Inflate(new Uint8Array(h.getArrayBuffer(A))),E=new d(j.decompress().buffer);switch(u){case"b":case"c":return E.getBooleanArray(y);case"d":return E.getFloat64Array(y);case"f":return E.getFloat32Array(y);case"i":return E.getInt32Array(y);case"l":return E.getInt64Array(y)}default:throw new Error("THREE.FBXLoader: Unknown property type "+u)}}};function d(h,u){this.dv=new DataView(h),this.offset=0,this.littleEndian=u!==void 0?u:!0}d.prototype={constructor:d,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(h){this.offset+=h},getBoolean:function(){return(this.getUint8()&1)===1},getBooleanArray:function(h){for(var u=[],p=0;p<h;p++)u.push(this.getBoolean());return u},getUint8:function(){var h=this.dv.getUint8(this.offset);return this.offset+=1,h},getInt16:function(){var h=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,h},getInt32:function(){var h=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,h},getInt32Array:function(h){for(var u=[],p=0;p<h;p++)u.push(this.getInt32());return u},getUint32:function(){var h=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,h},getInt64:function(){var h,u;return this.littleEndian?(h=this.getUint32(),u=this.getUint32()):(u=this.getUint32(),h=this.getUint32()),u&2147483648?(u=~u&4294967295,h=~h&4294967295,h===4294967295&&(u=u+1&4294967295),h=h+1&4294967295,-(u*4294967296+h)):u*4294967296+h},getInt64Array:function(h){for(var u=[],p=0;p<h;p++)u.push(this.getInt64());return u},getUint64:function(){var h,u;return this.littleEndian?(h=this.getUint32(),u=this.getUint32()):(u=this.getUint32(),h=this.getUint32()),u*4294967296+h},getFloat32:function(){var h=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,h},getFloat32Array:function(h){for(var u=[],p=0;p<h;p++)u.push(this.getFloat32());return u},getFloat64:function(){var h=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,h},getFloat64Array:function(h){for(var u=[],p=0;p<h;p++)u.push(this.getFloat64());return u},getArrayBuffer:function(h){var u=this.dv.buffer.slice(this.offset,this.offset+h);return this.offset+=h,u},getString:function(h){for(var u=[],p=0;p<h;p++)u[p]=this.getUint8();var y=u.indexOf(0);return y>=0&&(u=u.slice(0,y)),js.decodeText(new Uint8Array(u))}};function f(){}f.prototype={constructor:f,add:function(h,u){this[h]=u}};function g(h){var u="Kaydara FBX Binary  \0";return h.byteLength>=u.length&&u===T(h,0,u.length)}function v(h){var u=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],p=0;function y(j){var E=h[j-1];return h=h.slice(p+j),p++,E}for(var b=0;b<u.length;++b){var A=y(1);if(A===u[b])return!1}return!0}function w(h){var u=/FBXVersion: (\d+)/,p=h.match(u);if(p){var y=parseInt(p[1]);return y}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function x(h){return h/46186158e3}var M=[];function k(h,u,p,y){var b;switch(y.mappingType){case"ByPolygonVertex":b=h;break;case"ByPolygon":b=u;break;case"ByVertice":b=p;break;case"AllSame":b=y.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+y.mappingType)}y.referenceType==="IndexToDirect"&&(b=y.indices[b]);var A=b*y.dataSize,j=A+y.dataSize;return N(M,y.buffer,A,j)}var D=new nt,B=new O;function S(h){var u=new K,p=new K,y=new K,b=new K,A=new K,j=new K,E=new K,L=new K,F=new K,I=new K,H=new K,X=h.inheritType?h.inheritType:0;if(h.translation&&u.setPosition(B.fromArray(h.translation)),h.preRotation){var _=h.preRotation.map(ct.degToRad);_.push(h.eulerOrder),p.makeRotationFromEuler(D.fromArray(_))}if(h.rotation){var _=h.rotation.map(ct.degToRad);_.push(h.eulerOrder),y.makeRotationFromEuler(D.fromArray(_))}if(h.postRotation){var _=h.postRotation.map(ct.degToRad);_.push(h.eulerOrder),b.makeRotationFromEuler(D.fromArray(_))}h.scale&&A.scale(B.fromArray(h.scale)),h.scalingOffset&&E.setPosition(B.fromArray(h.scalingOffset)),h.scalingPivot&&j.setPosition(B.fromArray(h.scalingPivot)),h.rotationOffset&&L.setPosition(B.fromArray(h.rotationOffset)),h.rotationPivot&&F.setPosition(B.fromArray(h.rotationPivot)),h.parentMatrixWorld&&(I=h.parentMatrixWorld);var q=p.multiply(y).multiply(b),$=new K;I.extractRotation($);var ee=new K;ee.copyPosition(I);var le=new K;le.getInverse($).multiply(I);var ce=new K;if(X===0)ce.copy($).multiply(q).multiply(le).multiply(A);else if(X===1)ce.copy($).multiply(le).multiply(q).multiply(A);else{var De=new K().getInverse(A),Oe=new K().multiply(le).multiply(De);ce.copy($).multiply(q).multiply(Oe).multiply(A)}var $e=new K().getInverse(F),be=new K().getInverse(j),ye=new K;ye.copy(u).multiply(L).multiply(F).multiply(p).multiply(y).multiply(b).multiply($e).multiply(E).multiply(j).multiply(A).multiply(be);var je=new K().copyPosition(ye),qe=new K().copy(I).multiply(je);return H.copyPosition(qe),ye=new K().multiply(H).multiply(ce),ye}function C(h){h=h||0;var u=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return h===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),u[0]):u[h]}function W(h){var u=h.split(",").map(function(p){return parseFloat(p)});return u}function T(h,u,p){return u===void 0&&(u=0),p===void 0&&(p=h.byteLength),js.decodeText(new Uint8Array(h,u,p))}function R(h,u){for(var p=0,y=h.length,b=u.length;p<b;p++,y++)h[y]=u[p]}function N(h,u,p,y){for(var b=p,A=0;b<y;b++,A++)h[A]=u[b];return h}function Q(h,u,p){return h.slice(0,u).concat(p).concat(h.slice(u))}return i}(),Vc=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});const dp=new Dr;function pp(n){return Vc(this,null,function*(){return new Promise((e,t)=>{dp.load(n,e,void 0,t)}).then(e=>(e.encoding=On,e.minFilter=za,e.magFilter=za,e))})}function s1(n){return Vc(this,null,function*(){return pp(n).then(e=>{const t=n.startsWith("data:")?n.includes("png"):new URL(n,location.href).pathname.toLowerCase().endsWith(".png");return{texture:e,transparent:t}})})}var fp=Object.defineProperty,vp=Object.defineProperties,gp=Object.getOwnPropertyDescriptors,al=Object.getOwnPropertySymbols,mp=Object.prototype.hasOwnProperty,yp=Object.prototype.propertyIsEnumerable,ll=(n,e,t)=>e in n?fp(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,bp=(n,e)=>{for(var t in e||(e={}))mp.call(e,t)&&ll(n,t,e[t]);if(al)for(var t of al(e))yp.call(e,t)&&ll(n,t,e[t]);return n},wp=(n,e)=>vp(n,gp(e));const Pp=1,Ap=new ie(16777215);new ie(6522623);const xp=new ie(16777215);new ie(6522623);const Op=6,jp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAIVBMVEUAAAD////////////////////////////////////////PIev5AAAACnRSTlMAG/Py2baba05un7UgfgAAAHJJREFUKM9joBpgLHVSCRdA4metAoJlCJHmVWBgAeNzroKCCVCBLpjACqgJVjCBxRBT2FbBQQJYQAohsBAsUIUQWA4WiEIILAULeCEEloAFtBACizAEMLRgGIphLabDMJ2O6TlM72MGECIIMQIZIxqoBQCPvpJ/e9FaAAAAAABJRU5ErkJggg==",Ep=new Dr().load(jp),Mp={pointTexture:Ep,pointSize:Op,lineWidth:Pp,lineColor:Ap,pointColor:xp,lineRenderOrder:20,pointsRenderOrder:20};wp(bp({},Mp),{dashed:!0});var wr={},Cp={get exports(){return wr},set exports(n){wr=n}};Cp.exports=zr;wr.default=zr;function zr(n,e,t){t=t||2;var i=e&&e.length,r=i?e[0]*t:n.length,s=Yc(n,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,d,f,g,v,w;if(i&&(s=zp(n,e,s,t)),n.length>80*t){a=d=n[0],l=f=n[1];for(var x=t;x<r;x+=t)g=n[x],v=n[x+1],g<a&&(a=g),v<l&&(l=v),g>d&&(d=g),v>f&&(f=v);w=Math.max(d-a,f-l),w=w!==0?32767/w:0}return mi(s,o,t,a,l,w,0),o}function Yc(n,e,t,i,r){var s,o;if(r===go(n,e,t,i)>0)for(s=e;s<t;s+=i)o=cl(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=cl(s,n[s],n[s+1],o);return o&&Lr(o,o.next)&&(bi(o),o=o.next),o}function on(n,e){if(!n)return n;e||(e=n);var t=n,i;do if(i=!1,!t.steiner&&(Lr(t,t.next)||oe(t.prev,t,t.next)===0)){if(bi(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function mi(n,e,t,i,r,s,o){if(n){!o&&s&&Rp(n,i,r,s);for(var a=n,l,d;n.prev!==n.next;){if(l=n.prev,d=n.next,s?Dp(n,i,r,s):Ip(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(d.i/t|0),bi(n),n=d.next,a=d.next;continue}if(n=d,n===a){o?o===1?(n=Sp(on(n),e,t),mi(n,e,t,i,r,s,2)):o===2&&kp(n,e,t,i,r,s):mi(on(n),e,t,i,r,s,1);break}}}}function Ip(n){var e=n.prev,t=n,i=n.next;if(oe(e,t,i)>=0)return!1;for(var r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,d=i.y,f=r<s?r<o?r:o:s<o?s:o,g=a<l?a<d?a:d:l<d?l:d,v=r>s?r>o?r:o:s>o?s:o,w=a>l?a>d?a:d:l>d?l:d,x=i.next;x!==e;){if(x.x>=f&&x.x<=v&&x.y>=g&&x.y<=w&&En(r,a,s,l,o,d,x.x,x.y)&&oe(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function Dp(n,e,t,i){var r=n.prev,s=n,o=n.next;if(oe(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,d=o.x,f=r.y,g=s.y,v=o.y,w=a<l?a<d?a:d:l<d?l:d,x=f<g?f<v?f:v:g<v?g:v,M=a>l?a>d?a:d:l>d?l:d,k=f>g?f>v?f:v:g>v?g:v,D=fo(w,x,e,t,i),B=fo(M,k,e,t,i),S=n.prevZ,C=n.nextZ;S&&S.z>=D&&C&&C.z<=B;){if(S.x>=w&&S.x<=M&&S.y>=x&&S.y<=k&&S!==r&&S!==o&&En(a,f,l,g,d,v,S.x,S.y)&&oe(S.prev,S,S.next)>=0||(S=S.prevZ,C.x>=w&&C.x<=M&&C.y>=x&&C.y<=k&&C!==r&&C!==o&&En(a,f,l,g,d,v,C.x,C.y)&&oe(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;S&&S.z>=D;){if(S.x>=w&&S.x<=M&&S.y>=x&&S.y<=k&&S!==r&&S!==o&&En(a,f,l,g,d,v,S.x,S.y)&&oe(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;C&&C.z<=B;){if(C.x>=w&&C.x<=M&&C.y>=x&&C.y<=k&&C!==r&&C!==o&&En(a,f,l,g,d,v,C.x,C.y)&&oe(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Sp(n,e,t){var i=n;do{var r=i.prev,s=i.next.next;!Lr(r,s)&&qc(r,i,i.next,s)&&yi(r,s)&&yi(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),bi(i),bi(i.next),i=n=s),i=i.next}while(i!==n);return on(i)}function kp(n,e,t,i,r,s){var o=n;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Wp(o,a)){var l=Jc(o,a);o=on(o,o.next),l=on(l,l.next),mi(o,e,t,i,r,s,0),mi(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function zp(n,e,t,i){var r=[],s,o,a,l,d;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,d=Yc(n,a,l,i,!1),d===d.next&&(d.steiner=!0),r.push(Np(d));for(r.sort(Lp),s=0;s<r.length;s++)t=Hp(r[s],t);return t}function Lp(n,e){return n.x-e.x}function Hp(n,e){var t=Tp(n,e);if(!t)return e;var i=Jc(t,n);return on(i,i.next),on(t,t.next)}function Tp(n,e){var t=e,i=n.x,r=n.y,s=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){var a=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,d=o.x,f=o.y,g=1/0,v;t=o;do i>=t.x&&t.x>=d&&i!==t.x&&En(r<f?i:s,r,d,f,r<f?s:i,r,t.x,t.y)&&(v=Math.abs(r-t.y)/(i-t.x),yi(t,n)&&(v<g||v===g&&(t.x>o.x||t.x===o.x&&Bp(o,t)))&&(o=t,g=v)),t=t.next;while(t!==l);return o}function Bp(n,e){return oe(n.prev,n,e.prev)<0&&oe(e.next,n,n.next)<0}function Rp(n,e,t,i){var r=n;do r.z===0&&(r.z=fo(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,Fp(r)}function Fp(n){var e,t,i,r,s,o,a,l,d=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<d&&(a++,i=i.nextZ,!!i);e++);for(l=d;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,d*=2}while(o>1);return n}function fo(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Np(n){var e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function En(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function Wp(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Xp(n,e)&&(yi(n,e)&&yi(e,n)&&Qp(n,e)&&(oe(n.prev,n,e.prev)||oe(n,e.prev,e))||Lr(n,e)&&oe(n.prev,n,n.next)>0&&oe(e.prev,e,e.next)>0)}function oe(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Lr(n,e){return n.x===e.x&&n.y===e.y}function qc(n,e,t,i){var r=Zi(oe(n,e,t)),s=Zi(oe(n,e,i)),o=Zi(oe(t,i,n)),a=Zi(oe(t,i,e));return!!(r!==s&&o!==a||r===0&&Ji(n,t,e)||s===0&&Ji(n,i,e)||o===0&&Ji(t,n,i)||a===0&&Ji(t,e,i))}function Ji(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Zi(n){return n>0?1:n<0?-1:0}function Xp(n,e){var t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&qc(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function yi(n,e){return oe(n.prev,n,n.next)<0?oe(n,e,n.next)>=0&&oe(n,n.prev,e)>=0:oe(n,e,n.prev)<0||oe(n,n.next,e)<0}function Qp(n,e){var t=n,i=!1,r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function Jc(n,e){var t=new vo(n.i,n.x,n.y),i=new vo(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function cl(n,e,t,i){var r=new vo(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function bi(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function vo(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}zr.deviation=function(n,e,t,i){var r=e&&e.length,s=r?e[0]*t:n.length,o=Math.abs(go(n,0,s,t));if(r)for(var a=0,l=e.length;a<l;a++){var d=e[a]*t,f=a<l-1?e[a+1]*t:n.length;o-=Math.abs(go(n,d,f,t))}var g=0;for(a=0;a<i.length;a+=3){var v=i[a]*t,w=i[a+1]*t,x=i[a+2]*t;g+=Math.abs((n[v]-n[x])*(n[w+1]-n[v+1])-(n[v]-n[w])*(n[x+1]-n[v+1]))}return o===0&&g===0?0:Math.abs((g-o)/o)};function go(n,e,t,i){for(var r=0,s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}zr.flatten=function(n){for(var e=n[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,r=0;r<n.length;r++){for(var s=0;s<n[r].length;s++)for(var o=0;o<e;o++)t.vertices.push(n[r][s][o]);r>0&&(i+=n[r-1].length,t.holes.push(i))}return t};function kn(n){if(n.length<3){console.error("points.length < 3");return}const[e,t,i]=n;return new O().subVectors(i,t).cross(new O().subVectors(e,t)).normalize()}function Zc(n){if(n.length<3)return[];const e=kn(n),t=new re().setFromUnitVectors(e,new O(0,1,0)),i=n.map(r=>r.clone().applyQuaternion(t)).flatMap(r=>[r.x,r.z]);return wr(i)}function $p(n,e){const t=Array.isArray(e)?e:[e];for(let i=0;i<t.length;i++){const r=n.start,s=n.end,o=t[i].start,a=t[i].end;if(!(ei(r,o)||ei(r,a)||ei(s,o)||ei(s,a)||ei(r,s))&&Gp([r.x,r.y,r.z],[s.x,s.y,s.z],[o.x,o.y,o.z],[a.x,a.y,a.z]))return!0}return!1}function Gp(n,e,t,i){const r=[e[0]-n[0],e[1]-n[1],e[2]-n[2]],s=[i[0]-t[0],i[1]-t[1],i[2]-t[2]],o=[[r[0],-s[0]],[r[1],-s[1]],[r[2],-s[2]]],a=[t[0]-n[0],t[1]-n[1],t[2]-n[2]],l=_p(o,a);if(l===null)return!1;const[d,f]=l;return!!(hl(d)&&hl(f))}function _p(n,e){if(Up(n)===0)return null;const t=Vp(n);return Yp(t,e)}function Up(n){return n[0][0]*n[1][1]-n[0][1]*n[1][0]}function Vp(n){const e=n[0][0]*n[1][1]-n[0][1]*n[1][0];return[[n[1][1]/e,-n[0][1]/e],[-n[1][0]/e,n[0][0]/e]]}function Yp(n,e){return[n[0][0]*e[0]+n[0][1]*e[1],n[1][0]*e[0]+n[1][1]*e[1]]}function hl(n){return n>=0&&n<=1}function ei(n,e){return n.x===e.x&&n.y===e.y&&n.z===e.z}function qp(n,e){const t=[...new Set(n)];if(t.length<3)return;if(t.at(-1).equals(t[0])||t.push(t[0]),e!=null&&e.checkLinesIntersect&&t.length>=5){const a=t.map((l,d)=>d===0?null:{start:t[d-1],end:t[d]}).filter(Boolean);for(let l=0;l<a.length;l++)if($p(a[l],a.slice(l)))return}const i=t.flatMap(a=>[a.x,a.y,a.z]),r=new Bt(i,3),s=Zc(t),o=new ze;return o.setAttribute("position",r),o.setIndex(s),o.name="PolygonGeometry",o}new ze;function Jp(n){const e=Zp(n);if(e.length===0){console.warn("No geometry triangles found"),console.debug({geometry:n,triangles:e});return}let t=0,i=new O;for(const[r,s,o]of e){const a=aa(r,s,o),l=Kc(r,s,o,a);t+=a,i.add(l)}return i=i.divideScalar(t),{center:i,area:t}}function aa(n,e,t){return e.clone().sub(n).cross(t.clone().sub(n)).length()/2}function Kc(n,e,t,i){const r=i??aa(n,e,t);return xi(n,e,t).multiplyScalar(r)}function Zp(n){var e;const t=n.getAttribute("position"),i=(e=n.getIndex())==null?void 0:e.array;if(!t||!i)return[];let r=[];for(let s=0;s<i.length;s+=3){const o=i[s],a=i[s+1],l=i[s+2],d=new O().fromArray([t.getX(o),t.getY(o),t.getZ(o)]),f=new O().fromArray([t.getX(a),t.getY(a),t.getZ(a)]),g=new O().fromArray([t.getX(l),t.getY(l),t.getZ(l)]);r.push([d,f,g])}return r}function Kp(n,e){const{top:t,left:i,width:r,height:s}=e.getBoundingClientRect();return new Nt((n.x-i)/r*2-1,-(n.y-t)/s*2+1)}var Pr={},ef={get exports(){return Pr},set exports(n){Pr=n}};function Ar(n){return n===null?"null":typeof n>"u"?"undefined":typeof n=="object"?Array.isArray(n)?"array":"object":typeof n}function eh(n){return Ar(n)==="object"?yo(n):Ar(n)==="array"?mo(n):n}function mo(n){return n.map(eh)}function yo(n){const e={};for(const t in n)n.hasOwnProperty(t)&&(e[t]=eh(n[t]));return e}function Hr(n,e=[],t={}){const i={arrayBehaviour:t.arrayBehaviour||"replace"},r=e.map(o=>o||{}),s=n||{};for(let o=0;o<r.length;o++){const a=r[o],l=Object.keys(a);for(let d=0;d<l.length;d++){const f=l[d],g=a[f],v=Ar(g),w=Ar(s[f]);if(v==="object")if(w!=="undefined"){const x=w==="object"?s[f]:{};s[f]=Hr({},[x,yo(g)],i)}else s[f]=yo(g);else if(v==="array")if(w==="array"){const x=mo(g);s[f]=i.arrayBehaviour==="merge"?s[f].concat(x):x}else s[f]=mo(g);else s[f]=g}}return s}ef.exports=function(n,...e){return Hr(n,e)};Pr.noMutate=function(...n){return Hr({},n)};Pr.withOptions=function(n,e,t){return Hr(n,e,t)};var tf=Object.defineProperty,nf=Object.defineProperties,rf=Object.getOwnPropertyDescriptors,ul=Object.getOwnPropertySymbols,sf=Object.prototype.hasOwnProperty,of=Object.prototype.propertyIsEnumerable,bo=(n,e,t)=>e in n?tf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dl=(n,e)=>{for(var t in e||(e={}))sf.call(e,t)&&bo(n,t,e[t]);if(ul)for(var t of ul(e))of.call(e,t)&&bo(n,t,e[t]);return n},af=(n,e)=>nf(n,rf(e)),Te=(n,e,t)=>(bo(n,typeof e!="symbol"?e+"":e,t),t);let lf=class{constructor(e,t){Te(this,"_five"),Te(this,"dragging",!1),Te(this,"boundObject",{}),Te(this,"config"),Te(this,"handleWantsGesture",(r,s)=>{if(s.length!==1)return;const o=s[0];if(o.raycaster){const a=new ro;a.ray=o.raycaster.ray,a.near=o.raycaster.near,a.far=o.raycaster.far,a.camera=o.raycaster.camera,a.layers=o.raycaster.layers,a.params=o.raycaster.params,o.raycaster=a}if(o){if(r==="mouseMove"&&this.onDomEvent("hover",o),r==="tap"){const a=new MouseEvent("click",{clientX:o.x,clientY:o.y}),l=this.onDomEvent("click",o,a),d=this.onDomEvent("wantDblclick",o,a,this.boundObject.dblclick);if(l===!1||d===!1)return!1}if(this.dragging)return!1}}),Te(this,"handleDomEvent",(r,s,o)=>{const a={x:s.clientX,y:s.clientY};this.onDomEvent(r,a,s,o)}),Te(this,"handleMouseEvent",r=>{this.handleDomEvent(r.type,r)}),Te(this,"handleMousedown",r=>{this.handleDomEvent("mousedown",r),this.handleDomEvent("dragstart",r,this.haveDragEventObject)}),Te(this,"handleMouseup",r=>{var s;this.dragging=!1,(s=this.haveDragEventObject)==null||s.forEach(o=>{o._dragging&&(o._dragging=!1,this.notify({eventName:"dragend",object:o,originEvent:r,raycaster:this.getRaycaster({x:r.clientX,y:r.clientY})}))}),this.handleDomEvent("mouseup",r)}),Te(this,"handleMousemove",r=>{var s;this.dragging&&((s=this.boundObject.drag)==null||s.forEach(o=>{o._dragging&&this.notify({eventName:"drag",object:o,originEvent:r,raycaster:this.getRaycaster({x:r.clientX,y:r.clientY})})}))}),Te(this,"onDomEvent",(r,s,o,a=this.boundObject[r])=>{var l,d,f,g,v;if(!s||!a||(a==null?void 0:a.length)===0)return;const w=[];((l=this.config)==null?void 0:l.fiveModels)!==null&&((d=this.config)!=null&&d.fiveModels?w.push(...this.config.fiveModels):w.push(this.model));const x=w.filter(C=>C.loaded),M=(f=s.raycaster)!=null?f:this.getRaycaster(s);M.params.Points.threshold=.04;const k=M.intersectObjects(a,!0),D=[];x.forEach(C=>{const W=C.intersectRaycaster(M);D.push(...W)});const B=.01;if(D.length>0&&k.length>0&&D[0].distance+B<k[0].distance)return;const S=(g=k==null?void 0:k[0])==null?void 0:g.object;if(r==="wantDblclick")return!1;if((!S||!this.objectIsBound(S))&&r==="hover")for(const C of(v=this.boundObject.hover)!=null?v:[])C._hovered&&this.notify({eventName:"unHover",object:C});if(S&&S&&this.notify({eventName:r,object:S,originEvent:o,raycaster:M,intersects:k,fiveModelIntersects:D}))return!1}),Te(this,"objectIsBound",r=>{let s=r._domEvent,o=r.parent;for(;typeof s>"u"&&o;)s=o._domEvent,o=o.parent;return!!s}),Te(this,"notify",r=>{var s,o,a,l,d,f,g;const{eventName:v,object:w,originEvent:x,raycaster:M,intersects:k,fiveModelIntersects:D}=r;if(!w)return!1;let B=!1,S=[];const C=[],W=()=>{if(!k)return!1;const Q=k.slice(1);return Q[0]?this.notify(af(dl({},r),{object:Q[0].object,intersects:Q})):!1};let T=w;for(C.push(T);T.parent;)T=T.parent,C.push(T);const R=C[C.length-1];if((s=this.config)!=null&&s.noEmitWhenNotInScene&&R.type!=="Scene")return W();let N=!1;for(const Q of C){if(B)break;Q.draggable&&(v==="dragstart"&&(Q._dragging=!0,this.dragging=!0),v==="dragend"&&(Q._dragging=!1,this.dragging=!1));const h=Q._domEvent;if(!h)continue;const u=h[`${v}Handler`];if(u)for(const[p,y]of u){if(y!=null&&y.noEmitWhenNotInScene&&R.type!=="Scene")continue;if(y.skipPano&&D){const A=(o=D[0])==null?void 0:o.point;if(A&&(d=(l=(a=this.five.observers)==null?void 0:a[this.five.panoIndex])==null?void 0:l.accessibleNodes)!=null&&d.some(j=>{var E;const L=(E=this.five.works.getResolvedObserver({workCode:this.five.state.workCode,panoIndex:j}))==null?void 0:E.standingPosition;return(L==null?void 0:L.distanceTo(A))<.3}))continue}if(((f=this.config)!=null&&f.noEmitWhenHide||y!=null&&y.noEmitWhenHide)&&!Qh(Q))continue;if(N=!0,v==="hover"){if(Q._hovered)continue;Q._hovered=!0;for(const A of(g=this.boundObject.hover)!=null?g:[])A!==Q&&A._hovered&&this.notify({eventName:"unHover",object:A})}if(v==="unHover"){if(!Q._hovered)continue;Q._hovered=!1}const b=p({type:v,target:Q,origDomEvent:x,raycaster:M,intersects:k,stopPropagation:()=>{B=!0}});S.push(b??!0)}}if(N===!1)return W();if(v==="click"||v==="wantDblclick")return S.some(Q=>Q===!0)});var i;this.five=e,this.config=t,e.off("wantsGesture",this.handleWantsGesture),e.on("wantsGesture",this.handleWantsGesture),document.addEventListener("mousedown",this.handleMousedown),document.addEventListener("dblclick",this.handleMouseEvent),document.addEventListener("mouseup",this.handleMouseup),document.addEventListener("mousemove",this.handleMousemove),window.__FIVE_DOM_EVENTS__=(i=window.__FIVE_DOM_EVENTS__)!=null?i:[],window.__FIVE_DOM_EVENTS__.push(this)}get five(){return this._five}set five(e){var t;(t=this._five)==null||t.off("wantsGesture",this.handleWantsGesture),this._five=e,this._five.on("wantsGesture",this.handleWantsGesture)}get haveDragEventObject(){return[...new Set([this.boundObject.dragend,this.boundObject.drag,this.boundObject.dragstart].flat())].filter(Boolean)}get model(){return jc(this.five)}addAutoBindEventListener(e,t,i,r){const s=()=>this.addEventListener(e,t,i,r),o=()=>this.removeEventListener(e,t,i,r);return e.addEventListener("added",s),e.addEventListener("removed",o),e.addEventListener("dispose",o),()=>{e.removeEventListener("added",s),e.removeEventListener("removed",o),e.removeEventListener("dispose",o)}}addEventListener(e,t,i,r){e._domEvent||(e._domEvent={}),e._domEvent[`${t}Handler`]||(e._domEvent[`${t}Handler`]=[]),this.boundObject[t]||(this.boundObject[t]=[]),this.boundObject[t].includes(e)||this.boundObject[t].push(e),e._domEvent[`${t}Handler`].push([i,dl({noEmitWhenHide:!1,noEmitWhenNotInScene:!1},r)])}removeEventListener(e,t,i,...r){var s,o;if(!e._domEvent||(t===void 0&&(Object.keys(this.boundObject).forEach(l=>{var d,f;const g=(d=this.boundObject[l])==null?void 0:d.findIndex(v=>v===e);g!==-1&&((f=this.boundObject[l])==null||f.splice(g,1))}),e._domEvent={}),!e._domEvent[`${t}Handler`]))return;if(i===void 0){delete e._domEvent[`${t}Handler`];return}const a=e._domEvent[`${t}Handler`].findIndex(l=>l[0]===i);if(a!==-1&&(e._domEvent[`${t}Handler`].splice(a,1),e._domEvent[`${t}Handler`].length===0&&delete e._domEvent[`${t}Handler`],e._domEvent&&Object.keys(e._domEvent).length===0&&delete e._domEvent,!e._domEvent)){const l=(s=this.boundObject[t])==null?void 0:s.findIndex(d=>d===e);l!==-1&&((o=this.boundObject[t])==null||o.splice(l,1))}}clear(){this.boundObject={}}dispose(){var e;(e=this.five)==null||e.off("wantsGesture",this.handleWantsGesture),document.removeEventListener("mousedown",this.handleMousedown),document.removeEventListener("mouseup",this.handleMouseup),document.removeEventListener("mousemove",this.handleMousemove),this.boundObject={}}toJSON(){return{boundObject:this.boundObject}}getRaycaster(e){const t=this.five.getElement();if(!t)return;const i=Kp(e,t),r=new ro;return r.setFromCamera(i,this.five.camera),r}};var cf=Object.defineProperty,hf=Object.defineProperties,uf=Object.getOwnPropertyDescriptors,pl=Object.getOwnPropertySymbols,df=Object.prototype.hasOwnProperty,pf=Object.prototype.propertyIsEnumerable,wo=(n,e,t)=>e in n?cf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ki=(n,e)=>{for(var t in e||(e={}))df.call(e,t)&&wo(n,t,e[t]);if(pl)for(var t of pl(e))pf.call(e,t)&&wo(n,t,e[t]);return n},fl=(n,e)=>hf(n,uf(e)),Zt=(n,e,t)=>(wo(n,typeof e!="symbol"?e+"":e,t),t);let Po=class extends ft{constructor(e){super(),Zt(this,"name","LineWithDotsMesh"),Zt(this,"pointGroup",new Et),Zt(this,"_paramsStyle"),Zt(this,"setStyle",t=>{super.setStyle(t),this._paramsStyle=Ki(Ki({},this._paramsStyle),t),this.pointMeshes.forEach(i=>{var r,s,o;return i.setStyle(fl(Ki({},this._paramsStyle),{color:(o=(r=this._paramsStyle)==null?void 0:r.pointColor)!=null?o:(s=this._paramsStyle)==null?void 0:s.lineColor,tip:void 0}))}),this.updateEdgePointsVisibility(),this.needsRender=!0}),Zt(this,"highlight",t=>{super.highlight(t),this.pointMeshes.forEach(i=>i.highlight())}),Zt(this,"unhighlight",()=>{super.unhighlight(),this.pointMeshes.forEach(t=>t.unhighlight())}),Zt(this,"updateEdgePointsVisibility",()=>{var t;xe((t=this._paramsStyle)==null?void 0:t.pointVisibility)&&(this.startPoint&&(this.startPoint.visible=typeof this._paramsStyle.pointVisibility=="object"?this._paramsStyle.pointVisibility.startPoint:this._paramsStyle.pointVisibility),this.endPoint&&(this.endPoint.visible=typeof this._paramsStyle.pointVisibility=="object"?this._paramsStyle.pointVisibility.endPoint:this._paramsStyle.pointVisibility))}),this.add(this.pointGroup),e&&this.setStyle(e),e!=null&&e.points&&this.setPoints(e.points)}get startPoint(){return this.pointMeshes[0]}get endPoint(){return this.pointMeshes.length<2?null:this.pointMeshes[this.pointMeshes.length-1]}get visiblePointMeshes(){return this.pointMeshes.filter(e=>e.visible)}get pointMeshes(){return this.pointGroup.children}setPoints(e){super.setPoints(e);const t=e.map(he).filter(xe);this.pointGroup.removeChildren(),this.addIfNotExists(this.pointGroup),t.forEach(i=>{var r,s,o;const a=new Dn(fl(Ki({},this.style),{color:(o=(r=this._paramsStyle)==null?void 0:r.pointColor)!=null?o:(s=this._paramsStyle)==null?void 0:s.lineColor,tip:void 0}));a.position.copy(i),this.pointGroup.add(a)}),this.updateEdgePointsVisibility(),this.needsRender=!0}};var ff=Object.defineProperty,vl=Object.getOwnPropertySymbols,vf=Object.prototype.hasOwnProperty,gf=Object.prototype.propertyIsEnumerable,Ao=(n,e,t)=>e in n?ff(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,gl=(n,e)=>{for(var t in e||(e={}))vf.call(e,t)&&Ao(n,t,e[t]);if(vl)for(var t of vl(e))gf.call(e,t)&&Ao(n,t,e[t]);return n},St=(n,e,t)=>(Ao(n,typeof e!="symbol"?e+"":e,t),t);let Tr=class extends Et{constructor(e){var t,i;super(),St(this,"name","ColoredMesh"),St(this,"meshFont"),St(this,"meshBackground"),St(this,"paramsStyle",{}),St(this,"_geometry",new ze),St(this,"highlighted",!1),St(this,"opacityBeforeHighlight"),St(this,"colorBeforeHighlight"),this.paramsStyle=e??{};const r=new Ie({color:new ie((t=e==null?void 0:e.color)!=null?t:$h).convertSRGBToLinear(),transparent:!0,side:We,depthTest:!0,depthWrite:!1,opacity:(i=e==null?void 0:e.opacity)!=null?i:Gh}),s=new Ie({color:16777215,transparent:!0,side:We,depthTest:!1,depthWrite:!1,opacity:.3/.5*r.opacity}),o=new ue(this.geometry,r),a=new ue(this.geometry,s);o.name="MeshFront",a.name="MeshBackground",o.renderOrder=1,a.renderOrder=0,this.meshFont=o,this.meshBackground=a,this.add(o),this.setOcclusionVisibility({occlusionVisibility:e==null?void 0:e.occlusionVisibility,occlusionMode:e==null?void 0:e.occlusionMode})}get style(){return{color:this.color,opacity:this.opacity,occlusionVisibility:this.occlusionVisibility,occlusionMode:this.occlusionMode}}get color(){return this.meshFont.material.color}get opacity(){return this.meshFont.material.opacity}get occlusionVisibility(){return!!this.meshBackground.parent||this.meshFont.material.depthTest===!1}get occlusionMode(){return this.meshFont.material.depthTest===!1?"depthTest":"translucence"}set geometry(e){this._geometry=e,this.meshFont.geometry=e,this.meshBackground.geometry=e}get geometry(){return this._geometry}setStyle(e){this.paramsStyle=gl(gl({},this.paramsStyle),e),xe(e.color)&&(this.meshFont.material.color.set(new ie(e.color).convertSRGBToLinear()),this.needsRender=!0),xe(e.opacity)&&(this.meshFont.material.opacity=e.opacity,this.meshBackground.material.opacity=.3/.5*this.meshFont.material.opacity,this.needsRender=!0),this.setOcclusionVisibility(e)}highlight(e){var t,i;this.highlighted=!0,xe(e==null?void 0:e.color)?(this.colorBeforeHighlight=(t=this.colorBeforeHighlight)!=null?t:this.meshFont.material.color.clone(),this.meshFont.material.color.set(new ie(e.color).convertSRGBToLinear())):(this.opacityBeforeHighlight=(i=this.opacityBeforeHighlight)!=null?i:this.opacity,this.meshFont.material.opacity=this.opacity*_h,this.meshBackground.material.opacity=.3/.5*this.meshFont.material.opacity),this.needsRender=!0}unhighlight(){this.highlighted=!1,xe(this.opacityBeforeHighlight)&&(this.meshFont.material.opacity=this.opacityBeforeHighlight,this.meshBackground.material.opacity=.3/.5*this.meshFont.material.opacity,this.opacityBeforeHighlight=void 0),xe(this.colorBeforeHighlight)&&(this.meshFont.material.color=new ie(this.colorBeforeHighlight),this.colorBeforeHighlight=void 0),this.needsRender=!0}setOcclusionVisibility(e){var t,i,r;const s=(i=(t=e.occlusionMode)!=null?t:this.paramsStyle.occlusionMode)!=null?i:"translucence",o=(r=e.occlusionVisibility)!=null?r:this.paramsStyle.occlusionVisibility;xe(o)&&(o?s==="depthTest"?(this.meshFont.material.depthTest=!1,this.remove(this.meshBackground)):s==="translucence"&&(this.meshFont.material.depthTest=!0,this.addIfNotExists(this.meshBackground)):(this.meshFont.material.depthTest=!0,this.remove(this.meshBackground)))}};var mf=Object.defineProperty,yf=Object.defineProperties,bf=Object.getOwnPropertyDescriptors,ml=Object.getOwnPropertySymbols,wf=Object.prototype.hasOwnProperty,Pf=Object.prototype.propertyIsEnumerable,xo=(n,e,t)=>e in n?mf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Is=(n,e)=>{for(var t in e||(e={}))wf.call(e,t)&&xo(n,t,e[t]);if(ml)for(var t of ml(e))Pf.call(e,t)&&xo(n,t,e[t]);return n},Af=(n,e)=>yf(n,bf(e)),Be=(n,e,t)=>(xo(n,typeof e!="symbol"?e+"":e,t),t);const la=new ze;la.name="blankGeometry";la.isBlank=!0;let ca=class extends Tr{constructor(e){super(e),Be(this,"name","PolygonMesh"),Be(this,"points",[]),Be(this,"planeHelperNeedUpdate",!0),Be(this,"geometryInfoNeedUpdate",!0),Be(this,"_paramsStyle"),Be(this,"areaDom"),Be(this,"planeHelper",null),Be(this,"_geometryInfo",null),Be(this,"lastRenderAreaItem"),Be(this,"_onAdded",()=>{this.areaDom||this.updateAreaItems()}),Be(this,"_onRemoved",()=>{var t;(t=this.areaDom)==null||t.destroy(),this.areaDom=void 0}),Be(this,"_onShowed",()=>{this.areaDom&&(this.areaDom.container.style.display="block")}),Be(this,"_onHidden",()=>{this.areaDom&&(this.areaDom.container.style.display="none")}),e!=null&&e.points&&this.setPoints(e.points),this._paramsStyle=e??{},this.updateAreaItems(),this.addEventListener("removed",()=>{Vi.cacheObject.delete(this),Vi.checkDom(this)}),this.addEventListener("added",()=>{Vi.cacheObject.add(this)}),Vi.checkDomEveryFrame()}get normal(){return this.points.length>=3?new O().crossVectors(this.points[1].clone().sub(this.points[0]),this.points[2].clone().sub(this.points[0])).normalize():new O(0,0,1)}get style(){return Af(Is({},super.style),{lengthEnable:this._paramsStyle.lengthEnable})}get isBlank(){return!!this.geometry.isBlank}get center(){var e;return(e=this.geometryInfo)==null?void 0:e.center.clone()}get geometryInfo(){return this.geometryInfoNeedUpdate&&(this.isBlank?this._geometryInfo=null:this._geometryInfo=Jp(this.geometry),this.geometryInfoNeedUpdate=!1),this._geometryInfo}get five(){var e,t;return(t=(e=window.globalModules)==null?void 0:e.five)!=null?t:window.$five}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.center){const t=Ec(this,this.center).toArray().join(",");t!==this.lastRenderAreaItem&&(this.updateAreaItems(),this.lastRenderAreaItem=t)}}setStyle(e){var t;this._paramsStyle=Is(Is({},this._paramsStyle),e),super.setStyle(this._paramsStyle);const i=(t=this._paramsStyle.occlusionVisibility)!=null?t:!0;this.areaDom&&(this.areaDom.intersectCheck=!i),this.updateAreaItems()}setPoints(e,t){var i,r;const s=e.map(he);this.points=s,this.geometry=(r=qp(this.points,{checkLinesIntersect:(i=t==null?void 0:t.checkLinesIntersect)!=null?i:!0}))!=null?r:la,this.planeHelperNeedUpdate=!0,this.geometryInfoNeedUpdate=!0,this.updateAreaItems()}projectPoint(e){return e&&(this.planeHelperNeedUpdate&&this.updatePlaneHelper(),this.planeHelper?this.planeHelper.projectPoint(e,new O):e)}updatePlaneHelper(){this.points.length>=3?this.planeHelper=new Xe().setFromCoplanarPoints(this.points[0],this.points[1],this.points[2]):this.planeHelper=null,this.planeHelperNeedUpdate=!1}updateAreaItems(){var e;const t=()=>{var r;(r=this.areaDom)==null||r.destroy(),this.areaDom=void 0};if(!this._paramsStyle.lengthEnable||!this.geometryInfo)return t();if(!this.five)return console.error("Five not found");this.areaDom=(e=this.areaDom)!=null?e:(()=>{var r;const s=new Uh(this.five),o=(r=this._paramsStyle.occlusionVisibility)!=null?r:!0;return s.intersectCheck=!o,s.simulate3D=!0,s})(),this.areaDom.setPosition(this.center);const i=Vh(this.geometryInfo.area,this._paramsStyle.lengthUnit);i?this.areaDom.container.innerHTML=Yh(i,{style:"color: #FFFFFF; background: #3366FF"}):this.areaDom.container.innerHTML=""}};function xf(n,e){return!(Math.abs(n.x-e.x)>1e-5||Math.abs(n.y-e.y)>1e-5||Math.abs(n.z-e.z)>1e-5)}const Ds=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Ss(n,e,t,i){n.addEventListener?n.addEventListener(e,t,i):n.attachEvent&&n.attachEvent("on".concat(e),t)}function ti(n,e,t,i){n.removeEventListener?n.removeEventListener(e,t,i):n.detachEvent&&n.detachEvent("on".concat(e),t)}function th(n,e){const t=e.slice(0,e.length-1);for(let i=0;i<t.length;i++)t[i]=n[t[i].toLowerCase()];return t}function nh(n){typeof n!="string"&&(n=""),n=n.replace(/\s/g,"");const e=n.split(",");let t=e.lastIndexOf("");for(;t>=0;)e[t-1]+=",",e.splice(t,1),t=e.lastIndexOf("");return e}function Of(n,e){const t=n.length>=e.length?n:e,i=n.length>=e.length?e:n;let r=!0;for(let s=0;s<t.length;s++)i.indexOf(t[s])===-1&&(r=!1);return r}const wi={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Ds?173:189,"=":Ds?61:187,";":Ds?59:186,"'":222,"[":219,"]":221,"\\":220},vt={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},Oo={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Ae={16:!1,18:!1,17:!1,91:!1},ae={};for(let n=1;n<20;n++)wi["f".concat(n)]=111+n;let ne=[],pi=null,ih="all";const xt=new Map,Ei=n=>wi[n.toLowerCase()]||vt[n.toLowerCase()]||n.toUpperCase().charCodeAt(0),jf=n=>Object.keys(wi).find(e=>wi[e]===n),Ef=n=>Object.keys(vt).find(e=>vt[e]===n);function rh(n){ih=n||"all"}function Pi(){return ih||"all"}function Mf(){return ne.slice(0)}function Cf(){return ne.map(n=>jf(n)||Ef(n)||String.fromCharCode(n))}function If(){const n=[];return Object.keys(ae).forEach(e=>{ae[e].forEach(t=>{let{key:i,scope:r,mods:s,shortcut:o}=t;n.push({scope:r,shortcut:o,mods:s,keys:i.split("+").map(a=>Ei(a))})})}),n}function Df(n){const e=n.target||n.srcElement,{tagName:t}=e;let i=!0;const r=t==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(r||t==="TEXTAREA"||t==="SELECT")&&!e.readOnly)&&(i=!1),i}function Sf(n){return typeof n=="string"&&(n=Ei(n)),ne.indexOf(n)!==-1}function kf(n,e){let t,i;n||(n=Pi());for(const r in ae)if(Object.prototype.hasOwnProperty.call(ae,r))for(t=ae[r],i=0;i<t.length;)t[i].scope===n?t.splice(i,1).forEach(s=>{let{element:o}=s;return ha(o)}):i++;Pi()===n&&rh(e||"all")}function zf(n){let e=n.keyCode||n.which||n.charCode;const t=ne.indexOf(e);if(t>=0&&ne.splice(t,1),n.key&&n.key.toLowerCase()==="meta"&&ne.splice(0,ne.length),(e===93||e===224)&&(e=91),e in Ae){Ae[e]=!1;for(const i in vt)vt[i]===e&&(Ne[i]=!1)}}function sh(n){if(typeof n>"u")Object.keys(ae).forEach(r=>{Array.isArray(ae[r])&&ae[r].forEach(s=>er(s)),delete ae[r]}),ha(null);else if(Array.isArray(n))n.forEach(r=>{r.key&&er(r)});else if(typeof n=="object")n.key&&er(n);else if(typeof n=="string"){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];let[r,s]=t;typeof r=="function"&&(s=r,r=""),er({key:n,scope:r,method:s,splitKey:"+"})}}const er=n=>{let{key:e,scope:t,method:i,splitKey:r="+"}=n;nh(e).forEach(s=>{const o=s.split(r),a=o.length,l=o[a-1],d=l==="*"?"*":Ei(l);if(!ae[d])return;t||(t=Pi());const f=a>1?th(vt,o):[],g=[];ae[d]=ae[d].filter(v=>{const w=(i?v.method===i:!0)&&v.scope===t&&Of(v.mods,f);return w&&g.push(v.element),!w}),g.forEach(v=>ha(v))})};function yl(n,e,t,i){if(e.element!==i)return;let r;if(e.scope===t||e.scope==="all"){r=e.mods.length>0;for(const s in Ae)Object.prototype.hasOwnProperty.call(Ae,s)&&(!Ae[s]&&e.mods.indexOf(+s)>-1||Ae[s]&&e.mods.indexOf(+s)===-1)&&(r=!1);(e.mods.length===0&&!Ae[16]&&!Ae[18]&&!Ae[17]&&!Ae[91]||r||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat(ne),e.method(n,e)===!1&&(n.preventDefault?n.preventDefault():n.returnValue=!1,n.stopPropagation&&n.stopPropagation(),n.cancelBubble&&(n.cancelBubble=!0)))}}function bl(n,e){const t=ae["*"];let i=n.keyCode||n.which||n.charCode;if(!Ne.filter.call(this,n))return;if((i===93||i===224)&&(i=91),ne.indexOf(i)===-1&&i!==229&&ne.push(i),["ctrlKey","altKey","shiftKey","metaKey"].forEach(a=>{const l=Oo[a];n[a]&&ne.indexOf(l)===-1?ne.push(l):!n[a]&&ne.indexOf(l)>-1?ne.splice(ne.indexOf(l),1):a==="metaKey"&&n[a]&&ne.length===3&&(n.ctrlKey||n.shiftKey||n.altKey||(ne=ne.slice(ne.indexOf(l))))}),i in Ae){Ae[i]=!0;for(const a in vt)vt[a]===i&&(Ne[a]=!0);if(!t)return}for(const a in Ae)Object.prototype.hasOwnProperty.call(Ae,a)&&(Ae[a]=n[Oo[a]]);n.getModifierState&&!(n.altKey&&!n.ctrlKey)&&n.getModifierState("AltGraph")&&(ne.indexOf(17)===-1&&ne.push(17),ne.indexOf(18)===-1&&ne.push(18),Ae[17]=!0,Ae[18]=!0);const r=Pi();if(t)for(let a=0;a<t.length;a++)t[a].scope===r&&(n.type==="keydown"&&t[a].keydown||n.type==="keyup"&&t[a].keyup)&&yl(n,t[a],r,e);if(!(i in ae))return;const s=ae[i],o=s.length;for(let a=0;a<o;a++)if((n.type==="keydown"&&s[a].keydown||n.type==="keyup"&&s[a].keyup)&&s[a].key){const l=s[a],{splitKey:d}=l,f=l.key.split(d),g=[];for(let v=0;v<f.length;v++)g.push(Ei(f[v]));g.sort().join("")===ne.sort().join("")&&yl(n,l,r,e)}}function Ne(n,e,t){ne=[];const i=nh(n);let r=[],s="all",o=document,a=0,l=!1,d=!0,f="+",g=!1,v=!1;for(t===void 0&&typeof e=="function"&&(t=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(s=e.scope),e.element&&(o=e.element),e.keyup&&(l=e.keyup),e.keydown!==void 0&&(d=e.keydown),e.capture!==void 0&&(g=e.capture),typeof e.splitKey=="string"&&(f=e.splitKey),e.single===!0&&(v=!0)),typeof e=="string"&&(s=e),v&&sh(n,s);a<i.length;a++)n=i[a].split(f),r=[],n.length>1&&(r=th(vt,n)),n=n[n.length-1],n=n==="*"?"*":Ei(n),n in ae||(ae[n]=[]),ae[n].push({keyup:l,keydown:d,scope:s,mods:r,shortcut:i[a],method:t,key:i[a],splitKey:f,element:o});if(typeof o<"u"&&window){if(!xt.has(o)){const w=function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return bl(M,o)},x=function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;bl(M,o),zf(M)};xt.set(o,{keydownListener:w,keyupListenr:x,capture:g}),Ss(o,"keydown",w,g),Ss(o,"keyup",x,g)}if(!pi){const w=()=>{ne=[]};pi={listener:w,capture:g},Ss(window,"focus",w,g)}}}function Lf(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(ae).forEach(t=>{ae[t].filter(i=>i.scope===e&&i.shortcut===n).forEach(i=>{i&&i.method&&i.method()})})}function ha(n){const e=Object.values(ae).flat();if(e.findIndex(t=>{let{element:i}=t;return i===n})<0){const{keydownListener:t,keyupListenr:i,capture:r}=xt.get(n)||{};t&&i&&(ti(n,"keyup",i,r),ti(n,"keydown",t,r),xt.delete(n))}if((e.length<=0||xt.size<=0)&&(Object.keys(xt).forEach(t=>{const{keydownListener:i,keyupListenr:r,capture:s}=xt.get(t)||{};i&&r&&(ti(t,"keyup",r,s),ti(t,"keydown",i,s),xt.delete(t))}),xt.clear(),Object.keys(ae).forEach(t=>delete ae[t]),pi)){const{listener:t,capture:i}=pi;ti(window,"focus",t,i),pi=null}}const ks={getPressedKeyString:Cf,setScope:rh,getScope:Pi,deleteScope:kf,getPressedKeyCodes:Mf,getAllKeyCodes:If,isPressed:Sf,filter:Df,trigger:Lf,unbind:sh,keyMap:wi,modifier:vt,modifierMap:Oo};for(const n in ks)Object.prototype.hasOwnProperty.call(ks,n)&&(Ne[n]=ks[n]);if(typeof window<"u"){const n=window.hotkeys;Ne.noConflict=e=>(e&&window.hotkeys===Ne&&(window.hotkeys=n),Ne),window.hotkeys=Ne}const Hf="data:image/png;base64,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",Tf=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="22" height="22" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
        <linearGradient id="grad1" x1="22.39%" y1="67.34%" x2="56.24%" y2="-36.34%">
            <stop stop-color="#FFFFFF" offset="0%"/>
            <stop stop-color="#FFFFFF" stop-opacity="0.5" offset="100%"/>
        </linearGradient>
    </defs>
    <g fill-rule="nonzero" transform="translate(3.39, 2.29)">
        <path d="M14.39,3.17C14.82,3.17,15.17,3.52,15.17,3.96C15.17,4.4,14.82,4.75,14.39,4.75L14.06,4.75L13.16,15.72C13.08,16.68,12.29,17.42,11.34,17.42H3.87C2.92,17.42,2.13,16.68,2.06,15.72L1.15,4.75L0.83,4.75C0.4,4.75,0.05,4.4,0.05,3.96C0.05,3.52,0.4,3.17,0.83,3.17L14.39,3.17ZM12.49,4.75L2.72,4.75L3.61,15.59C3.62,15.71,3.7,15.8,3.81,15.82L3.87,15.83H11.34C11.48,15.83,11.59,15.73,11.6,15.59L12.49,4.75ZM6.04,7.39C6.48,7.39,6.83,7.74,6.83,8.18V12.4C6.83,12.84,6.48,13.19,6.04,13.19C5.61,13.19,5.26,12.84,5.26,12.4V8.18C5.26,7.74,5.61,7.39,6.04,7.39ZM9.17,7.39C9.61,7.39,9.96,7.74,9.96,8.18V12.4C9.96,12.84,9.61,13.19,9.17,13.19C8.74,13.19,8.39,12.84,8.39,12.4V8.18C8.39,7.74,8.74,7.39,9.17,7.39ZM10.22,0C10.65,0,11,0.35,11,0.79C11,1.23,10.65,1.58,10.22,1.58H5C4.57,1.58,4.22,1.23,4.22,0.79C4.22,0.35,4.57,0,5,0H10.22Z" fill="url(#grad1)"/>
    </g>
</svg>`;var Bf=Object.defineProperty,Rf=(n,e,t)=>e in n?Bf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wl=(n,e,t)=>(Rf(n,typeof e!="symbol"?e+"":e,t),t);const Ff={auto:"",pen:"","pen-forbidden":"","pen-crosshair":"","pne-polygon":"","pen-circle":"","crosshair-rectangle":"","crosshair-circle":""},Nf={position:"absolute",width:"34px",height:"34px",transform:"translate(-50%, -40px)",borderRadius:"50%",cursor:"pointer",zIndex:"9999",userSelect:"none",display:"flex",pointerEvents:"auto",alignItems:"center",justifyContent:"center",backgroundSize:"34px 34px",backgroundPosition:"center",backgroundRepeat:"no-repeat"},Wf=`
  <div style="width: 32px; height: 32px; background-color: rgba(0, 0, 0, 0.5); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
    ${Tf}
  </div>
`;let Xf=class{constructor(e){wl(this,"container"),wl(this,"deleteButton"),this.container=e??document.documentElement}setType(e){const t=Ff[e];t?this.container.style.cursor=`url(${t}), auto`:this.container.style.cursor=e}showDeleteButton(e){const{clientX:t,clientY:i,container:r=this.container,onClick:s}=e;let o=this.deleteButton;return o||(o=document.createElement("div"),Object.assign(o.style,Nf),o.style.backgroundImage=`url(${Hf})`,o.innerHTML=Wf),this.deleteButton=o,r.appendChild(o),o.style.left=`${t}px`,o.style.top=`${i}px`,o.onclick=()=>{r.removeChild(o),s()},o}removeDeleteButton(){this.deleteButton&&this.deleteButton.remove()}tip(e){return()=>this.closeTip()}closeTip(){}reset(){this.container.style.cursor="auto"}};var jo={},Qf={get exports(){return jo},set exports(n){jo=n}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var s="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(s=r(s,i(a)))}return s}function i(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var o="";for(var a in s)e.call(s,a)&&s[a]&&(o=r(o,a));return o}function r(s,o){return o?s?s+" "+o:s+o:s}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(Qf);const u1=jo;var $f=Gf;function Gf(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}var _f=Uf;function Uf(n,e,t){return n[0]=e,n[1]=t,n}var Vf=Yf;function Yf(n,e){var t=e[0],i=e[1],r=t*t+i*i;return r>0&&(r=1/Math.sqrt(r),n[0]=e[0]*r,n[1]=e[1]*r),n}var qf=Jf;function Jf(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}var Zf=Kf;function Kf(n,e){return n[0]*e[0]+n[1]*e[1]}var ua={},ev=$f,Eo=_f,oh=Vf,tv=qf,nv=Zf,Pl=[0,0];ua.computeMiter=function(n,e,t,i,r){return ev(n,t,i),oh(n,n),Eo(e,-n[1],n[0]),Eo(Pl,-t[1],t[0]),r/nv(e,Pl)};ua.normal=function(n,e){return Eo(n,-e[1],e[0]),n};ua.direction=function(n,e,t){return tv(n,e,t),oh(n,n),n};const iv=navigator.userAgent.toLowerCase().indexOf("iphone")!==-1;navigator.userAgent.toLowerCase().indexOf("android");const rv=navigator.userAgent.toLowerCase().indexOf("micromessenger")!==-1,d1=iv&&rv,zs=Math.PI*2;function Al(n){return(n%zs+zs)%zs}function zn(){let n,e;return{promise:new Promise((t,i)=>{n=t,e=i}),resolve:n,reject:e}}const sv=new Ou;function p1(n){return new Promise((e,t)=>{function i(s){e(s)}function r(s){t(s)}sv.load(n,i,void 0,r)})}function ov(){return Math.random().toString(36).slice(-6)}const f1=ov();var Ue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},av="Expected a function",ah="__lodash_hash_undefined__",lh=1/0,lv="[object Function]",cv="[object GeneratorFunction]",hv="[object Symbol]",uv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dv=/^\w*$/,pv=/^\./,fv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vv=/[\\^$.*+?()[\]{}|]/g,gv=/\\(\\)?/g,mv=/^\[object .+?Constructor\]$/,yv=typeof Ue=="object"&&Ue&&Ue.Object===Object&&Ue,bv=typeof self=="object"&&self&&self.Object===Object&&self,da=yv||bv||Function("return this")();function wv(n,e){return n==null?void 0:n[e]}function Pv(n){var e=!1;if(n!=null&&typeof n.toString!="function")try{e=!!(n+"")}catch{}return e}var Av=Array.prototype,xv=Function.prototype,ch=Object.prototype,Ls=da["__core-js_shared__"],xl=function(){var n=/[^.]+$/.exec(Ls&&Ls.keys&&Ls.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),hh=xv.toString,pa=ch.hasOwnProperty,uh=ch.toString,Ov=RegExp("^"+hh.call(pa).replace(vv,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ol=da.Symbol,jv=Av.splice,Ev=dh(da,"Map"),Ai=dh(Object,"create"),jl=Ol?Ol.prototype:void 0,El=jl?jl.toString:void 0;function an(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}function Mv(){this.__data__=Ai?Ai(null):{}}function Cv(n){return this.has(n)&&delete this.__data__[n]}function Iv(n){var e=this.__data__;if(Ai){var t=e[n];return t===ah?void 0:t}return pa.call(e,n)?e[n]:void 0}function Dv(n){var e=this.__data__;return Ai?e[n]!==void 0:pa.call(e,n)}function Sv(n,e){var t=this.__data__;return t[n]=Ai&&e===void 0?ah:e,this}an.prototype.clear=Mv;an.prototype.delete=Cv;an.prototype.get=Iv;an.prototype.has=Dv;an.prototype.set=Sv;function Ln(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}function kv(){this.__data__=[]}function zv(n){var e=this.__data__,t=Br(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():jv.call(e,t,1),!0}function Lv(n){var e=this.__data__,t=Br(e,n);return t<0?void 0:e[t][1]}function Hv(n){return Br(this.__data__,n)>-1}function Tv(n,e){var t=this.__data__,i=Br(t,n);return i<0?t.push([n,e]):t[i][1]=e,this}Ln.prototype.clear=kv;Ln.prototype.delete=zv;Ln.prototype.get=Lv;Ln.prototype.has=Hv;Ln.prototype.set=Tv;function cn(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}function Bv(){this.__data__={hash:new an,map:new(Ev||Ln),string:new an}}function Rv(n){return Rr(this,n).delete(n)}function Fv(n){return Rr(this,n).get(n)}function Nv(n){return Rr(this,n).has(n)}function Wv(n,e){return Rr(this,n).set(n,e),this}cn.prototype.clear=Bv;cn.prototype.delete=Rv;cn.prototype.get=Fv;cn.prototype.has=Nv;cn.prototype.set=Wv;function Br(n,e){for(var t=n.length;t--;)if(Zv(n[t][0],e))return t;return-1}function Xv(n,e){e=_v(e,n)?[e]:Gv(e);for(var t=0,i=e.length;n!=null&&t<i;)n=n[qv(e[t++])];return t&&t==i?n:void 0}function Qv(n){if(!fh(n)||Vv(n))return!1;var e=Kv(n)||Pv(n)?Ov:mv;return e.test(Jv(n))}function $v(n){if(typeof n=="string")return n;if(va(n))return El?El.call(n):"";var e=n+"";return e=="0"&&1/n==-lh?"-0":e}function Gv(n){return ph(n)?n:Yv(n)}function Rr(n,e){var t=n.__data__;return Uv(e)?t[typeof e=="string"?"string":"hash"]:t.map}function dh(n,e){var t=wv(n,e);return Qv(t)?t:void 0}function _v(n,e){if(ph(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||va(n)?!0:dv.test(n)||!uv.test(n)||e!=null&&n in Object(e)}function Uv(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function Vv(n){return!!xl&&xl in n}var Yv=fa(function(n){n=tg(n);var e=[];return pv.test(n)&&e.push(""),n.replace(fv,function(t,i,r,s){e.push(r?s.replace(gv,"$1"):i||t)}),e});function qv(n){if(typeof n=="string"||va(n))return n;var e=n+"";return e=="0"&&1/n==-lh?"-0":e}function Jv(n){if(n!=null){try{return hh.call(n)}catch{}try{return n+""}catch{}}return""}function fa(n,e){if(typeof n!="function"||e&&typeof e!="function")throw new TypeError(av);var t=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=t.cache;if(s.has(r))return s.get(r);var o=n.apply(this,i);return t.cache=s.set(r,o),o};return t.cache=new(fa.Cache||cn),t}fa.Cache=cn;function Zv(n,e){return n===e||n!==n&&e!==e}var ph=Array.isArray;function Kv(n){var e=fh(n)?uh.call(n):"";return e==lv||e==cv}function fh(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function eg(n){return!!n&&typeof n=="object"}function va(n){return typeof n=="symbol"||eg(n)&&uh.call(n)==hv}function tg(n){return n==null?"":$v(n)}function ng(n,e,t){var i=n==null?void 0:Xv(n,e);return i===void 0?t:i}var v1=ng,xr={},ig={get exports(){return xr},set exports(n){xr=n}};(function(n,e){var t=200,i="__lodash_hash_undefined__",r=9007199254740991,s="[object Arguments]",o="[object Array]",a="[object Boolean]",l="[object Date]",d="[object Error]",f="[object Function]",g="[object GeneratorFunction]",v="[object Map]",w="[object Number]",x="[object Object]",M="[object Promise]",k="[object RegExp]",D="[object Set]",B="[object String]",S="[object Symbol]",C="[object WeakMap]",W="[object ArrayBuffer]",T="[object DataView]",R="[object Float32Array]",N="[object Float64Array]",Q="[object Int8Array]",h="[object Int16Array]",u="[object Int32Array]",p="[object Uint8Array]",y="[object Uint8ClampedArray]",b="[object Uint16Array]",A="[object Uint32Array]",j=/[\\^$.*+?()[\]{}|]/g,E=/\w*$/,L=/^\[object .+?Constructor\]$/,F=/^(?:0|[1-9]\d*)$/,I={};I[s]=I[o]=I[W]=I[T]=I[a]=I[l]=I[R]=I[N]=I[Q]=I[h]=I[u]=I[v]=I[w]=I[x]=I[k]=I[D]=I[B]=I[S]=I[p]=I[y]=I[b]=I[A]=!0,I[d]=I[f]=I[C]=!1;var H=typeof Ue=="object"&&Ue&&Ue.Object===Object&&Ue,X=typeof self=="object"&&self&&self.Object===Object&&self,_=H||X||Function("return this")(),q=e&&!e.nodeType&&e,$=q&&!0&&n&&!n.nodeType&&n,ee=$&&$.exports===q;function le(c,m){return c.set(m[0],m[1]),c}function ce(c,m){return c.add(m),c}function De(c,m){for(var P=-1,z=c?c.length:0;++P<z&&m(c[P],P,c)!==!1;);return c}function Oe(c,m){for(var P=-1,z=m.length,U=c.length;++P<z;)c[U+P]=m[P];return c}function $e(c,m,P,z){var U=-1,G=c?c.length:0;for(z&&G&&(P=c[++U]);++U<G;)P=m(P,c[U],U,c);return P}function be(c,m){for(var P=-1,z=Array(c);++P<c;)z[P]=m(P);return z}function ye(c,m){return c==null?void 0:c[m]}function je(c){var m=!1;if(c!=null&&typeof c.toString!="function")try{m=!!(c+"")}catch{}return m}function qe(c){var m=-1,P=Array(c.size);return c.forEach(function(z,U){P[++m]=[U,z]}),P}function Je(c,m){return function(P){return c(m(P))}}function Ct(c){var m=-1,P=Array(c.size);return c.forEach(function(z){P[++m]=z}),P}var Hn=Array.prototype,Tn=Function.prototype,hn=Object.prototype,Bn=_["__core-js_shared__"],Di=function(){var c=/[^.]+$/.exec(Bn&&Bn.keys&&Bn.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),Si=Tn.toString,st=hn.hasOwnProperty,un=hn.toString,Nr=RegExp("^"+Si.call(st).replace(j,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xt=ee?_.Buffer:void 0,dn=_.Symbol,Rn=_.Uint8Array,Ge=Je(Object.getPrototypeOf,Object),ki=Object.create,zi=hn.propertyIsEnumerable,Wr=Hn.splice,Fn=Object.getOwnPropertySymbols,pn=Xt?Xt.isBuffer:void 0,Li=Je(Object.keys,Object),fn=Ke(_,"DataView"),Qt=Ke(_,"Map"),Ze=Ke(_,"Promise"),vn=Ke(_,"Set"),Nn=Ke(_,"WeakMap"),$t=Ke(Object,"create"),Wn=Se(fn),Gt=Se(Qt),Xn=Se(Ze),Qn=Se(vn),$n=Se(Nn),It=dn?dn.prototype:void 0,Hi=It?It.valueOf:void 0;function gt(c){var m=-1,P=c?c.length:0;for(this.clear();++m<P;){var z=c[m];this.set(z[0],z[1])}}function Xr(){this.__data__=$t?$t(null):{}}function Qr(c){return this.has(c)&&delete this.__data__[c]}function $r(c){var m=this.__data__;if($t){var P=m[c];return P===i?void 0:P}return st.call(m,c)?m[c]:void 0}function Ti(c){var m=this.__data__;return $t?m[c]!==void 0:st.call(m,c)}function Gn(c,m){var P=this.__data__;return P[c]=$t&&m===void 0?i:m,this}gt.prototype.clear=Xr,gt.prototype.delete=Qr,gt.prototype.get=$r,gt.prototype.has=Ti,gt.prototype.set=Gn;function we(c){var m=-1,P=c?c.length:0;for(this.clear();++m<P;){var z=c[m];this.set(z[0],z[1])}}function Gr(){this.__data__=[]}function _r(c){var m=this.__data__,P=mn(m,c);if(P<0)return!1;var z=m.length-1;return P==z?m.pop():Wr.call(m,P,1),!0}function Ur(c){var m=this.__data__,P=mn(m,c);return P<0?void 0:m[P][1]}function Vr(c){return mn(this.__data__,c)>-1}function Yr(c,m){var P=this.__data__,z=mn(P,c);return z<0?P.push([c,m]):P[z][1]=m,this}we.prototype.clear=Gr,we.prototype.delete=_r,we.prototype.get=Ur,we.prototype.has=Vr,we.prototype.set=Yr;function Ee(c){var m=-1,P=c?c.length:0;for(this.clear();++m<P;){var z=c[m];this.set(z[0],z[1])}}function qr(){this.__data__={hash:new gt,map:new(Qt||we),string:new gt}}function Jr(c){return Ut(this,c).delete(c)}function Zr(c){return Ut(this,c).get(c)}function Kr(c){return Ut(this,c).has(c)}function es(c,m){return Ut(this,c).set(c,m),this}Ee.prototype.clear=qr,Ee.prototype.delete=Jr,Ee.prototype.get=Zr,Ee.prototype.has=Kr,Ee.prototype.set=es;function Le(c){this.__data__=new we(c)}function ts(){this.__data__=new we}function ns(c){return this.__data__.delete(c)}function is(c){return this.__data__.get(c)}function rs(c){return this.__data__.has(c)}function ss(c,m){var P=this.__data__;if(P instanceof we){var z=P.__data__;if(!Qt||z.length<t-1)return z.push([c,m]),this;P=this.__data__=new Ee(z)}return P.set(c,m),this}Le.prototype.clear=ts,Le.prototype.delete=ns,Le.prototype.get=is,Le.prototype.has=rs,Le.prototype.set=ss;function gn(c,m){var P=Yn(c)||bn(c)?be(c.length,String):[],z=P.length,U=!!z;for(var G in c)(m||st.call(c,G))&&!(U&&(G=="length"||bs(G,z)))&&P.push(G);return P}function Bi(c,m,P){var z=c[m];(!(st.call(c,m)&&Xi(z,P))||P===void 0&&!(m in c))&&(c[m]=P)}function mn(c,m){for(var P=c.length;P--;)if(Xi(c[P][0],m))return P;return-1}function ot(c,m){return c&&Vn(m,Jn(m),c)}function _n(c,m,P,z,U,G,Y){var Z;if(z&&(Z=G?z(c,U,G,Y):z(c)),Z!==void 0)return Z;if(!lt(c))return c;var fe=Yn(c);if(fe){if(Z=ms(c),!m)return fs(c,Z)}else{var te=yt(c),Me=te==f||te==g;if(Qi(c))return yn(c,m);if(te==x||te==s||Me&&!G){if(je(c))return G?c:{};if(Z=at(Me?{}:c),!m)return vs(c,ot(Z,c))}else{if(!I[te])return G?c:{};Z=ys(c,te,_n,m)}}Y||(Y=new Le);var He=Y.get(c);if(He)return He;if(Y.set(c,Z),!fe)var ve=P?gs(c):Jn(c);return De(ve||c,function(Ce,Pe){ve&&(Pe=Ce,Ce=c[Pe]),Bi(Z,Pe,_n(Ce,m,P,z,Pe,c,Y))}),Z}function os(c){return lt(c)?ki(c):{}}function as(c,m,P){var z=m(c);return Yn(c)?z:Oe(z,P(c))}function ls(c){return un.call(c)}function cs(c){if(!lt(c)||Ps(c))return!1;var m=qn(c)||je(c)?Nr:L;return m.test(Se(c))}function hs(c){if(!Ni(c))return Li(c);var m=[];for(var P in Object(c))st.call(c,P)&&P!="constructor"&&m.push(P);return m}function yn(c,m){if(m)return c.slice();var P=new c.constructor(c.length);return c.copy(P),P}function Un(c){var m=new c.constructor(c.byteLength);return new Rn(m).set(new Rn(c)),m}function _t(c,m){var P=m?Un(c.buffer):c.buffer;return new c.constructor(P,c.byteOffset,c.byteLength)}function Ri(c,m,P){var z=m?P(qe(c),!0):qe(c);return $e(z,le,new c.constructor)}function Fi(c){var m=new c.constructor(c.source,E.exec(c));return m.lastIndex=c.lastIndex,m}function us(c,m,P){var z=m?P(Ct(c),!0):Ct(c);return $e(z,ce,new c.constructor)}function ds(c){return Hi?Object(Hi.call(c)):{}}function ps(c,m){var P=m?Un(c.buffer):c.buffer;return new c.constructor(P,c.byteOffset,c.length)}function fs(c,m){var P=-1,z=c.length;for(m||(m=Array(z));++P<z;)m[P]=c[P];return m}function Vn(c,m,P,z){P||(P={});for(var U=-1,G=m.length;++U<G;){var Y=m[U],Z=z?z(P[Y],c[Y],Y,P,c):void 0;Bi(P,Y,Z===void 0?c[Y]:Z)}return P}function vs(c,m){return Vn(c,mt(c),m)}function gs(c){return as(c,Jn,mt)}function Ut(c,m){var P=c.__data__;return ws(m)?P[typeof m=="string"?"string":"hash"]:P.map}function Ke(c,m){var P=ye(c,m);return cs(P)?P:void 0}var mt=Fn?Je(Fn,Object):xs,yt=ls;(fn&&yt(new fn(new ArrayBuffer(1)))!=T||Qt&&yt(new Qt)!=v||Ze&&yt(Ze.resolve())!=M||vn&&yt(new vn)!=D||Nn&&yt(new Nn)!=C)&&(yt=function(c){var m=un.call(c),P=m==x?c.constructor:void 0,z=P?Se(P):void 0;if(z)switch(z){case Wn:return T;case Gt:return v;case Xn:return M;case Qn:return D;case $n:return C}return m});function ms(c){var m=c.length,P=c.constructor(m);return m&&typeof c[0]=="string"&&st.call(c,"index")&&(P.index=c.index,P.input=c.input),P}function at(c){return typeof c.constructor=="function"&&!Ni(c)?os(Ge(c)):{}}function ys(c,m,P,z){var U=c.constructor;switch(m){case W:return Un(c);case a:case l:return new U(+c);case T:return _t(c,z);case R:case N:case Q:case h:case u:case p:case y:case b:case A:return ps(c,z);case v:return Ri(c,z,P);case w:case B:return new U(c);case k:return Fi(c);case D:return us(c,z,P);case S:return ds(c)}}function bs(c,m){return m=m??r,!!m&&(typeof c=="number"||F.test(c))&&c>-1&&c%1==0&&c<m}function ws(c){var m=typeof c;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?c!=="__proto__":c===null}function Ps(c){return!!Di&&Di in c}function Ni(c){var m=c&&c.constructor,P=typeof m=="function"&&m.prototype||hn;return c===P}function Se(c){if(c!=null){try{return Si.call(c)}catch{}try{return c+""}catch{}}return""}function Wi(c){return _n(c,!0,!0)}function Xi(c,m){return c===m||c!==c&&m!==m}function bn(c){return As(c)&&st.call(c,"callee")&&(!zi.call(c,"callee")||un.call(c)==s)}var Yn=Array.isArray;function wn(c){return c!=null&&$i(c.length)&&!qn(c)}function As(c){return Gi(c)&&wn(c)}var Qi=pn||Os;function qn(c){var m=lt(c)?un.call(c):"";return m==f||m==g}function $i(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=r}function lt(c){var m=typeof c;return!!c&&(m=="object"||m=="function")}function Gi(c){return!!c&&typeof c=="object"}function Jn(c){return wn(c)?gn(c):hs(c)}function xs(){return[]}function Os(){return!1}n.exports=Wi})(ig,xr);const g1=xr;var Or={},rg={get exports(){return Or},set exports(n){Or=n}};(function(n,e){var t=200,i="__lodash_hash_undefined__",r=1,s=2,o=9007199254740991,a="[object Arguments]",l="[object Array]",d="[object AsyncFunction]",f="[object Boolean]",g="[object Date]",v="[object Error]",w="[object Function]",x="[object GeneratorFunction]",M="[object Map]",k="[object Number]",D="[object Null]",B="[object Object]",S="[object Promise]",C="[object Proxy]",W="[object RegExp]",T="[object Set]",R="[object String]",N="[object Symbol]",Q="[object Undefined]",h="[object WeakMap]",u="[object ArrayBuffer]",p="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",A="[object Int8Array]",j="[object Int16Array]",E="[object Int32Array]",L="[object Uint8Array]",F="[object Uint8ClampedArray]",I="[object Uint16Array]",H="[object Uint32Array]",X=/[\\^$.*+?()[\]{}|]/g,_=/^\[object .+?Constructor\]$/,q=/^(?:0|[1-9]\d*)$/,$={};$[y]=$[b]=$[A]=$[j]=$[E]=$[L]=$[F]=$[I]=$[H]=!0,$[a]=$[l]=$[u]=$[f]=$[p]=$[g]=$[v]=$[w]=$[M]=$[k]=$[B]=$[W]=$[T]=$[R]=$[h]=!1;var ee=typeof Ue=="object"&&Ue&&Ue.Object===Object&&Ue,le=typeof self=="object"&&self&&self.Object===Object&&self,ce=ee||le||Function("return this")(),De=e&&!e.nodeType&&e,Oe=De&&!0&&n&&!n.nodeType&&n,$e=Oe&&Oe.exports===De,be=$e&&ee.process,ye=function(){try{return be&&be.binding&&be.binding("util")}catch{}}(),je=ye&&ye.isTypedArray;function qe(c,m){for(var P=-1,z=c==null?0:c.length,U=0,G=[];++P<z;){var Y=c[P];m(Y,P,c)&&(G[U++]=Y)}return G}function Je(c,m){for(var P=-1,z=m.length,U=c.length;++P<z;)c[U+P]=m[P];return c}function Ct(c,m){for(var P=-1,z=c==null?0:c.length;++P<z;)if(m(c[P],P,c))return!0;return!1}function Hn(c,m){for(var P=-1,z=Array(c);++P<c;)z[P]=m(P);return z}function Tn(c){return function(m){return c(m)}}function hn(c,m){return c.has(m)}function Bn(c,m){return c==null?void 0:c[m]}function Di(c){var m=-1,P=Array(c.size);return c.forEach(function(z,U){P[++m]=[U,z]}),P}function Si(c,m){return function(P){return c(m(P))}}function st(c){var m=-1,P=Array(c.size);return c.forEach(function(z){P[++m]=z}),P}var un=Array.prototype,Nr=Function.prototype,Xt=Object.prototype,dn=ce["__core-js_shared__"],Rn=Nr.toString,Ge=Xt.hasOwnProperty,ki=function(){var c=/[^.]+$/.exec(dn&&dn.keys&&dn.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),zi=Xt.toString,Wr=RegExp("^"+Rn.call(Ge).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fn=$e?ce.Buffer:void 0,pn=ce.Symbol,Li=ce.Uint8Array,fn=Xt.propertyIsEnumerable,Qt=un.splice,Ze=pn?pn.toStringTag:void 0,vn=Object.getOwnPropertySymbols,Nn=Fn?Fn.isBuffer:void 0,$t=Si(Object.keys,Object),Wn=mt(ce,"DataView"),Gt=mt(ce,"Map"),Xn=mt(ce,"Promise"),Qn=mt(ce,"Set"),$n=mt(ce,"WeakMap"),It=mt(Object,"create"),Hi=Se(Wn),gt=Se(Gt),Xr=Se(Xn),Qr=Se(Qn),$r=Se($n),Ti=pn?pn.prototype:void 0,Gn=Ti?Ti.valueOf:void 0;function we(c){var m=-1,P=c==null?0:c.length;for(this.clear();++m<P;){var z=c[m];this.set(z[0],z[1])}}function Gr(){this.__data__=It?It(null):{},this.size=0}function _r(c){var m=this.has(c)&&delete this.__data__[c];return this.size-=m?1:0,m}function Ur(c){var m=this.__data__;if(It){var P=m[c];return P===i?void 0:P}return Ge.call(m,c)?m[c]:void 0}function Vr(c){var m=this.__data__;return It?m[c]!==void 0:Ge.call(m,c)}function Yr(c,m){var P=this.__data__;return this.size+=this.has(c)?0:1,P[c]=It&&m===void 0?i:m,this}we.prototype.clear=Gr,we.prototype.delete=_r,we.prototype.get=Ur,we.prototype.has=Vr,we.prototype.set=Yr;function Ee(c){var m=-1,P=c==null?0:c.length;for(this.clear();++m<P;){var z=c[m];this.set(z[0],z[1])}}function qr(){this.__data__=[],this.size=0}function Jr(c){var m=this.__data__,P=yn(m,c);if(P<0)return!1;var z=m.length-1;return P==z?m.pop():Qt.call(m,P,1),--this.size,!0}function Zr(c){var m=this.__data__,P=yn(m,c);return P<0?void 0:m[P][1]}function Kr(c){return yn(this.__data__,c)>-1}function es(c,m){var P=this.__data__,z=yn(P,c);return z<0?(++this.size,P.push([c,m])):P[z][1]=m,this}Ee.prototype.clear=qr,Ee.prototype.delete=Jr,Ee.prototype.get=Zr,Ee.prototype.has=Kr,Ee.prototype.set=es;function Le(c){var m=-1,P=c==null?0:c.length;for(this.clear();++m<P;){var z=c[m];this.set(z[0],z[1])}}function ts(){this.size=0,this.__data__={hash:new we,map:new(Gt||Ee),string:new we}}function ns(c){var m=Ke(this,c).delete(c);return this.size-=m?1:0,m}function is(c){return Ke(this,c).get(c)}function rs(c){return Ke(this,c).has(c)}function ss(c,m){var P=Ke(this,c),z=P.size;return P.set(c,m),this.size+=P.size==z?0:1,this}Le.prototype.clear=ts,Le.prototype.delete=ns,Le.prototype.get=is,Le.prototype.has=rs,Le.prototype.set=ss;function gn(c){var m=-1,P=c==null?0:c.length;for(this.__data__=new Le;++m<P;)this.add(c[m])}function Bi(c){return this.__data__.set(c,i),this}function mn(c){return this.__data__.has(c)}gn.prototype.add=gn.prototype.push=Bi,gn.prototype.has=mn;function ot(c){var m=this.__data__=new Ee(c);this.size=m.size}function _n(){this.__data__=new Ee,this.size=0}function os(c){var m=this.__data__,P=m.delete(c);return this.size=m.size,P}function as(c){return this.__data__.get(c)}function ls(c){return this.__data__.has(c)}function cs(c,m){var P=this.__data__;if(P instanceof Ee){var z=P.__data__;if(!Gt||z.length<t-1)return z.push([c,m]),this.size=++P.size,this;P=this.__data__=new Le(z)}return P.set(c,m),this.size=P.size,this}ot.prototype.clear=_n,ot.prototype.delete=os,ot.prototype.get=as,ot.prototype.has=ls,ot.prototype.set=cs;function hs(c,m){var P=bn(c),z=!P&&Xi(c),U=!P&&!z&&wn(c),G=!P&&!z&&!U&&Gi(c),Y=P||z||U||G,Z=Y?Hn(c.length,String):[],fe=Z.length;for(var te in c)(m||Ge.call(c,te))&&!(Y&&(te=="length"||U&&(te=="offset"||te=="parent")||G&&(te=="buffer"||te=="byteLength"||te=="byteOffset")||ys(te,fe)))&&Z.push(te);return Z}function yn(c,m){for(var P=c.length;P--;)if(Wi(c[P][0],m))return P;return-1}function Un(c,m,P){var z=m(c);return bn(c)?z:Je(z,P(c))}function _t(c){return c==null?c===void 0?Q:D:Ze&&Ze in Object(c)?yt(c):Ni(c)}function Ri(c){return lt(c)&&_t(c)==a}function Fi(c,m,P,z,U){return c===m?!0:c==null||m==null||!lt(c)&&!lt(m)?c!==c&&m!==m:us(c,m,P,z,Fi,U)}function us(c,m,P,z,U,G){var Y=bn(c),Z=bn(m),fe=Y?l:at(c),te=Z?l:at(m);fe=fe==a?B:fe,te=te==a?B:te;var Me=fe==B,He=te==B,ve=fe==te;if(ve&&wn(c)){if(!wn(m))return!1;Y=!0,Me=!1}if(ve&&!Me)return G||(G=new ot),Y||Gi(c)?Vn(c,m,P,z,U,G):vs(c,m,fe,P,z,U,G);if(!(P&r)){var Ce=Me&&Ge.call(c,"__wrapped__"),Pe=He&&Ge.call(m,"__wrapped__");if(Ce||Pe){var Dt=Ce?c.value():c,bt=Pe?m.value():m;return G||(G=new ot),U(Dt,bt,P,z,G)}}return ve?(G||(G=new ot),gs(c,m,P,z,U,G)):!1}function ds(c){if(!$i(c)||ws(c))return!1;var m=Qi(c)?Wr:_;return m.test(Se(c))}function ps(c){return lt(c)&&qn(c.length)&&!!$[_t(c)]}function fs(c){if(!Ps(c))return $t(c);var m=[];for(var P in Object(c))Ge.call(c,P)&&P!="constructor"&&m.push(P);return m}function Vn(c,m,P,z,U,G){var Y=P&r,Z=c.length,fe=m.length;if(Z!=fe&&!(Y&&fe>Z))return!1;var te=G.get(c);if(te&&G.get(m))return te==m;var Me=-1,He=!0,ve=P&s?new gn:void 0;for(G.set(c,m),G.set(m,c);++Me<Z;){var Ce=c[Me],Pe=m[Me];if(z)var Dt=Y?z(Pe,Ce,Me,m,c,G):z(Ce,Pe,Me,c,m,G);if(Dt!==void 0){if(Dt)continue;He=!1;break}if(ve){if(!Ct(m,function(bt,Vt){if(!hn(ve,Vt)&&(Ce===bt||U(Ce,bt,P,z,G)))return ve.push(Vt)})){He=!1;break}}else if(!(Ce===Pe||U(Ce,Pe,P,z,G))){He=!1;break}}return G.delete(c),G.delete(m),He}function vs(c,m,P,z,U,G,Y){switch(P){case p:if(c.byteLength!=m.byteLength||c.byteOffset!=m.byteOffset)return!1;c=c.buffer,m=m.buffer;case u:return!(c.byteLength!=m.byteLength||!G(new Li(c),new Li(m)));case f:case g:case k:return Wi(+c,+m);case v:return c.name==m.name&&c.message==m.message;case W:case R:return c==m+"";case M:var Z=Di;case T:var fe=z&r;if(Z||(Z=st),c.size!=m.size&&!fe)return!1;var te=Y.get(c);if(te)return te==m;z|=s,Y.set(c,m);var Me=Vn(Z(c),Z(m),z,U,G,Y);return Y.delete(c),Me;case N:if(Gn)return Gn.call(c)==Gn.call(m)}return!1}function gs(c,m,P,z,U,G){var Y=P&r,Z=Ut(c),fe=Z.length,te=Ut(m),Me=te.length;if(fe!=Me&&!Y)return!1;for(var He=fe;He--;){var ve=Z[He];if(!(Y?ve in m:Ge.call(m,ve)))return!1}var Ce=G.get(c);if(Ce&&G.get(m))return Ce==m;var Pe=!0;G.set(c,m),G.set(m,c);for(var Dt=Y;++He<fe;){ve=Z[He];var bt=c[ve],Vt=m[ve];if(z)var Oa=Y?z(Vt,bt,ve,m,c,G):z(bt,Vt,ve,c,m,G);if(!(Oa===void 0?bt===Vt||U(bt,Vt,P,z,G):Oa)){Pe=!1;break}Dt||(Dt=ve=="constructor")}if(Pe&&!Dt){var _i=c.constructor,Ui=m.constructor;_i!=Ui&&"constructor"in c&&"constructor"in m&&!(typeof _i=="function"&&_i instanceof _i&&typeof Ui=="function"&&Ui instanceof Ui)&&(Pe=!1)}return G.delete(c),G.delete(m),Pe}function Ut(c){return Un(c,Jn,ms)}function Ke(c,m){var P=c.__data__;return bs(m)?P[typeof m=="string"?"string":"hash"]:P.map}function mt(c,m){var P=Bn(c,m);return ds(P)?P:void 0}function yt(c){var m=Ge.call(c,Ze),P=c[Ze];try{c[Ze]=void 0;var z=!0}catch{}var U=zi.call(c);return z&&(m?c[Ze]=P:delete c[Ze]),U}var ms=vn?function(c){return c==null?[]:(c=Object(c),qe(vn(c),function(m){return fn.call(c,m)}))}:xs,at=_t;(Wn&&at(new Wn(new ArrayBuffer(1)))!=p||Gt&&at(new Gt)!=M||Xn&&at(Xn.resolve())!=S||Qn&&at(new Qn)!=T||$n&&at(new $n)!=h)&&(at=function(c){var m=_t(c),P=m==B?c.constructor:void 0,z=P?Se(P):"";if(z)switch(z){case Hi:return p;case gt:return M;case Xr:return S;case Qr:return T;case $r:return h}return m});function ys(c,m){return m=m??o,!!m&&(typeof c=="number"||q.test(c))&&c>-1&&c%1==0&&c<m}function bs(c){var m=typeof c;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?c!=="__proto__":c===null}function ws(c){return!!ki&&ki in c}function Ps(c){var m=c&&c.constructor,P=typeof m=="function"&&m.prototype||Xt;return c===P}function Ni(c){return zi.call(c)}function Se(c){if(c!=null){try{return Rn.call(c)}catch{}try{return c+""}catch{}}return""}function Wi(c,m){return c===m||c!==c&&m!==m}var Xi=Ri(function(){return arguments}())?Ri:function(c){return lt(c)&&Ge.call(c,"callee")&&!fn.call(c,"callee")},bn=Array.isArray;function Yn(c){return c!=null&&qn(c.length)&&!Qi(c)}var wn=Nn||Os;function As(c,m){return Fi(c,m)}function Qi(c){if(!$i(c))return!1;var m=_t(c);return m==w||m==x||m==d||m==C}function qn(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=o}function $i(c){var m=typeof c;return c!=null&&(m=="object"||m=="function")}function lt(c){return c!=null&&typeof c=="object"}var Gi=je?Tn(je):ps;function Jn(c){return Yn(c)?hs(c):fs(c)}function xs(){return[]}function Os(){return!1}n.exports=As})(rg,Or);const m1=Or;var sg=Object.defineProperty,og=(n,e,t)=>e in n?sg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vh=(n,e,t)=>(og(n,typeof e!="symbol"?e+"":e,t),t);const li=class{constructor(){vh(this,"styleRefs",new Map)}generateStyleKey(e,t){const{duration:i,timing:r,loop:s,loopInterval:o=0}=e,a=e.elements[t],{properties:l}=a;return`svg-anim-${[i,r,s,o,JSON.stringify(l)].join("-").replace(/[^a-zA-Z0-9-]/g,"").toLowerCase()}`}interpolateMulti(e,t){var i;if(e.length===2)return this.interpolate(e[0],e[1],t);if(e.length<2)return(i=e[0])!=null?i:0;const r=e.length-1,s=t*r,o=Math.floor(s),a=s-o;return o>=r?e[r]:this.interpolate(e[o],e[o+1],a)}generateTransformMulti(e,t){const i=[];if(e.scale){const r=this.interpolateMulti(e.scale,t);i.push(`scale(${r})`)}if(e.translateX){const r=this.interpolateMulti(e.translateX,t);i.push(`translateX(${r}px)`)}if(e.translateY){const r=this.interpolateMulti(e.translateY,t);i.push(`translateY(${r}px)`)}if(e.rotate){const r=this.interpolateMulti(e.rotate,t);i.push(`rotate(${r}deg)`)}return i.join(" ")}interpolate(e,t,i){return e+(t-e)*i}static getInstance(){return li.instance||(li.instance=new li),li.instance}getOrCreateStyle(e,t){const i=this.generateStyleKey(e,t);if(this.styleRefs.has(i)){const C=this.styleRefs.get(i);return C.count++,i}const{duration:r,timing:s="linear",loop:o,loopInterval:a=0}=e,l=e.elements[t],{properties:d}=l,f=`${i}-keyframe`;let g=2;const v=[d.translateX,d.translateY,d.scale,d.rotate,d.opacity].filter(C=>Array.isArray(C)&&C.length>0);v.length>0&&(g=Math.max(...v.map(C=>C.length)));const w=o&&a>0?r+a:r,x=Math.max(0,Math.min(100,r/w*100));let M=`@keyframes ${f} {
`;for(let C=0;C<g;C++){const W=C/(g-1),T=W*x,R=this.generateTransformMulti(d,W);let N="";d.opacity&&(N=`    opacity: ${this.interpolateMulti(d.opacity,W)};`),M+=`  ${T}% {
${R?`    transform: ${R};
`:""}${N}
  }
`}const k=this.generateTransformMulti(d,1);let D="";d.opacity&&(D=`    opacity: ${this.interpolateMulti(d.opacity,1)};`),M+=`  100% {
${k?`    transform: ${k};
`:""}${D}
  }
`,M+=`}
`;const B=!!d.scale;M+=`.${i} {
  animation: ${f} ${w}ms ${s} ${o?"infinite":"1"};
${B?`  transform-origin: 50% 50%;
  transform-box: fill-box;`:""}
}`;const S=document.createElement("style");return S.id=i,S.textContent=M,document.head.appendChild(S),this.styleRefs.set(i,{element:S,count:1}),i}releaseStyle(e){const t=this.styleRefs.get(e);t&&(t.count--,t.count<=0&&(t.element.remove(),this.styleRefs.delete(e)))}};let ga=li;vh(ga,"instance");function b1(n,e){if(!n||!e)return;const t=ga.getInstance(),{elements:i}=e;i.forEach((r,s)=>{const{selector:o}=r;(o?n.querySelectorAll(o):[n]).forEach(a=>{const l=a,d=t.getOrCreateStyle(e,s);l.classList.add(d),l.setAttribute("data-style-key",d)})})}function w1(n){if(!n)return;const e=ga.getInstance(),t=n.querySelectorAll("*");[n,...Array.from(t)].forEach(i=>{const r=i,s=r.getAttribute("data-style-key");s&&(r.classList.remove(s),e.releaseStyle(s),r.removeAttribute("data-style-key")),r.style.animation="",r.style.transform="",r.style.opacity=""})}function Qe(n){return Array.isArray(n)?n.map(e=>[e.x,e.y,e.z]):[n.x,n.y,n.z]}function ma(n,e,t){if(t){const i=new O().subVectors(n.position,t).applyQuaternion(n.quaternion.clone().inverse()).applyQuaternion(e).add(t);n.position.copy(i)}n.quaternion.copy(e)}var ag=Object.defineProperty,lg=(n,e,t)=>e in n?ag(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Hs=(n,e,t)=>(lg(n,typeof e!="symbol"?e+"":e,t),t);let Mi=class extends Et{constructor(e,t){var i,r;super(),Hs(this,"originObject3D"),Hs(this,"onRender"),Hs(this,"positionFrom"),this.originObject3D=e,this.onRender=(i=t==null?void 0:t.onRender)!=null?i:()=>{},this.positionFrom=(r=t==null?void 0:t.positionFrom)!=null?r:"objectPosition"}get helperObject(){return this}render(){this.onRender()}enable(){this.parent.children.includes(this)||this.parent.add(this)}disable(){this.removeFromParent()}show(){this.visible=!0,this.render()}hide(){this.visible=!1,this.render()}raycasterIntersectObject(e,t=[]){return e.intersectObject(this,!0,t)}initialPosition(e){var t,i;this.positionFrom==="objectPosition"?this.position.copy(this.originObject3D.position):this.positionFrom==="boundingBox"?this.position.copy((t=ia(this.originObject3D))==null?void 0:t.getCenter(new O).applyMatrix4(this.originObject3D.matrixWorld)):this.positionFrom==="boundingSphere"?this.position.copy((i=Fd(this.originObject3D))==null?void 0:i.center.clone().applyMatrix4(this.originObject3D.matrixWorld)):this.positionFrom instanceof O?this.position.copy(this.positionFrom):this.positionFrom instanceof Function&&this.position.copy(this.positionFrom(this.originObject3D)),e&&this.position.add(e)}setScaleByCamera(e){}initQuaternion(e){if(this.quaternion.copy(this.originObject3D.quaternion),e&&(e.xAxis||e.yAxis||e.zAxis)){const t=e.xAxis instanceof Function?e.xAxis():e.xAxis,i=e.yAxis instanceof Function?e.yAxis():e.yAxis,r=e.zAxis instanceof Function?e.zAxis():e.zAxis;let s=t==null?void 0:t.clone(),o=i==null?void 0:i.clone(),a=r==null?void 0:r.clone();if(s&&!o&&!o){const l=new re().setFromUnitVectors(new O(1,0,0),s.normalize());this.applyQuaternion(l)}if(o&&!s&&!a){const l=new re().setFromUnitVectors(new O(0,1,0),o.normalize());this.applyQuaternion(l)}if(a&&!s&&!o){const l=new re().setFromUnitVectors(new O(0,0,1),a.normalize());this.applyQuaternion(l)}if([s,o,a].filter(xe).length>=2){s||(s=new O().crossVectors(o,a).normalize()),o||(o=new O().crossVectors(s,a).normalize()),a||(a=new O().crossVectors(s,o).normalize()),s.applyQuaternion(this.quaternion),o.applyQuaternion(this.quaternion),a.applyQuaternion(this.quaternion);const l=new K().makeBasis(s,o,a),d=new re().setFromRotationMatrix(l);this.quaternion.copy(d)}}}applyHelperScaleMatrix4(e,t){this.scale.applyMatrix4(e)}setHelperQuaternion(e,t){this.initQuaternion(),ma(this,this.quaternion.clone().premultiply(e),t)}applyHelperQuaternion(e,t){if(t){const i=new O().subVectors(this.position,t).applyQuaternion(e).add(t);this.position.copy(i)}this.applyQuaternion(e)}dispose(){this.removeFromParent()}},cg=class extends Mi{},hg=class extends Mi{},ug=class extends Mi{},dg=class extends Mi{},pg=class extends Mi{};var fg=Object.defineProperty,vg=(n,e,t)=>e in n?fg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,gh=(n,e,t)=>(vg(n,typeof e!="symbol"?e+"":e,t),t);let gg=class extends jt{constructor(e){super(),gh(this,"direction"),this.direction=e||"x"}},Mo=class extends ue{constructor(e,t,i){super(e,t),gh(this,"direction"),this.direction=i||"x"}};const rt={ROTATE_HELPER:9992,MOVE_HELPER:9993,SCALE_HELPER_LINE:9994,SCALE_HELPER_SPHERE:9995,MOVE_HELPER_ARROW:10001,MOVE_HELPER_CENTER:10002,DRAG_GUIDE_LINE:10003,DRAG_FACE_PATCH:10004};var mg=Object.defineProperty,yg=(n,e,t)=>e in n?mg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ni=(n,e,t)=>(yg(n,typeof e!="symbol"?e+"":e,t),t);let Ts=class extends gg{constructor(e){var t;super(e.direction),ni(this,"line"),ni(this,"arrow"),ni(this,"lineHeight",.4),ni(this,"arrowHeight",.1),ni(this,"name","ArrowGroup");const i=new ie((t=e.color)!=null?t:16214315),r=new Ie({color:i,transparent:!0,opacity:1,depthTest:!1,depthWrite:!1}),s=new ju(.04,.1,32),o=new Mo(s,r.clone(),e.direction);o.name=`arrow-${e.direction}`,o.renderOrder=rt.MOVE_HELPER_ARROW,this.arrow=o;const a=.004,l=new zc(a,a,.4,32),d=new Mo(l,r.clone(),e.direction);d.name=`line-${e.direction}`,d.renderOrder=rt.MOVE_HELPER_ARROW,this.line=d,this.formatArrow(),this.formatLine(),this.add(this.arrow,this.line)}formatArrow(){this.arrow.geometry.translate(0,this.lineHeight+this.arrowHeight/2,0),this.direction==="x"?(this.arrow.geometry.rotateX(Math.PI/2),this.arrow.geometry.rotateY(Math.PI/2)):this.direction==="z"&&this.arrow.geometry.rotateX(Math.PI/2)}formatLine(){this.line.geometry.translate(0,this.lineHeight/2,0),this.direction==="x"?(this.line.geometry.rotateX(Math.PI/2),this.line.geometry.rotateY(Math.PI/2)):this.direction==="z"&&this.line.geometry.rotateX(Math.PI/2)}};const Bs={X:16730698,Y:54927,Z:3368703};let In=class{static get X(){return new ie(Bs.X).convertSRGBToLinear().clone()}static get Y(){return new ie(Bs.Y).convertSRGBToLinear().clone()}static get Z(){return new ie(Bs.Z).convertSRGBToLinear().clone()}};function ya(n,e,t){const i=n.position.distanceTo(e),r=n.fov,s=n.distance||3,o=i/3,a=r/90,l=s/3,d=o*a*l,f=(t==null?void 0:t.min)||.6,g=t==null?void 0:t.max;return f&&d<f?f:g&&d>g?g:d}function bg(n,e,t){return n<e?e:n>t?t:n}function wg(n){let e=n.pose.latitude,t=n.pose.longitude;if(Ea(e)||Ea(t)){const i=n.matrix.elements;e=Math.asin(bg(i[9],-1,1)),Math.abs(i[9])<.9999999?t=Al(Math.atan2(i[8],i[10])):t=Al(Math.atan2(-i[2],i[0]))}return{latitude:e,longitude:t}}function Pg(n){const{latitude:e,longitude:t}=n,i=new O;return Ml-e<.03?i.set(0,1,0):Rs(0,t)?i.set(0,0,1):Rs(Math.PI,t)?i.set(0,0,-1):Rs(Ml,t)?i.set(1,0,0):i.set(-1,0,0),i}const Ml=Number((Math.PI/2).toFixed(5));function Rs(n,e){return typeof n!="number"||typeof e!="number"?!1:Math.abs(n-e)<.001}var Ag=Object.defineProperty,xg=(n,e,t)=>e in n?Ag(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ii=(n,e,t)=>(xg(n,typeof e!="symbol"?e+"":e,t),t);let Og=class extends cg{constructor(e,t){super(e,t),ii(this,"name","MoveHelper"),ii(this,"xArrow"),ii(this,"yArrow"),ii(this,"zArrow"),ii(this,"centerHandle"),t.xArrowEnable!==!1&&(this.xArrow=new Ts({direction:"x",color:In.X})),t.yArrowEnable!==!1&&(this.yArrow=new Ts({direction:"y",color:In.Y})),t.zArrowEnable!==!1&&(this.zArrow=new Ts({direction:"z",color:In.Z}));const i=new ie(16419862),r=.07,s=new Lc(r,r,r),o=new Ie({color:i,transparent:!0,opacity:1,depthTest:!1,depthWrite:!1,side:We}),a=new Mo(s,o,"plane");a.renderOrder=rt.MOVE_HELPER_CENTER,a.name="center-plane-handle",this.centerHandle=a,this.add(...[this.xArrow,this.yArrow,this.zArrow,this.centerHandle].filter(Boolean))}update(e){this.xArrow&&(this.xArrow.visible=!0),this.yArrow&&(this.yArrow.visible=!0),this.zArrow&&(this.zArrow.visible=!0);const t=this.helperObject.position.clone().sub(e.position).normalize(),i=new O(1,0,0).applyQuaternion(this.quaternion),r=new O(0,1,0).applyQuaternion(this.quaternion),s=new O(0,0,1).applyQuaternion(this.quaternion);if(e.type==="OrthographicCamera"){const o=wg(e),a=Pg(o),l=.0872665;Math.abs(i.angleTo(a)-0)<l||Math.abs(i.angleTo(a)-Math.PI)<l?this.xArrow&&(this.xArrow.visible=!1):Math.abs(r.angleTo(a)-0)<l||Math.abs(r.angleTo(a)-Math.PI)<l?this.yArrow&&(this.yArrow.visible=!1):(Math.abs(s.angleTo(a)-0)<l||Math.abs(s.angleTo(a)-Math.PI)<l)&&this.zArrow&&(this.zArrow.visible=!1)}if(e.type!=="OrthographicCamera"){const o=t.angleTo(i),a=t.angleTo(r),l=t.angleTo(s),d=Math.PI/2,f=a<d,g=l<d,v=o<d;this.xArrow&&(v?(this.xArrow.scale.x=-1,this.xArrow.scale.y=1,this.xArrow.scale.z=1):(this.xArrow.scale.x=1,this.xArrow.scale.y=1,this.xArrow.scale.z=1)),this.yArrow&&(f?(this.yArrow.scale.x=1,this.yArrow.scale.y=-1,this.yArrow.scale.z=1):(this.yArrow.scale.x=1,this.yArrow.scale.y=1,this.yArrow.scale.z=1)),this.zArrow&&(g?(this.zArrow.scale.x=1,this.zArrow.scale.y=1,this.zArrow.scale.z=-1):(this.zArrow.scale.x=1,this.zArrow.scale.y=1,this.zArrow.scale.z=1))}}show(){super.show(),this.xArrow&&this.add(this.xArrow),this.yArrow&&this.add(this.yArrow),this.zArrow&&this.add(this.zArrow),this.centerHandle&&this.add(this.centerHandle)}setScaleByCamera(e){this.scale.setScalar(ya(e,this.position))}showDraggingHelper(e){this.xArrow&&(e.includes("x")?this.add(this.xArrow):this.remove(this.xArrow)),this.yArrow&&(e.includes("y")?this.add(this.yArrow):this.remove(this.yArrow)),this.zArrow&&(e.includes("z")?this.add(this.zArrow):this.remove(this.zArrow)),this.centerHandle&&(e.includes("plane")?this.add(this.centerHandle):this.remove(this.centerHandle))}dispose(){this.remove(...[this.xArrow,this.yArrow,this.zArrow,this.centerHandle].filter(Boolean)),super.dispose()}};function nn(n,e){return jg(document.createElement(e??"div"),n)}function jg(n,e){if(!e)return n;for(const t in e)t&&e[t]&&(n.style[t]=e[t]);return n}var Eg=Object.defineProperty,Cl=Object.getOwnPropertySymbols,Mg=Object.prototype.hasOwnProperty,Cg=Object.prototype.propertyIsEnumerable,Il=(n,e,t)=>e in n?Eg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ig=(n,e)=>{for(var t in e||(e={}))Mg.call(e,t)&&Il(n,t,e[t]);if(Cl)for(var t of Cl(e))Cg.call(e,t)&&Il(n,t,e[t]);return n};function Dg(n){const e=nn(Ig({position:"absolute",display:"block",borderRadius:"4px",paddingTop:"1px",paddingBottom:"1px",paddingLeft:"4px",paddingRight:"4px",pointerEvents:"none",userSelect:"none",zIndex:"99999",backgroundColor:"rgba(0,0,0,0.7)",fontSize:"12px",color:"#fff",letterSpacing:"0",lineHeight:"18px"},n)),t=()=>{e.style.display!=="block"&&e.style.top&&e.style.left&&(e.style.display="block")};return{element:e,show:t,hide:()=>{e.style.display="none",e.style.top="",e.style.left=""},setLeftTop:(i,r)=>{e.style.left=i,e.style.top=r,t()}}}var Sg=Object.defineProperty,kg=(n,e,t)=>e in n?Sg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,me=(n,e,t)=>(kg(n,typeof e!="symbol"?e+"":e,t),t);let zg=class extends ug{constructor(e,t){super(e,t),me(this,"name","RotateHelper"),me(this,"xCircle"),me(this,"yCircle"),me(this,"zCircle"),me(this,"children",[]),me(this,"angleTips"),me(this,"container"),(t==null?void 0:t.yzCircleEnable)!==!1&&(this.xCircle=new Fs({direction:"x",color:In.X})),(t==null?void 0:t.xzCircleEnable)!==!1&&(this.yCircle=new Fs({direction:"y",color:In.Y})),(t==null?void 0:t.xyCircleEnable)!==!1&&(this.zCircle=new Fs({direction:"z",color:In.Z})),t!=null&&t.container&&(t==null?void 0:t.angleTipsEnable)!==!1&&(this.container=t==null?void 0:t.container,this.angleTips=Dg({display:"none"}),this.container.appendChild(this.angleTips.element)),this.add(...[this.xCircle,this.yCircle,this.zCircle].filter(Boolean)),this.show()}hide(){this.children.forEach(e=>e.hide())}show(){var e;this.children.forEach(t=>t.showCircle()),(e=this.angleTips)==null||e.hide()}setScaleByCamera(e){this.scale.setScalar(ya(e,this.position))}update(e){if(e.type==="OrthographicCamera")return;const t=this.helperObject.position.clone().sub(e.position).normalize(),i=new O(1,0,0).applyQuaternion(this.quaternion),r=new O(0,1,0).applyQuaternion(this.quaternion),s=new O(0,0,1).applyQuaternion(this.quaternion),o=t.angleTo(i),a=t.angleTo(r),l=t.angleTo(s),d=Math.PI/2,f=a>=d,g=l>=d,v=o>=d;if(this.xCircle){const w=this.xCircle.circle.gapAngle;f&&g?this.xCircle.circle.geometry=new ke(.25,.3,20,8,w,Math.PI/2-w*2):f&&!g?this.xCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI/2+w,Math.PI/2-w*2):!f&&g?this.xCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI/2*3+w,Math.PI/2-w*2):!f&&!g&&(this.xCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI+w,Math.PI/2-w*2)),this.xCircle.angleSector&&(this.xCircle.angleSector.offsetAngle=x=>x,f&&g?this.xCircle.angleSector.baseAxes=new O(0,0,1):f&&!g?this.xCircle.angleSector.baseAxes=new O(0,0,1):!f&&g?(this.xCircle.angleSector.baseAxes=new O(0,-1,0),this.xCircle.angleSector.offsetAngle=x=>x-Math.PI/2):!f&&!g&&(this.xCircle.angleSector.baseAxes=new O(0,0,-1),this.xCircle.angleSector.offsetAngle=x=>x-Math.PI))}if(this.yCircle){this.yCircle.angleSector.offsetAngle=x=>x;const w=this.yCircle.circle.gapAngle;v&&g?this.yCircle.circle.geometry=new ke(.25,.3,20,8,w,Math.PI/2-w*2):v&&!g?this.yCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI/2*3+w,Math.PI/2-w*2):!v&&g?this.yCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI/2+w,Math.PI/2-w*2):!v&&!g&&(this.yCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI+w,Math.PI/2-w*2)),v&&g?this.yCircle.angleSector.baseAxes=new O(1,0,0):v&&!g?(this.yCircle.angleSector.baseAxes=new O(0,0,-1),this.yCircle.angleSector.offsetAngle=x=>x-Math.PI/2):!v&&g?(this.yCircle.angleSector.baseAxes=new O(0,0,1),this.yCircle.angleSector.offsetAngle=x=>x+Math.PI/2):!v&&!g&&(this.yCircle.angleSector.baseAxes=new O(-1,0,0),this.yCircle.angleSector.offsetAngle=x=>x+Math.PI)}if(this.zCircle){this.zCircle.angleSector.offsetAngle=x=>x;const w=this.zCircle.circle.gapAngle;v&&f?this.zCircle.circle.geometry=new ke(.25,.3,20,8,w,Math.PI/2-w*2):v&&!f?this.zCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI/2*3+w,Math.PI/2-w*2):!v&&f?this.zCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI/2+w,Math.PI/2-w*2):!v&&!f&&(this.zCircle.circle.geometry=new ke(.25,.3,20,8,Math.PI+w,Math.PI/2-w*2)),this.zCircle.angleSector&&(v&&f?this.zCircle.angleSector.baseAxes=new O(1,0,0):v&&!f?(this.zCircle.angleSector.baseAxes=new O(0,-1,0),this.zCircle.angleSector.offsetAngle=x=>x-Math.PI/2):!v&&f?(this.zCircle.angleSector.baseAxes=new O(0,1,0),this.zCircle.angleSector.offsetAngle=x=>x+Math.PI/2):!v&&!f&&(this.zCircle.angleSector.baseAxes=new O(-1,0,0),this.zCircle.angleSector.offsetAngle=x=>x+Math.PI))}}showDraggingHelper(e){var t;this.hide(),this.children.filter(i=>e.includes(i.direction)).forEach(i=>i.showRing()),(t=this.angleTips)==null||t.show()}dispose(){var e,t;this.removeFromParent(),(t=(e=this.angleTips)==null?void 0:e.element)==null||t.remove()}},Fs=class extends jt{constructor(e){super(),me(this,"direction"),me(this,"circle"),me(this,"ring"),me(this,"angleSector"),this.direction=e.direction,this.circle=new Lg(e),this.ring=new Hg(e),this.angleSector=new Tg(e),this.add(this.circle,this.ring,this.angleSector),this.direction==="y"?this.rotation.x=Math.PI/2:this.direction==="x"&&(this.rotation.y=-Math.PI/2)}showCircle(){this.add(this.circle),this.remove(this.ring,this.angleSector)}showRing(){this.add(this.ring,this.angleSector),this.remove(this.circle)}hide(){this.remove(this.ring,this.angleSector,this.circle)}},Lg=class extends ue{constructor(e){var t;super(),me(this,"direction"),me(this,"gapAngle",.02),me(this,"geometry",new ke(.25,.3,20,8,this.gapAngle,Math.PI/2-this.gapAngle*2)),this.material=new Ie({opacity:.6,transparent:!0,color:(t=e.color)!=null?t:16777215,side:We,depthTest:!1}),this.direction=e.direction,this.renderOrder=rt.ROTATE_HELPER,this.geometry.name=`RotateHelperCircleGeometry-${this.direction}`}},Hg=class extends jt{constructor(e){super(),me(this,"direction"),this.direction=e.direction;const t=.015,i=new Array(8).fill(null).map((r,s)=>{const o=new ke(.25,.3,20,8,Math.PI/4*s+t,Math.PI/4-t*2),a=new Ie({opacity:1,color:16777215,depthTest:!1,depthWrite:!1,transparent:!0,side:We}),l=new ue(o,a);return l.name=`AxesDashedRing-${this.direction}-${s}`,l});this.add(...i)}},Tg=class extends ue{constructor(e){var t;switch(super(),me(this,"direction"),me(this,"baseAxes"),me(this,"offsetAngle",r=>r),me(this,"angleDirection"),e.direction){case"x":this.baseAxes=new O(0,0,1);break;case"y":this.baseAxes=new O(1,0,0);break;case"z":this.baseAxes=new O(1,0,0);break}const i=.3+5e-4;this.geometry=new en(i,48,0,1e-4),this.material=new Ie({opacity:.4,color:(t=e.color)!=null?t:16777215,depthTest:!1,depthWrite:!1,transparent:!0,side:We}),this.direction=e.direction,this.angleDirection=this.direction==="z"?1:-1}setClockwiseDirection(){this.angleDirection=-1}setCounterClockwiseDirection(){this.angleDirection=1}toggleDirection(){this.angleDirection=this.angleDirection===1?-1:1}setBaseAxes(e){this.baseAxes=e.clone().normalize()}getDirection(){return this.angleDirection===-1?"clockwise":"counterclockwise"}};var Bg=Object.defineProperty,Dl=Object.getOwnPropertySymbols,Rg=Object.prototype.hasOwnProperty,Fg=Object.prototype.propertyIsEnumerable,Sl=(n,e,t)=>e in n?Bg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ng=(n,e)=>{for(var t in e||(e={}))Rg.call(e,t)&&Sl(n,t,e[t]);if(Dl)for(var t of Dl(e))Fg.call(e,t)&&Sl(n,t,e[t]);return n};function Wg(){const n=nn({width:"100%",height:"100%",left:"0",top:"0",position:"absolute",pointerEvents:"none"}),e=nn({boxSizing:"border-box",width:"100%",height:"100%",left:"0",top:"0",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"}),t=nn({boxSizing:"border-box",width:"100%",height:"100%",left:"0",top:"0",position:"absolute",border:"1px solid rgba(255,255,255,0.4)"});n.appendChild(e),e.appendChild(t);const i="-4px",r={direction:"nesw",element:kt({cursor:"nesw-resize",left:i,bottom:i})},s={direction:"ns",element:kt({cursor:"ns-resize",bottom:i})},o={direction:"nwse",element:kt({cursor:"nwse-resize",right:i,bottom:i})},a={direction:"ew",element:kt({cursor:"ew-resize",right:i})},l={direction:"nesw",element:kt({cursor:"nesw-resize",right:i,top:i})},d={direction:"ns",element:kt({cursor:"ns-resize",top:i})},f={direction:"nwse",element:kt({cursor:"nwse-resize",left:i,top:i})},g={direction:"ew",element:kt({cursor:"ew-resize",left:i})};return new Array(s,a,d,g,r,o,l,f).forEach(v=>e.appendChild(v.element)),{container:n,spheres:[r,s,o,a,l,d,f,g]}}function kt(n){const e=nn(Ng({background:"#FFFFFF",width:"9px",height:"9px",position:"absolute",pointerEvents:"none"},n)),t=nn({width:"15px",height:"15px",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"}),i=nn({width:"15px",height:"15px",cursor:n==null?void 0:n.cursor,pointerEvents:"auto",background:"transparent"});return i.draggable=!0,t.appendChild(i),e.appendChild(t),e}const tr=new Map;function mh(n){if(tr.has(n))return tr.get(n).hooks;const e=new it;let t=null,i;const r=()=>{t=requestAnimationFrame(r);const o=n.projectionMatrix.toArray().join(",")+n.matrixWorld.toArray().join(",");o!==i&&(i=o,e.emit("cameraUpdate"))};r();const s=()=>{tr.delete(n),cancelAnimationFrame(t)};return tr.set(n,{hooks:e,dispose:s}),e}var Xg=Object.defineProperty,Qg=(n,e,t)=>e in n?Xg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ut=(n,e,t)=>(Qg(n,typeof e!="symbol"?e+"":e,t),t);let $g=class extends pg{constructor(e,t,i,r){super(e),ut(this,"name","CSS3DScaleHelper"),ut(this,"points",[]),ut(this,"cornerPositions",[]),ut(this,"css3DInstance"),ut(this,"plane"),ut(this,"css3DRenderer",new Mc),ut(this,"camera"),ut(this,"scene"),ut(this,"container"),ut(this,"enabled",!1),this.camera=i,this.scene=r,this.container=t,this.initRectangleScaleHelper()}get helperObject(){var e;if(!((e=this.css3DInstance)!=null&&e.css3DObject))throw new Error("css3DInstance is not initialized");return this.css3DInstance.css3DObject}initQuaternion(){this.quaternion.copy(this.originObject3D.quaternion)}applyMatrix4(e){var t;super.applyMatrix4(e),this.helperObject.applyMatrix4(e),(t=this.plane)==null||t.applyMatrix4(e),this.cornerPositions.forEach(i=>i.applyMatrix4(e))}showDraggingHelper(){}applyHelperScaleMatrix4(e,t){var i;(i=this.plane)==null||i.scale.applyMatrix4(e),this.helperObject.applyScaleMatrix4(e)}updatePoints(){const e=this.calculatePointPosition(this.cornerPositions);this.points.forEach((t,i)=>{t.position.copy(e[i])})}update(e){var t;(t=this.css3DInstance)!=null&&t.css3DObject&&this.helperObject.position.copy(this.originObject3D.position),this.plane&&this.plane.position.copy(this.originObject3D.position),this.updatePoints(),this.css3DInstance&&this.css3DInstance.show(),this.plane&&(this.plane.visible=!0)}applyHelperQuaternion(e,t){var i;const r=(i=this.css3DInstance)==null?void 0:i.css3DObject;if(r){const s=new O().subVectors(r.position,t).applyQuaternion(e).add(t);r.position.copy(s),r.applyQuaternion(e)}if(this.plane){const s=new O().subVectors(this.plane.position,t).applyQuaternion(e).add(t);this.plane.position.copy(s),this.plane.applyQuaternion(e)}this.cornerPositions.forEach(s=>{const o=new O().subVectors(s,t).applyQuaternion(e).add(t);s.copy(o)})}enable(){var e;this.enabled||(this.enabled=!0,(e=this.css3DInstance)==null||e.enable(),this.plane&&this.scene.add(this.plane))}disable(){var e;this.enabled&&(this.enabled=!1,(e=this.css3DInstance)==null||e.disable(),this.plane&&this.scene.remove(this.plane))}show(){var e;(e=this.css3DInstance)==null||e.show(),this.plane&&(this.plane.visible=!0)}hide(){var e;(e=this.css3DInstance)==null||e.hide(),this.plane&&(this.plane.visible=!1)}dispose(){this.disable(),this.css3DRenderer.dispose()}onScaleEnd(){mh(this.camera).emit("cameraUpdate")}initRectangleScaleHelper(){var e,t;const i=this.getCornerPositions();if(!i)return;this.cornerPositions=i;const r=this.css3DRenderer.create3DElement(this.camera,i,{ratio:.003});if(!r)return;this.css3DInstance=r,r.appendToElement(this.container);const s=r.css3DObject.container,{container:o,spheres:a}=Wg();this.points=a.map((l,d)=>({direction:l.direction,point:l.element,position:this.calculatePointPosition(i)[d]})),s.insertBefore(o,(e=s.children[0])!=null?e:null),this.helperObject.position.copy(this.originObject3D.position),(t=this.plane)==null||t.position.copy(this.originObject3D.position)}getCornerPositions(){const{originObject3D:e}=this;if(e.isCSS3DObject&&e.cornerPoints)return e.cornerPoints;console.error("当前物体暂时不支持 ScaleHelper")}calculatePointPosition(e){return[e[0].clone(),e[0].clone().add(e[1]).divideScalar(2),e[1].clone(),e[1].clone().add(e[2]).divideScalar(2),e[2].clone(),e[2].clone().add(e[3]).divideScalar(2),e[3].clone(),e[3].clone().add(e[0]).divideScalar(2)]}};var Gg=Object.defineProperty,_g=(n,e,t)=>e in n?Gg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,nr=(n,e,t)=>(_g(n,typeof e!="symbol"?e+"":e,t),t);let Ug=class extends hg{constructor(e){super(e),nr(this,"name","BoundingBoxHelper"),nr(this,"box"),nr(this,"outline"),nr(this,"positionAttribute"),this.positionAttribute=new Ve(new Float32Array(8*3),3),this.box=this.createBox(),this.outline=this.createOutline(),this.add(this.box,this.outline),this.update()}initQuaternion(){this.quaternion.copy(this.originObject3D.quaternion)}setHelperQuaternion(e,t){ma(this,e,t)}raycasterIntersectObject(e,t){return e.intersectObject(this,!1,t)}raycast(e,t){this.box.raycast(e,t)}update(){const e=ia(this.originObject3D);if(!e)return;const{min:t,max:i}=e;this.positionAttribute.setXYZ(0,i.x,i.y,i.z),this.positionAttribute.setXYZ(1,t.x,i.y,i.z),this.positionAttribute.setXYZ(2,t.x,t.y,i.z),this.positionAttribute.setXYZ(3,i.x,t.y,i.z),this.positionAttribute.setXYZ(4,i.x,i.y,t.z),this.positionAttribute.setXYZ(5,t.x,i.y,t.z),this.positionAttribute.setXYZ(6,t.x,t.y,t.z),this.positionAttribute.setXYZ(7,i.x,t.y,t.z),this.positionAttribute.needsUpdate=!0}createOutline(){const e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),t=new ze;t.setIndex(new Ve(e,1)),t.setAttribute("position",this.positionAttribute);const i=new Sr({color:64767,linewidth:1,opacity:1,toneMapped:!1}),r=new Eu(t,i);return r.matrixAutoUpdate=!1,r}createBox(){const e=new Uint16Array([0,1,2,0,2,3,0,3,7,0,7,4,0,4,5,0,5,1,6,1,5,6,2,1,6,5,4,6,4,7,6,3,2,6,7,3]),t=new ze;t.setIndex(new Ve(e,1)),t.setAttribute("position",this.positionAttribute);const i=new Ie({color:64767,opacity:.1,depthTest:!1,transparent:!0});return new ue(t,i)}};var Vg=Object.defineProperty,Yg=(n,e,t)=>e in n?Vg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,de=(n,e,t)=>(Yg(n,typeof e!="symbol"?e+"":e,t),t);let Ci=class{constructor(e,t){de(this,"originObject3D"),de(this,"hooks"),de(this,"preventTapDefaultEvent",!1),de(this,"internalHooks"),de(this,"disposers",[]),de(this,"helperObject3D"),de(this,"camera"),de(this,"model"),de(this,"scene"),de(this,"container"),de(this,"domEvents"),de(this,"isDragging",!1),de(this,"enabled",!1),de(this,"name","BaseController"),de(this,"boundingBox"),de(this,"config"),de(this,"onRender"),de(this,"cameraHooks"),de(this,"onWantsTapGesture",w=>{if(this.getIntersectObject(w))return!1}),de(this,"updateHelperScale",()=>{"update"in this.helperObject3D&&typeof this.helperObject3D.update=="function"&&this.helperObject3D.update(this.camera),this.helperObject3D.setScaleByCamera(this.camera)}),de(this,"getBox",()=>this.boundingBox?this.boundingBox:(this.boundingBox=ia(this.originObject3D),this.boundingBox));var i,r,s;this.hooks=(i=e.sharedHooks)!=null?i:new it,this.internalHooks=(r=e.sharedInternalHooks)!=null?r:new it,this.camera=e.camera,this.model=e.model,this.originObject3D=e.originObject3D,this.helperObject3D=e.helperObject3D,this.container=e.container,this.scene=e.scene,this.domEvents=e.domEvents,this.onRender=(s=e.onRender)!=null?s:()=>{},this.config=t??{},this.initialHelperPosition(),this.initialHelperQuaternion(),this.updateHelperScale(),this.cameraHooks=mh(this.camera),this.enable();const o=this.onSetOriginObjectScale.bind(this),a=this.onSetOriginObjectRotate.bind(this),l=this.onSetOriginObjectPosition.bind(this),d=this.onApplyOriginObjectScale.bind(this),f=this.onApplyOriginObjectRotate.bind(this),g=this.onApplyOriginObjectPosition.bind(this),v=this.initialHelperPosition.bind(this);this.cameraHooks.on("cameraUpdate",this.updateHelperScale),this.internalHooks.on("initialHelperPosition",v),this.internalHooks.on("setObjectScale",o),this.internalHooks.on("setObjectRotate",a),this.internalHooks.on("setObjectPosition",l),this.internalHooks.on("applyObjectPosition",g),this.internalHooks.on("applyObjectRotate",f),this.internalHooks.on("applyObjectScale",d),this.hooks.on("moveEnd",this.updateHelperScale),this.internalHooks.on("setObjectPosition",this.updateHelperScale),this.internalHooks.on("initialHelperPosition",this.updateHelperScale),this.disposers.push(()=>{this.cameraHooks.off("cameraUpdate",this.updateHelperScale),this.internalHooks.off("initialHelperPosition",v),this.internalHooks.off("setObjectScale",o),this.internalHooks.off("setObjectRotate",a),this.internalHooks.off("setObjectPosition",l),this.internalHooks.off("applyObjectPosition",g),this.internalHooks.off("applyObjectRotate",f),this.internalHooks.off("applyObjectScale",d),this.hooks.off("moveEnd",this.updateHelperScale),this.internalHooks.off("setObjectPosition",this.updateHelperScale),this.internalHooks.off("initialHelperPosition",this.updateHelperScale)})}initialHelperPosition(){this.helperObject3D.initialPosition(this.calculateOffset(this.config.offset))}initialHelperQuaternion(){this.helperObject3D.initQuaternion(this.config)}enable(){this.enabled||(this.enabled=!0,this.scene.add(this.helperObject3D),this.helperObject3D.enable(),this.render())}disable(){this.enabled&&(this.enabled=!1,this.helperObject3D.disable(),this.render())}show(){this.helperObject3D.show(),this.render()}hide(){this.helperObject3D.hide(),this.render()}dispose(){var e;(e=this.disposers)==null||e.forEach(t=>t==null?void 0:t()),this.helperObject3D.dispose(),this.render()}applyHelperMatrix4(e){this.helperObject3D.applyMatrix4(e)}applyHelperQuaternion(e,t){this.helperObject3D.applyHelperQuaternion(e,t)}applyHelperScaleMatrix4(e,t){this.helperObject3D.applyHelperScaleMatrix4(e,t)}onWantsGesture(e,t,i){if(this.isDragging)return!1}onIntersectionOnModelUpdate(e){}onApplyOriginObjectScale(e){this.applyHelperScaleMatrix4(e.matrix,e.origin)}onApplyOriginObjectRotate(e){this.applyHelperQuaternion(e.quaternion,e.origin)}onApplyOriginObjectPosition(e){this.applyHelperMatrix4(e.matrix)}onSetOriginObjectScale(e){this.helperObject3D.scale.copy(e),this.updateOffsetByScale(e)}onSetOriginObjectRotate(e,t){this.helperObject3D.setHelperQuaternion(e,t)}onSetOriginObjectPosition(e){this.helperObject3D.position.copy(e.clone().add(this.calculateOffset(this.config.offset)))}render(){this.onRender()}updateOffsetByScale(e){if(this.boundingBox&&this.config.offset){const t=this.originObject3D.position,i=new O().subVectors(this.boundingBox.max,t).multiply(e).add(t),r=new O().subVectors(this.boundingBox.min,t).multiply(e).add(t),s=this.calculateOffset(this.config.offset,{min:r,max:i});this.helperObject3D.initialPosition(s)}}hoverListener(e,t=16777215,i=1){const r=qh(e).filter(xe),s=[];for(const o of r)if(o.material||o instanceof jt){const a=o instanceof jt?o.children.filter(v=>v instanceof ue):[o];a.forEach(v=>{var w,x;v.__originalColor__=(w=v.__originalColor__)!=null?w:v.material.color.clone(),v.__originalOpacity__=(x=v.__originalOpacity__)!=null?x:v.material.opacity});const l=()=>{a.forEach(v=>{v.name==="ScaleHelperTransparentGroup"?v.children[0]&&(v.children[0].material.color.set(t),v.children[0].material.opacity=i):(v.material.color.set(t),v.material.opacity=i)}),this.render()},d=()=>{a.forEach(v=>{v.name==="ScaleHelperTransparentGroup"?v.children[0]&&(v.children[0].material.color.set(16776960),v.children[0].material.opacity=1):(v.material.color.copy(v.__originalColor__),v.material.opacity=v.__originalOpacity__)}),this.render()},f=v=>{this.isDragging||l()},g=v=>{this.isDragging||d()};for(const v of a)this.domEvents.addEventListener(v,"mouseover",f),this.domEvents.addEventListener(v,"mouseout",g),this.hooks.on("moveStart",l),this.hooks.on("moveEnd",d),this.hooks.on("rotateEnd",d),this.hooks.on("scaleEnd",d),s.push(()=>{this.domEvents.removeEventListener(v,"mouseover",f),this.domEvents.removeEventListener(v,"mouseout",g),this.hooks.off("moveStart",l),this.hooks.off("moveEnd",d),this.hooks.off("rotateEnd",d),this.hooks.off("scaleEnd",d)})}return()=>s.forEach(o=>o==null?void 0:o())}getIntersectObject(e){const t=this.camera.position,i=this.helperObject3D;if(!i)return;const r=this.helperObject3D.raycasterIntersectObject(e)[0];if(!r)return;const s=r;if(s.object=i,this.model.intersectRaycaster){const o=this.model.intersectRaycaster(e)[0];if(o&&o.point.distanceTo(t)<s.point.distanceTo(t))return}return s.object}calculateOffset(e,t){const i=new O(0,0,0);if(!e)return i;const r=()=>t||this.getBox();if(typeof e.x=="number")i.setX(e.x);else if(typeof e.x=="object"){const s=r();i.setX((s.max.x-s.min.x)*e.x.percents)}if(typeof e.y=="number")i.setY(e.y);else if(typeof e.y=="object"){const s=r();i.setY((s.max.y-s.min.y)*e.y.percents)}if(typeof e.z=="number")i.setZ(e.z);else if(typeof e.z=="object"){const s=r();i.setZ((s.max.z-s.min.z)*e.z.percents)}return i}};var qg=Object.defineProperty,kl=Object.getOwnPropertySymbols,Jg=Object.prototype.hasOwnProperty,Zg=Object.prototype.propertyIsEnumerable,Co=(n,e,t)=>e in n?qg(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ri=(n,e)=>{for(var t in e||(e={}))Jg.call(e,t)&&Co(n,t,e[t]);if(kl)for(var t of kl(e))Zg.call(e,t)&&Co(n,t,e[t]);return n},Ns=(n,e,t)=>(Co(n,typeof e!="symbol"?e+"":e,t),t);function Kg(n,e){let t=10,i=10;const r=n.isPerspectiveCamera,s=n.isOrthographicCamera;if(r){const f=n,g=f.position.distanceTo(e),v=f.fov*Math.PI/180;i=2*Math.tan(v/2)*g,t=i*f.aspect}else if(s){const f=n;t=Math.abs(f.right-f.left),i=Math.abs(f.top-f.bottom)}const o=Math.sqrt(t*t+i*i),a=o*.8,l=Math.min(t,i)*.25,d=o*1.2;return Math.max(l,Math.min(a,d))}let yh=class{constructor(e,t,i){Ns(this,"camera"),Ns(this,"container"),Ns(this,"defaults"),this.camera=e,this.container=t,this.defaults=ri({},i||{})}createSolidLine(e,t,i){const r=ri(ri({color:16777215,renderOrder:rt.DRAG_GUIDE_LINE},this.defaults),i||{}),s=t.clone().normalize(),o=this.computeInfiniteLineLength(e),a=e.clone().add(s.clone().multiplyScalar(-o)),l=e.clone().add(s.clone().multiplyScalar(o)),d=new Float32Array([a.x,a.y,a.z,l.x,l.y,l.z]),f=new ze;f.setAttribute("position",new Ve(d,3));const g=new Sr({color:r.color,depthTest:!1,depthWrite:!1,transparent:!0,opacity:.65}),v=new na(f,g);return v.renderOrder=r.renderOrder,v}updateSolidLine(e,t,i,r){const s=i.clone().normalize(),o=this.computeInfiniteLineLength(t),a=t.clone().add(s.clone().multiplyScalar(-o)),l=t.clone().add(s.clone().multiplyScalar(o)),d=new Float32Array([a.x,a.y,a.z,l.x,l.y,l.z]),f=e.geometry,g=f.getAttribute("position");g&&g.itemSize===3&&g.array.length===d.length?(g.array.set(d),g.needsUpdate=!0):f.setAttribute("position",new Ve(d,3)),(r==null?void 0:r.color)!==void 0&&e.material.color.setHex(r.color)}computeInfiniteLineLength(e){return Kg(this.camera,e)*10}dispose(e){if(!e)return;e.geometry.dispose();const t=e.material;Array.isArray(t)?t.forEach(i=>i.dispose()):t.dispose()}updateDefaults(e){this.defaults=ri(ri({},this.defaults),e)}};function em(n,e){const{offsetWidth:t,offsetHeight:i}=e,{top:r,left:s}=e.getBoundingClientRect();return Object.assign(new Nt,{x:(n.x-s)/t*2-1,y:-(n.y-r)/i*2+1})}function Fr(n,e,t){if(!e||!t||!n)return;const i=em(e,t);if(Math.abs(i.x)===1||Math.abs(i.y)===1)return;const r=new Oi;return r.setFromCamera(i,n),r.params.Points.threshold=.1,r}var tm=Object.defineProperty,nm=(n,e,t)=>e in n?tm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dt=(n,e,t)=>(nm(n,typeof e!="symbol"?e+"":e,t),t),zl,Ll;let im=class extends Ci{constructor(...e){super(...e),dt(this,"name","MoveController"),dt(this,"startInfo"),dt(this,"dragGuideLine"),dt(this,"solidGuide",new yh(this.camera,this.container,(Ll=(zl=this.config)==null?void 0:zl.solidGuide)!=null?Ll:{})),dt(this,"_moveByMouse",{enabled:!1}),dt(this,"mouseInfo"),dt(this,"mousedownEventListenerDisposer"),dt(this,"dragStart",o=>{if(this.moveByMouseEnable||this.isDragging)return;const a=o==null?void 0:o.intersect;if(!a)return this.dragEnd();const l=(a==null?void 0:a.object).direction;if(!l)return this.dragEnd();const d=new O(1,0,0).applyQuaternion(this.helperObject3D.quaternion),f=new O(0,1,0).applyQuaternion(this.helperObject3D.quaternion),g=new O(0,0,1).applyQuaternion(this.helperObject3D.quaternion),v=(()=>{switch(l){case"x":return d;case"y":return f;case"z":return g;case"plane":return}})(),w=a.point.clone();if(l==="plane"){const x=this.camera.position.clone(),M=w.clone(),k=M.clone().sub(x).normalize(),D=new Xe().setFromNormalAndCoplanarPoint(k,M),B=M.clone();this.startInfo={draggingDirection:l,startVectorProject:B,line:new Ye(B.clone(),B.clone()),plane:D}}else{const x=new Ye(w.clone().sub(v.normalize()),w.clone().add(v.normalize()));this.startInfo={draggingDirection:l,startVectorProject:w,line:x};try{const M=v.clone().normalize(),k=this.helperObject3D.getWorldPosition(new O),D=this.solidGuide.createSolidLine(k,M,{color:16777215,renderOrder:rt.DRAG_GUIDE_LINE});this.scene.add(D),this.dragGuideLine=D}catch{}}this.helperObject3D.showDraggingHelper([l]),this.hooks.emit("moveStart"),this.isDragging=!0}),dt(this,"dragging",o=>{if(!this.isDragging||!this.startInfo)return;const a="touches"in o?o.touches[0].clientX:o.x,l="touches"in o?o.touches[0].clientY:o.y,d=Fr(this.camera,{x:a,y:l},this.container);return d?(this.move(d),!1):this.dragEnd()}),dt(this,"dragEnd",()=>{if(this.isDragging){if(this.startInfo=void 0,this.isDragging=!1,this.dragGuideLine){this.scene.remove(this.dragGuideLine),this.dragGuideLine.geometry.dispose();const o=this.dragGuideLine.material;Array.isArray(o)?o.forEach(a=>a.dispose()):o.dispose(),this.dragGuideLine=void 0}this.helperObject3D.show(),this.hooks.emit("moveEnd")}});const t=this.helperObject3D;this.hoverListener([t.centerHandle,t.xArrow,t.yArrow,t.zArrow]);const i=this.show.bind(this),r=this.hide.bind(this),s=()=>{this.helperObject3D.update(this.camera),this.isDragging&&this.updateDragGuideLineScale(),this.render()};s(),this.domEvents.addEventListener(this.helperObject3D,"mousedown",this.dragStart),document.addEventListener("mousemove",this.dragging),document.addEventListener("mouseup",this.dragEnd),this.domEvents.addEventListener(this.helperObject3D,"touchstart",this.dragStart),document.addEventListener("touchmove",this.dragging),document.addEventListener("touchend",this.dragEnd),this.hooks.on("rotateStart",r),this.hooks.on("rotateEnd",i),this.hooks.on("scaleStart",r),this.hooks.on("scaleEnd",i),this.hooks.on("moveByMouseEnable",r),this.hooks.on("moveByMouseDisable",i),this.hooks.on("updateOtherHelpers",o=>{this.helperObject3D.update(o.camera),this.render()}),this.cameraHooks.on("cameraUpdate",s),this.disposers.push(()=>{this.domEvents.removeEventListener(this.helperObject3D,"mousedown",this.dragStart),document.removeEventListener("mousemove",this.dragging),document.removeEventListener("mouseup",this.dragEnd),this.domEvents.removeEventListener(this.helperObject3D,"touchstart",this.dragStart),document.removeEventListener("touchmove",this.dragging),document.removeEventListener("touchend",this.dragEnd),this.hooks.off("rotateStart",r),this.hooks.off("rotateEnd",i),this.hooks.off("scaleStart",r),this.hooks.off("scaleEnd",i),this.hooks.off("moveByMouseEnable",r),this.hooks.off("moveByMouseDisable",i),this.hooks.off("updateOtherHelpers"),this.cameraHooks.off("cameraUpdate",s)}),this.moveByMouseEnable&&this.moveByMouse()}get moveByMouseEnable(){return this._moveByMouse.enabled}dispose(){var e;super.dispose(),(e=this.disposers)==null||e.forEach(t=>t==null?void 0:t())}moveByMouse(e){this._moveByMouse={enabled:!0,useFaceNormal:e==null?void 0:e.useFaceNormal},this.preventTapDefaultEvent=!0;const t=this.handleMouseDown.bind(this),i=this.handleMouseUp.bind(this);this.hooks.emit("moveByMouseEnable"),setTimeout(()=>{this.container.addEventListener("mousedown",t),this.container.addEventListener("mouseup",i)}),this.mousedownEventListenerDisposer=()=>{this.container.removeEventListener("mousedown",t),this.container.removeEventListener("mouseup",i)}}disableMoveByMouse(){var e;this._moveByMouse={enabled:!1},this.preventTapDefaultEvent=!1,this.hooks.emit("moveByMouseDisable"),(e=this.mousedownEventListenerDisposer)==null||e.call(this)}onIntersectionOnModelUpdate(e){var t,i,r;if(!this.moveByMouseEnable)return;const{point:s,face:o}=e;if(!this.hooks.emit("wantToMove",s)){if(this.originObject3D.position.copy(s),(this._moveByMouse.useFaceNormal===!0||typeof this._moveByMouse.useFaceNormal=="object"&&this._moveByMouse.useFaceNormal.enable!==!1)&&o!=null&&o.normal){const a=(()=>typeof this._moveByMouse.useFaceNormal=="object"&&this._moveByMouse.useFaceNormal.alignmentVector?this._moveByMouse.useFaceNormal.alignmentVector:{x:0,y:1,z:0})(),l=new O((t=a.x)!=null?t:0,(i=a.y)!=null?i:0,(r=a.z)!=null?r:0),d=(()=>typeof this._moveByMouse.useFaceNormal=="object"&&this._moveByMouse.useFaceNormal.fixedFaceNormal?this._moveByMouse.useFaceNormal.fixedFaceNormal(o.normal):o.normal)();this.originObject3D.quaternion.setFromUnitVectors(l,d),this.internalHooks.emit("setObjectRotate",this.originObject3D.quaternion.clone())}this.internalHooks.emit("setObjectPosition",s),this.hooks.emit("move",s)}}handleMouseDown(e){const{x:t,y:i}=e;this.mouseInfo={x:t,y:i,mouseDownTimestamp:Date.now()}}handleMouseUp(e){if(!this.mouseInfo)return;const{x:t,y:i}=e;this.mouseInfo.x===t&&this.mouseInfo.y===i&&Date.now()-this.mouseInfo.mouseDownTimestamp<500&&(this.disableMoveByMouse(),this.mouseInfo=void 0)}updateDragGuideLineScale(){if(!this.dragGuideLine||!this.startInfo)return;const{line:e}=this.startInfo,t=e.end.clone().sub(e.start).normalize();if(t.lengthSq()<1e-6)return;const i=this.helperObject3D.getWorldPosition(new O);this.solidGuide.updateSolidLine(this.dragGuideLine,i,t)}move(e){if(!this.startInfo)return this.dragEnd();const{line:t,startVectorProject:i}=this.startInfo,r=this.originObject3D,s=this.startInfo.draggingDirection==="plane";let o;if(s){const f=this.startInfo.plane;if(!f)return;const g=new O,v=f.normal.dot(e.ray.direction);if(Math.abs(v)<1e-6)return;const w=-(f.normal.dot(e.ray.origin)+f.constant)/v;if(w<0)return;g.copy(e.ray.origin.clone().add(e.ray.direction.clone().multiplyScalar(w))),o=g}else o=Ft({raycaster:e,line:t,clampToLine:!1});const a=o.clone().sub(i),l=new K;l.setPosition(a);const d=r.position.clone().applyMatrix4(l);this.hooks.emit("wantToMove",d)||(r.applyMatrix4(l),i.copy(o),this.internalHooks.emit("applyObjectPosition",{matrix:l}),this.hooks.emit("move",d))}};var rm=Object.defineProperty,sm=(n,e,t)=>e in n?rm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,si=(n,e,t)=>(sm(n,typeof e!="symbol"?e+"":e,t),t);let oi=class{constructor(e,t,i,r,s,o,a,l){si(this,"helperController"),si(this,"five"),si(this,"onFiveWantsTapGesture",x=>{if(!this.helperController)return;if(this.helperController.preventTapDefaultEvent)return!1;const M=this.helperController.onWantsTapGesture(x);return this.five.needsRender=!0,M}),si(this,"onFiveWantsGesture",(...x)=>{if(!this.helperController)return;const M=this.helperController.onWantsGesture(...x);return this.five.needsRender=!0,M}),si(this,"onFiveIntersectionOnModelUpdate",(...x)=>{this.helperController&&this.helperController.onIntersectionOnModelUpdate(...x)});const{camera:d,model:f,scene:g}=e,v=e.getElement();if(this.five=e,!d||!f||!v||!g)return;const w=()=>{e.needsRender=!0};this.helperController=new i({camera:d,model:f,domEvents:t,originObject3D:r,helperObject3D:s,container:v,scene:g,onRender:w,sharedHooks:a,sharedInternalHooks:l},o),e.on("wantsTapGesture",this.onFiveWantsTapGesture),e.on("wantsGesture",this.onFiveWantsGesture),e.on("intersectionOnModelUpdate",this.onFiveIntersectionOnModelUpdate)}dispose(){var e;this.five.off("wantsTapGesture",this.onFiveWantsTapGesture),this.five.off("wantsGesture",this.onFiveWantsGesture),this.five.off("intersectionOnModelUpdate",this.onFiveIntersectionOnModelUpdate),(e=this.helperController)==null||e.dispose()}};var om=Object.defineProperty,Hl=Object.getOwnPropertySymbols,am=Object.prototype.hasOwnProperty,lm=Object.prototype.propertyIsEnumerable,Io=(n,e,t)=>e in n?om(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ai=(n,e)=>{for(var t in e||(e={}))am.call(e,t)&&Io(n,t,e[t]);if(Hl)for(var t of Hl(e))lm.call(e,t)&&Io(n,t,e[t]);return n},ir=(n,e,t)=>(Io(n,typeof e!="symbol"?e+"":e,t),t),Tl=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});const cm="v1.0.1",hm="Object3DHelper",ba=`${hm}@${cm}`,um=()=>{console.error(`${ba} is disposed`)},dm=()=>{console.warn(`${ba} is disabled`)},pm=()=>{console.error(`${ba} is disabled`)};let fm=class{constructor(e){ir(this,"controllers",{}),ir(this,"state",{visible:!0,enabled:!0,disposed:!1}),ir(this,"hooks",new it),ir(this,"eventListener",{}),e&&this.addControllers(e),this.setState(this.state)}show(e){return Tl(this,null,function*(){this.setState({visible:!0},e)})}hide(e){return Tl(this,null,function*(){this.setState({visible:!1},e)})}enable(e){this.setState({enabled:!0},e)}disable(e){this.setState({enabled:!1},e)}dispose(){this.setState({disposed:!0})}setState(e,t){if(this.state.disposed)return um();if(!this.state.enabled&&e.enabled!==!0&&e.disposed!==!0)return pm();const i=ai({},this.state);this.state=ai(ai({},this.state),e),e.disposed!==void 0&&e.disposed!==i.disposed&&e.disposed&&this.handleDispose(),e.visible!==void 0&&this.handleVisible(e.visible),e.enabled!==void 0&&this.handleEnable(e.enabled),this.hooks.emit("stateChange",{state:this.state,prevState:i})}addControllers(e){this.controllers=ai(ai({},this.controllers),e),this.setState(this.state)}initialHelperMatrix(){this.everyControllerDo(e=>{e.initialHelperPosition(),e.initialHelperQuaternion()})}getCurrentState(){return this.state}handleEnable(e,t=!0){e?(this.everyControllerDo(i=>{i.enable()}),this.hooks.emit("enable",{userAction:t})):(this.everyControllerDo(i=>{i.disable()}),this.hooks.emit("disable",{userAction:t})),this.state.enabled=e}handleVisible(e,t=!0){e?(this.everyControllerDo(i=>{i.show()}),this.actionIfStateIsEnabled(()=>this.hooks.emit("show",{userAction:t}))):(this.everyControllerDo(i=>{i.hide()}),this.actionIfStateIsEnabled(()=>this.hooks.emit("hide",{userAction:t}))),this.state.visible=e}everyControllerDo(e){Object.values(this.controllers).forEach(t=>{t&&e(t)})}handleDispose(){var e,t;Object.values(this.controllers).forEach(i=>{i==null||i.dispose()});for(const i in this.controllers){if(!i)continue;const r=i;(t=(e=this.eventListener)[r])==null||t.call(e)}}actionIfStateIsEnabled(e,t){if(this.state.enabled)return e();t!=null&&t.warnLog&&dm()}};function An(n){return n*Math.PI/180}var vm=Object.defineProperty,gm=(n,e,t)=>e in n?vm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ws=(n,e,t)=>(gm(n,typeof e!="symbol"?e+"":e,t),t);let Xs=new re,mm=class extends Ci{constructor(...e){var t,i,r;super(...e),Ws(this,"name","RotateController"),Ws(this,"startInfo"),Ws(this,"removeListener");const s=this.helperObject3D;this.hoverListener([(t=s.xCircle)==null?void 0:t.circle,(i=s.yCircle)==null?void 0:i.circle,(r=s.zCircle)==null?void 0:r.circle].filter(Boolean));const o=this.dragStart.bind(this),a=this.dragging.bind(this),l=this.dragEnd.bind(this),d=this.show.bind(this),f=this.hide.bind(this),g=()=>{this.helperObject3D.update(this.camera),this.render()};g(),this.domEvents.addEventListener(this.helperObject3D,"mousedown",o),document.addEventListener("mousemove",a),document.addEventListener("mouseup",l),this.domEvents.addEventListener(this.helperObject3D,"touchstart",o),document.addEventListener("touchmove",a),document.addEventListener("touchend",l),this.hooks.on("moveStart",f),this.hooks.on("moveEnd",d),this.hooks.on("scaleStart",f),this.hooks.on("scaleEnd",d),this.hooks.on("moveByMouseEnable",f),this.hooks.on("moveByMouseDisable",d),this.hooks.on("updateOtherHelpers",v=>{this.helperObject3D.update(v.camera),this.render()}),this.cameraHooks.on("cameraUpdate",g),this.disposers.push(()=>{this.domEvents.removeEventListener(this.helperObject3D,"mousedown",o),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l),this.domEvents.removeEventListener(this.helperObject3D,"touchstart",o),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",l),this.hooks.off("moveStart",f),this.hooks.off("moveEnd",d),this.hooks.off("scaleStart",f),this.hooks.off("scaleEnd",d),this.hooks.off("moveByMouseEnable",f),this.hooks.off("moveByMouseDisable",d),this.hooks.off("updateOtherHelpers"),this.cameraHooks.off("cameraUpdate",g)})}get rotateCenter(){return this.helperObject3D.position.clone()}setRotateAngle(e){const{x:t=0,y:i=0,z:r=0}=e,s=new nt(An(t),An(i),An(r)),o=new re().setFromEuler(s);if(this.hooks.emit("wantToRotate",o))return;const{originObject3D:a,rotateCenter:l}=this;ma(a,o,l),this.internalHooks.emit("setObjectRotate",o,l),this.hooks.emit("rotate",o),this.render()}getEulerAngle(e,t){const{originObject3D:i}=this,r=new nt().setFromQuaternion(i.quaternion),s={x:ht(r.x),y:ht(r.y),z:ht(r.z)},o={x:e==="x"?t:s.x,y:e==="y"?t:s.y,z:e==="z"?t:s.z},a=new nt(An(o.x),An(o.y),An(o.z));return new re().setFromEuler(a)}onApplyOriginObjectRotate(e){this.isDragging||super.onApplyOriginObjectRotate(e)}onApplyOriginObjectScale(e){}dragStart(e){if(this.isDragging)return;this.helperObject3D.update(this.camera);const t=e==null?void 0:e.intersect;if(!t)return this.dragEnd();const i=(t==null?void 0:t.object).direction;if(!i)return this.dragEnd();const r=t.point,s=this.getAngleHelper(i);this.setTipsAngle(0);const o=r.clone();o.y+=.2,this.setTipsPosition(o);const a=this.helperObject3D.quaternion.clone(),l=(()=>{if(i==="x")return new O(1,0,0).applyQuaternion(a);if(i==="y")return new O(0,1,0).applyQuaternion(a);if(i==="z")return new O(0,0,1).applyQuaternion(a)})(),d=new Xe().setFromNormalAndCoplanarPoint(l,r),f=d.projectPoint(r.clone(),new O).clone().sub(this.rotateCenter),g=f.angleTo(s.baseAxes.clone().applyQuaternion(a)),v=s.offsetAngle(g);this.setAngleHelperStart(i,v),this.setAngleHelperLength(i,0),this.startInfo={direction:i,startVector:f,directionVector:l,plane:d,angleHelper:s,angle:0,helperQuaternion:a.clone()},Xs=new re,this.helperObject3D.showDraggingHelper([i]),this.hooks.emit("rotateStart"),this.isDragging=!0}getMatrix(){var e,t;return(t=(e=this.originObject3D)==null?void 0:e.ext)==null?void 0:t.matrix}getMatrixAngle(e,t){let i;if(e&&e.isMatrix4){i=new re,e.decompose(new O,i,new O);const r=new nt().setFromQuaternion(i);if(t==="x")return Math.round(ht(r.z));if(t==="y")return Math.round(ht(r.y));if(t==="z")return Math.round(ht(r.x))}}parseAngleByDirection(e){var t,i;const r=(i=(t=this.originObject3D)==null?void 0:t.ext)==null?void 0:i.matrix;let s;if(r&&r.isMatrix4){s=new re,r.decompose(new O,s,new O);const o=new nt().setFromQuaternion(s);if(e==="x")return Math.round(ht(o.z));if(e==="y")return Math.round(ht(o.y));if(e==="z")return Math.round(ht(o.x))}}dragging(e){if(!this.isDragging)return;const t="touches"in e?e.touches[0].clientX:e.x,i="touches"in e?e.touches[0].clientY:e.y,r=Fr(this.camera,{x:t,y:i},this.container);return r?(this.rotate(r),!1):this.dragEnd()}rotate(e){if(!this.startInfo)return this.dragEnd();const{startVector:t,plane:i,angleHelper:r,direction:s,helperQuaternion:o}=this.startInfo,{originObject3D:a}=this,l=e.ray.intersectPlane(i,new O);if(!l)return;const d=this.rotateCenter.clone();let f=i.projectPoint(l.clone(),new O).clone().sub(d);const g=this.startInfo.directionVector.clone().normalize();f=f.clone().projectOnPlane(g).normalize().multiplyScalar(f.length());const v=new re().setFromUnitVectors(t.clone().normalize(),f.clone().normalize()),w=a.quaternion.clone().premultiply(v);if(t.angleTo(f)===0||this.hooks.emit("wantToRotate",w))return;const x=new nt().setFromQuaternion(new re().setFromUnitVectors(t.clone().normalize().applyQuaternion(o.clone().inverse()),f.clone().normalize().applyQuaternion(o.clone().inverse())),`${s.toUpperCase()}${"XZY".replace(s.toUpperCase(),"")}`)[s]*r.angleDirection;if(this.startInfo.angle+=x,this.setAngleHelperLength(s,this.startInfo.angle),this.setTipsAngle(ht(this.startInfo.angle)),d){const M=new O().subVectors(a.position,d).applyQuaternion(v).add(d);a.position.copy(M)}a.applyQuaternion(v),Xs.premultiply(v),this.internalHooks.emit("applyObjectRotate",{quaternion:v,origin:d}),this.hooks.emit("rotate",a.quaternion),this.startInfo.startVector=f}dragEnd(){var e;this.isDragging&&(this.applyHelperQuaternion(Xs,this.rotateCenter),(e=this.startInfo)!=null&&e.lineMeshes&&this.startInfo.lineMeshes.forEach(t=>{this.scene.remove(t),t.geometry.dispose(),t.material instanceof Mu&&t.material.dispose()}),this.startInfo=void 0,this.isDragging=!1,this.helperObject3D.show(),this.updateOtherHelpers(),this.hooks.emit("rotateEnd"))}updateOtherHelpers(){this.hooks.emit("updateOtherHelpers",{camera:this.camera})}getAngleHelper(e){var t,i,r;switch(e){case"x":return(t=this.helperObject3D.xCircle)==null?void 0:t.angleSector;case"y":return(i=this.helperObject3D.yCircle)==null?void 0:i.angleSector;case"z":return(r=this.helperObject3D.zCircle)==null?void 0:r.angleSector}}setAngleHelperStart(e,t){const i=this.getAngleHelper(e);if(!i){console.warn("angleHelper is undefined");return}if(i instanceof ue&&i.geometry instanceof en){const{radius:r,segments:s,thetaLength:o}=i.geometry.parameters;i.geometry=new en(r,s,t,o)}else console.warn("only support THREE.CircleGeometry")}setAngleHelperLength(e,t){const i=t>=0?Math.max(t,.001):Math.min(t,-.001),r=this.getAngleHelper(e);if(r instanceof ue&&r.geometry instanceof en){const{radius:s,thetaStart:o}=r.geometry.parameters,a=Math.ceil(Math.abs(i)*(40/(2*Math.PI)));r.geometry=new en(s,a,o,i)}else console.warn("only support THREE.CircleGeometry")}setTipsAngle(e){var t;const i=(t=this.helperObject3D.angleTips)==null?void 0:t.element;i&&(i.innerText=`${e.toFixed(0)}°`)}setTipsPosition(e){const t=this.helperObject3D.angleTips;if(!t)return;const i=e.project(this.camera),{x:r,y:s,z:o}=i;if(o>1)return;const a=(r+1)/2*100+"%",l=(-s+1)/2*100+"%";t.setLeftTop(a,l)}};var ym=Object.defineProperty,bm=(n,e,t)=>e in n?ym(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Bl=(n,e,t)=>(bm(n,typeof e!="symbol"?e+"":e,t),t);let wm=class extends Ci{constructor(...e){super(...e),Bl(this,"startInfo"),Bl(this,"name","RectangleScaleController")}enable(){this.helperObject3D.enable(),super.enable()}disable(){this.helperObject3D.disable(),super.disable()}show(){this.helperObject3D.show(),super.show()}hide(){this.helperObject3D.hide(),super.hide()}onApplyOriginObjectPosition(e){this.isDragging||super.onApplyOriginObjectPosition(e)}onApplyOriginObjectScale(e){this.helperObject3D.applyHelperScaleMatrix4(e.matrix,e.origin)}getDragPlane(){const e=new Xe,t=this.helperObject3D.cornerPositions;if(t.length!==0)return t.length<3?e.setFromNormalAndCoplanarPoint(this.originObject3D.getWorldDirection(new O),t[0]):e.setFromCoplanarPoints(t[0],t[1],t[2]),e}dragStart(e,t){var i,r;(r=(i=this.helperObject3D).updatePoints)==null||r.call(i);const s=this.getDragPlane();if(!s)return this.dragEnd();this.startInfo={startPoint:{position:t.position.clone(),direction:t.direction},plane:s},this.hooks.emit("scaleStart"),this.render(),this.isDragging=!0}dragging(e){if(!this.isDragging)return;const t=Fr(this.camera,e,this.container);if(!t)return this.dragEnd();this.scale(t)}scale(e){var t,i;if(!this.startInfo)return;const r=this.originObject3D,{startPoint:s,plane:o}=this.startInfo,a=this.helperObject3D.cornerPositions;if(a.length<4)return this.dragEnd();const l=e.ray.intersectPlane(o,new O);if(!l||xf(l,this.camera.position))return;const d=new O().addVectors(a[0],a[2]).divideScalar(2),{position:f,direction:g}=s,v=new O().subVectors(a[1],a[0]),w=new O().subVectors(a[3],a[0]),x=h=>{const u=new O(0,0,0);if(!this.startInfo)return u;const p=(h==="ew"?v:w).clone(),y=f.clone().projectOnVector(p),b=l.clone().projectOnVector(p),A=d.clone().projectOnVector(p);if(b.equals(y))return u;if(h==="ns"&&typeof this.startInfo.dragPointInCenterBottom!="boolean"){const L=new O().subVectors(b,A),F=L.x<0&&p.x>=0,I=L.y<0&&p.y>=0,H=L.z<0&&p.z>=0;this.startInfo.dragPointInCenterBottom=F||I||H}if(h==="ew"&&typeof this.startInfo.dragPointInCenterLeft!="boolean"){const L=new O().subVectors(b,A),F=L.x<0&&p.x>=0,I=L.y<0&&p.y>=0,H=L.z<0&&p.z>=0;this.startInfo.dragPointInCenterLeft=F||I||H}const j=new O().subVectors(b,y),E=j.length();return E>.3?(console.warn("offset.length() > 0.3, skipped",E),u):j},M=x("ew"),k=x("ns"),D=()=>{const h=M;this.helperObject3D.cornerPositions.forEach((u,p)=>{var y;(y=this.startInfo)!=null&&y.dragPointInCenterLeft?(p===0||p===3)&&u.add(h):(p===1||p===2)&&u.add(h)})},B=()=>{const h=k;this.helperObject3D.cornerPositions.forEach((u,p)=>{var y;(y=this.startInfo)!=null&&y.dragPointInCenterBottom?(p===0||p===1)&&u.add(h):(p===2||p===3)&&u.add(h)})};switch(g){case"ew":D();break;case"ns":B();break;case"nesw":case"nwse":D(),B()}const S=new O().subVectors(a[1],a[0]).length()/v.length(),C=new O().subVectors(a[3],a[0]).length()/w.length(),W=new O(S,C,1),T=new K().scale(W);r.isCSS3DObjectPlus&&r.applyScaleMatrix4?r.applyScaleMatrix4(T):r.scale.applyMatrix4(T),s.position.copy(l);const R=new O().addVectors(a[0],a[2]).divideScalar(2),N=new O().subVectors(R,d),Q=new K().setPosition(N);r.applyMatrix4(Q),(t=this.helperObject3D.css3DInstance)==null||t.css3DObject.applyMatrix4(Q),(i=this.helperObject3D.plane)==null||i.applyMatrix4(Q),this.internalHooks.emit("applyObjectScale",{matrix:T}),this.internalHooks.emit("applyObjectPosition",{matrix:Q}),this.render()}dragEnd(){this.isDragging&&(this.startInfo=void 0,this.isDragging=!1,"onScaleEnd"in this.helperObject3D&&typeof this.helperObject3D.onScaleEnd=="function"&&this.helperObject3D.onScaleEnd(),this.hooks.emit("scaleEnd"),this.render())}};var Pm=Object.defineProperty,Am=(n,e,t)=>e in n?Pm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xm=(n,e,t)=>(Am(n,typeof e!="symbol"?e+"":e,t),t);let Om=class extends wm{constructor(...e){super(...e),xm(this,"name","CSS3DScaleController"),this.addHTMLEventListener()}addHTMLEventListener(){this.helperObject3D.points.forEach(e=>{if(!e)return;const t=e.point,i=o=>this.dragStart(o,e),r=this.dragging.bind(this),s=this.dragEnd.bind(this);t.addEventListener("dragstart",i),t.addEventListener("drag",r),t.addEventListener("dragend",s)})}};var jm=Object.defineProperty,Em=(n,e,t)=>e in n?jm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Mm=(n,e,t)=>(Em(n,typeof e!="symbol"?e+"":e,t),t);let Cm=class extends Ci{constructor(...e){super(...e),Mm(this,"name","BoundingBoxController")}};var Im=Object.defineProperty,Dm=(n,e,t)=>e in n?Im(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zt=(n,e,t)=>(Dm(n,typeof e!="symbol"?e+"":e,t),t);let Sm=class extends dg{constructor(e,t){super(e,t),zt(this,"name","ScaleHelper"),zt(this,"scaleMeshes",[]),zt(this,"lineConnections",[]),zt(this,"positions",[]),zt(this,"container"),zt(this,"needsInitialScaling",!1),zt(this,"lastCamera",null),zt(this,"isInitializing",!1),t&&(this.positions=t.positions,this.container=t.container),this.raycast=()=>{}}initQuaternion(){this.quaternion.copy(this.originObject3D.quaternion)}initialPosition(e){if(this.isInitializing){console.warn("ScaleHelper: initialPosition called while already initializing, skipping");return}this.isInitializing=!0;try{this.position.copy(this.originObject3D.position);const t=typeof this.positions=="function"?this.positions():this.positions;if(!t){this.isInitializing=!1;return}this.clearAllSpheres(),this.scaleMeshes=t.map((i,r)=>{const s=km();return s.position.copy(i.handlePosition),s.scalePosition=i,s.children.forEach(o=>{o.scalePosition=i}),this.add(s),s}),this.createLineConnections(),this.needsInitialScaling=!0,this.lastCamera&&(this.applySphereScaling(this.lastCamera),this.applyLineScaling(this.lastCamera),this.needsInitialScaling=!1)}finally{this.isInitializing=!1}}clearAllSpheres(){this.scaleMeshes.forEach(t=>{this.remove(t)}),this.scaleMeshes=[];const e=this.children.filter(t=>t.name==="ScaleHelperSphere");e.length>0&&e.forEach(t=>{this.remove(t)})}createLineConnections(){this.lineConnections.forEach(i=>{this.remove(i.line)}),this.lineConnections=[];const e={top:"bottom",bottom:"top",left:"right",right:"left",front:"back",back:"front"},t=new Set;for(const i of this.scaleMeshes){const r=i.scalePosition.id;if(!r||t.has(r))continue;const s=e[r];if(!s)continue;const o=this.scaleMeshes.find(l=>l.scalePosition.id===s);if(!o)continue;const a=zm(i.position.clone(),o.position.clone());this.add(a),this.lineConnections.push({line:a,mesh1:i,mesh2:o}),t.add(r),t.add(s)}}update(e){const t=e.type==="OrthographicCamera",i=e.position.clone(),r=this.originObject3D.getWorldPosition(new O),s=i.sub(r).normalize(),o={front:new O(0,0,1).applyQuaternion(this.originObject3D.getWorldQuaternion(new re)),back:new O(0,0,-1).applyQuaternion(this.originObject3D.getWorldQuaternion(new re)),left:new O(-1,0,0).applyQuaternion(this.originObject3D.getWorldQuaternion(new re)),right:new O(1,0,0).applyQuaternion(this.originObject3D.getWorldQuaternion(new re)),top:new O(0,1,0).applyQuaternion(this.originObject3D.getWorldQuaternion(new re)),bottom:new O(0,-1,0).applyQuaternion(this.originObject3D.getWorldQuaternion(new re))};let a=-1,l="";Object.entries(o).forEach(([f,g])=>{const v=s.dot(g);v>a&&(a=v,l=f)});const d={top:"bottom",bottom:"top",left:"right",right:"left",front:"back",back:"front"};this.scaleMeshes.forEach(f=>{if(!t){f.visible=!0;return}const g=f.scalePosition.id,v=d[l];g===l||g===v?f.visible=!1:f.visible=!0}),this.updateLineConnections(),this.lastCamera&&(this.applySphereScaling(this.lastCamera),this.applyLineScaling(this.lastCamera))}applySphereScaling(e){this.updateMatrixWorld(!0),this.scaleMeshes.forEach(t=>{t.scale.setScalar(ya(e,t.scalePosition.handlePosition.clone().applyMatrix4(this.matrixWorld)))})}applyLineScaling(e){}showLineConnections(){this.lineConnections.forEach(e=>{const t=e.mesh1.visible&&e.mesh2.visible;e.line.visible=t})}hideLineConnections(){this.lineConnections.forEach(e=>{e.line.visible=!1})}updateLineConnections(){this.lineConnections.forEach(e=>{e.line.scale.set(1,1,1),e.line.position.set(0,0,0),e.line.rotation.set(0,0,0);const t=e.line.geometry.attributes.position;t.setXYZ(0,e.mesh1.position.x,e.mesh1.position.y,e.mesh1.position.z),t.setXYZ(1,e.mesh2.position.x,e.mesh2.position.y,e.mesh2.position.z),t.needsUpdate=!0;const i=e.mesh1.visible&&e.mesh2.visible;e.line.visible=i})}setScaleByCamera(e){this.lastCamera=e,this.applySphereScaling(e),this.applyLineScaling(e),this.needsInitialScaling&&requestAnimationFrame(()=>{this.applySphereScaling(e),this.applyLineScaling(e)}),this.needsInitialScaling=!1}};function km(){const n=new fr(.03,16,16),e=new Ie({color:16776960,side:We,transparent:!0,opacity:1,depthTest:!1,depthWrite:!1}),t=new ue(n,e);t.name="ScaleHelperSphere",t.renderOrder=rt.SCALE_HELPER_SPHERE;const i=.03*4,r=new fr(i,16,16),s=new Ie({transparent:!0,opacity:0,side:We,depthTest:!1,depthWrite:!1}),o=new ue(r,s);return o.name="ScaleHelperTransparentGroup",o.renderOrder=rt.SCALE_HELPER_SPHERE,o.add(t),o}function zm(n,e){const t=new ze,i=[n,e];t.setFromPoints(i);const r=new Sr({color:16776960,opacity:.75,transparent:!0,depthTest:!1,depthWrite:!1}),s=new na(t,r);return s.name="ScaleHelperSolidLine",s.renderOrder=rt.SCALE_HELPER_LINE,s.raycast=()=>{},s}var Lm=Object.defineProperty,Hm=(n,e,t)=>e in n?Lm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wt=(n,e,t)=>(Hm(n,typeof e!="symbol"?e+"":e,t),t),Rl,Fl;let Tm=class extends Ci{constructor(...e){super(...e),wt(this,"name","ScaleController"),wt(this,"dragGuideLine"),wt(this,"currentFacePatch"),wt(this,"solidGuide",new yh(this.camera,this.container,(Fl=(Rl=this.config)==null?void 0:Rl.solidGuide)!=null?Fl:{})),wt(this,"startInfo"),wt(this,"dragStart",s=>{if(this.isDragging)return;this.isDragging=!0;const{intersect:o}=s,a=this.camera.position,l=new Set(this.helperObject3D.scaleMeshes.map(D=>D.uuid));let d=o.object;for(;d.parent&&!l.has(d.uuid);)d=d.parent;const f=d,g=f.scalePosition.basePosition.clone(),v=f.scalePosition.handlePosition.clone(),w=v.clone().sub(g).clone(),x=new Ye(g,g.clone().add(w.normalize().multiplyScalar(5)));x.applyMatrix4(this.helperObject3D.matrixWorld);const M=new Oi(a,o.point.clone().sub(a)),k=Ft({raycaster:M,line:x});this.startInfo={line:x,scaleStartPoint:k,draggingObject:f},this.helperObject3D.scaleMeshes.forEach(D=>{D.uuid!==f.uuid&&(D.visible=!1)}),"hideLineConnections"in this.helperObject3D&&typeof this.helperObject3D.hideLineConnections=="function"&&this.helperObject3D.hideLineConnections();try{this.originObject3D.updateMatrixWorld(!0),this.helperObject3D.updateMatrixWorld(!0);const D=Va(this.originObject3D),B=D?D.getCenter(new O):this.originObject3D.getWorldPosition(new O),S=v.clone().applyMatrix4(this.helperObject3D.matrixWorld).clone().sub(B).normalize(),C=B,W=this.solidGuide.createSolidLine(C,S,{color:16777215,renderOrder:rt.DRAG_GUIDE_LINE});this.scene.add(W),this.dragGuideLine=W,this.addFaceMesh()}catch{}f.visible=!0,this.hooks.emit("scaleStart")}),wt(this,"dragging",s=>{const o="touches"in s?s.touches[0].clientX:s.x,a="touches"in s?s.touches[0].clientY:s.y,l=Fr(this.camera,{x:o,y:a},this.container);if(!this.isDragging){l&&this.addHoverFaceMesh(l);return}if(this.startInfo)return l?(this.scale(l),this.updateDragGuideLineDirection(),this.removeFaceMesh(),!1):this.dragEnd()}),wt(this,"scale",s=>{var o,a;if(!this.startInfo)return;const{line:l,scaleStartPoint:d,draggingObject:f}=this.startInfo,{scalePosition:g}=f,v=Ft({raycaster:s,line:l,clampToLine:!1});v.applyMatrix4(new K().getInverse(this.helperObject3D.matrixWorld.clone())),(a=(o=this.config)==null?void 0:o.scaleCallback)==null||a.call(o,{intersectPoint:v,scalePosition:g,offset:v.clone().sub(d)}),f.position.copy(v.clone()),this.hooks.emit("scale",new O(1,1,1))}),wt(this,"dragEnd",()=>{if(this.isDragging){if(this.startInfo=void 0,this.isDragging=!1,this.helperObject3D.scaleMeshes.forEach(s=>{s.visible=!0}),"showLineConnections"in this.helperObject3D&&typeof this.helperObject3D.showLineConnections=="function"&&this.helperObject3D.showLineConnections(),this.dragGuideLine){this.scene.remove(this.dragGuideLine),this.dragGuideLine.geometry.dispose();const s=this.dragGuideLine.material;Array.isArray(s)?s.forEach(o=>o.dispose()):s.dispose(),this.dragGuideLine=void 0}this.removeFaceMesh(),this.internalHooks.emit("initialHelperPosition"),this.hooks.emit("scaleEnd")}});const t=this.show.bind(this),i=this.hide.bind(this),r=()=>{"update"in this.helperObject3D&&typeof this.helperObject3D.update=="function"&&this.helperObject3D.update(this.camera),this.isDragging&&this.updateDragGuideLineScale(),this.render()};r(),this.domEvents.addEventListener(this.helperObject3D,"mousedown",this.dragStart),document.addEventListener("mousemove",this.dragging),document.addEventListener("mouseup",this.dragEnd),this.domEvents.addEventListener(this.helperObject3D,"touchstart",this.dragStart),document.addEventListener("touchmove",this.dragging),document.addEventListener("touchend",this.dragEnd),this.hooks.on("rotateStart",i),this.hooks.on("rotateEnd",t),this.hooks.on("moveStart",i),this.hooks.on("moveEnd",t),this.hooks.on("moveByMouseEnable",i),this.hooks.on("moveByMouseDisable",t),this.hooks.on("updateOtherHelpers",s=>{"update"in this.helperObject3D&&typeof this.helperObject3D.update=="function"&&this.helperObject3D.update(s.camera),this.isDragging&&this.updateDragGuideLineScale(),this.render()}),this.cameraHooks.on("cameraUpdate",r),this.disposers.push(()=>{if(this.domEvents.removeEventListener(this.helperObject3D,"mousedown",this.dragStart),document.removeEventListener("mousemove",this.dragging),document.removeEventListener("mouseup",this.dragEnd),this.domEvents.removeEventListener(this.helperObject3D,"touchstart",this.dragStart),document.removeEventListener("touchmove",this.dragging),document.removeEventListener("touchend",this.dragEnd),this.hooks.off("rotateStart",i),this.hooks.off("rotateEnd",t),this.hooks.off("moveStart",i),this.hooks.off("moveEnd",t),this.hooks.off("moveByMouseEnable",i),this.hooks.off("moveByMouseDisable",t),this.hooks.off("updateOtherHelpers"),this.cameraHooks.off("cameraUpdate",r),this.currentFacePatch){this.scene.remove(this.currentFacePatch),this.currentFacePatch.geometry.dispose();const s=this.currentFacePatch.material;Array.isArray(s)?s.forEach(o=>o.dispose()):s.dispose(),this.currentFacePatch=void 0}})}initialHelperPosition(){this.helperObject3D.initialPosition();const e=this;e.offHoverListener&&e.offHoverListener(),e.offHoverListener=this.hoverListener(this.helperObject3D.scaleMeshes)}getMoveMeshes(){var e,t,i,r;const s=[],o=(r=(i=(t=(e=this.helperObject3D.parent)==null?void 0:e.children)==null?void 0:t.find(a=>a.name==="MoveHelper"))==null?void 0:i.children)!=null?r:[];for(const a of o)a.name==="ArrowGroup"?s.push(...a.children):a.name==="center-plane-handle"&&s.push(a);return s}addHoverFaceMesh(e){var t,i;if(this.removeFaceMesh(),!((t=this.originObject3D.parent)!=null&&t.getWorldFacesGeometry))return;const r=(i=this.originObject3D.parent)==null?void 0:i.getWorldFacesGeometry(),s=this.helperObject3D.scaleMeshes,o=this.getMoveMeshes();if(e.intersectObjects(o,!1),e.intersectObjects(o,!1).length>0)return;let a=null,l=null;for(const d of s){if(!d.visible)continue;const f=e.intersectObject(d,!1);if(f&&f.length>0){a=d,l=f[0].point.clone();break}}if(a&&l&&Array.isArray(r)&&r.length>0){let d=null,f=1/0;for(const g of r){if(!g.vertices||g.vertices.length<3)continue;const v=new O;for(const x of g.vertices)v.add(x);v.divideScalar(g.vertices.length);const w=l.distanceTo(v);w<f&&(f=w,d=g)}d&&this.addFacePatch(d)}}addFaceMesh(){var e,t,i;const r=(e=this.startInfo)==null?void 0:e.draggingObject;if(!r||!((t=this.originObject3D.parent)!=null&&t.getWorldFacesGeometry))return;const s=(i=this.originObject3D.parent)==null?void 0:i.getWorldFacesGeometry();if(s&&s.length>0){const o=r.getWorldPosition(new O);let a=1/0,l=s[0];for(const d of s){const f=d.center;let g;if(f instanceof O)g=f;else if(Array.isArray(f)&&f.length===3)g=new O(f[0],f[1],f[2]);else continue;const v=g.distanceTo(o);v<a&&(a=v,l=d)}this.addFacePatch(l)}}removeFaceMesh(){if(this.currentFacePatch){this.scene.remove(this.currentFacePatch),this.currentFacePatch.geometry.dispose();const e=this.currentFacePatch.material;Array.isArray(e)?e.forEach(t=>t.dispose()):e.dispose(),this.currentFacePatch=void 0}}setScale(e){var t,i,r;let s=1,o=1,a=1;typeof e=="number"?(s=e,o=e,a=e):typeof e=="object"&&(s=(t=e.x)!=null?t:1,o=(i=e.y)!=null?i:1,a=(r=e.z)!=null?r:1);const l=new O(s,o,a);this.hooks.emit("wantToScale",l)||(this.originObject3D.scale.copy(l),this.internalHooks.emit("setObjectScale",l),this.hooks.emit("scale",l),this.render())}updateDragGuideLineDirection(){if(!this.dragGuideLine||!this.startInfo)return;const{draggingObject:e}=this.startInfo;this.originObject3D.updateMatrixWorld(!0),this.helperObject3D.updateMatrixWorld(!0);const t=Va(this.originObject3D),i=t?t.getCenter(new O):this.originObject3D.getWorldPosition(new O),r=e.position.clone().applyMatrix4(this.helperObject3D.matrixWorld).clone().sub(i).normalize(),s=i;this.solidGuide.updateSolidLine(this.dragGuideLine,s,r)}updateDragGuideLineScale(){if(!this.dragGuideLine||!this.startInfo)return;const{scalePosition:e}=this.startInfo.draggingObject,t=e.handlePosition.clone().applyMatrix4(this.helperObject3D.matrixWorld),i=e.basePosition.clone().applyMatrix4(this.helperObject3D.matrixWorld),r=t,s=t.clone().sub(i).normalize();this.solidGuide.updateSolidLine(this.dragGuideLine,r,s)}addFacePatch(e){if(this.currentFacePatch){this.scene.remove(this.currentFacePatch),this.currentFacePatch.geometry.dispose();const s=this.currentFacePatch.material;Array.isArray(s)?s.forEach(o=>o.dispose()):s.dispose(),this.currentFacePatch=void 0}if(!e.vertices||e.vertices.length<3){console.warn("Face has no vertices, cannot create patch");return}const t=new ze;if(e.vertices.length===4){const s=new Float32Array([e.vertices[0].x,e.vertices[0].y,e.vertices[0].z,e.vertices[1].x,e.vertices[1].y,e.vertices[1].z,e.vertices[2].x,e.vertices[2].y,e.vertices[2].z,e.vertices[0].x,e.vertices[0].y,e.vertices[0].z,e.vertices[2].x,e.vertices[2].y,e.vertices[2].z,e.vertices[3].x,e.vertices[3].y,e.vertices[3].z]);t.setAttribute("position",new Ve(s,3)),t.setIndex([0,1,2,3,4,5])}else{const s=new Float32Array(e.vertices.length*3),o=new Uint16Array(e.vertices.length);e.vertices.forEach((a,l)=>{s[l*3]=a.x,s[l*3+1]=a.y,s[l*3+2]=a.z,o[l]=l}),t.setAttribute("position",new Ve(s,3)),t.setIndex(new Ve(o,1))}t.computeVertexNormals();const i=new Ie({color:16777215,side:We,depthTest:!1,depthWrite:!1,transparent:!0,opacity:.45}),r=new ue(t,i);return r.renderOrder=rt.DRAG_FACE_PATCH,this.scene.add(r),this.currentFacePatch=r,this.render(),r}};function J(n,e){this._camera=n||null,this._domElement=e||document,this._raycaster=new Oi,this._selected=null,this._boundObjs={};var t=this;this._$onClick=function(){t._onClick.apply(t,arguments)},this._$onDblClick=function(){t._onDblClick.apply(t,arguments)},this._$onMouseMove=function(){t._onMouseMove.apply(t,arguments)},this._$onMouseDown=function(){t._onMouseDown.apply(t,arguments)},this._$onMouseUp=function(){t._onMouseUp.apply(t,arguments)},this._$onTouchMove=function(){t._onTouchMove.apply(t,arguments)},this._$onTouchStart=function(){t._onTouchStart.apply(t,arguments)},this._$onTouchEnd=function(){t._onTouchEnd.apply(t,arguments)},this._$onContextmenu=function(){t._onContextmenu.apply(t,arguments)},this._domElement.addEventListener("click",this._$onClick,!1),this._domElement.addEventListener("dblclick",this._$onDblClick,!1),this._domElement.addEventListener("mousemove",this._$onMouseMove,!1),this._domElement.addEventListener("mousedown",this._$onMouseDown,!1),this._domElement.addEventListener("mouseup",this._$onMouseUp,!1),this._domElement.addEventListener("touchmove",this._$onTouchMove,!1),this._domElement.addEventListener("touchstart",this._$onTouchStart,!1),this._domElement.addEventListener("touchend",this._$onTouchEnd,!1),this._domElement.addEventListener("contextmenu",this._$onContextmenu,!1)}J.prototype.destroy=function(){this._domElement.removeEventListener("click",this._$onClick,!1),this._domElement.removeEventListener("dblclick",this._$onDblClick,!1),this._domElement.removeEventListener("mousemove",this._$onMouseMove,!1),this._domElement.removeEventListener("mousedown",this._$onMouseDown,!1),this._domElement.removeEventListener("mouseup",this._$onMouseUp,!1),this._domElement.removeEventListener("touchmove",this._$onTouchMove,!1),this._domElement.removeEventListener("touchstart",this._$onTouchStart,!1),this._domElement.removeEventListener("touchend",this._$onTouchEnd,!1),this._domElement.removeEventListener("contextmenu",this._$onContextmenu,!1)};J.eventNames=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu","touchstart","touchend"];J.prototype._getRelativeMouseXY=function(n){var e=n.target||n.srcElement;e.nodeType===3&&(e=e.parentNode);var t={x:0,y:0},i=e,r=getComputedStyle(i,null);t.y+=parseInt(r.getPropertyValue("padding-top"),10),t.x+=parseInt(r.getPropertyValue("padding-left"),10);do t.x+=i.offsetLeft,t.y+=i.offsetTop,r=getComputedStyle(i,null),t.x+=parseInt(r.getPropertyValue("border-left-width"),10),t.y+=parseInt(r.getPropertyValue("border-top-width"),10);while(i=i.offsetParent);var s={width:e===window?window.innerWidth:e.offsetWidth,height:e===window?window.innerHeight:e.offsetHeight};return{x:Number((n.pageX-t.x)/s.width)*2-1,y:-((n.pageY-t.y)/s.height)*2+1}};J.prototype._objectCtxInit=function(n){n._3xDomEvent={}};J.prototype._objectCtxDeinit=function(n){delete n._3xDomEvent};J.prototype._objectCtxIsInit=function(n){return!!n._3xDomEvent};J.prototype._objectCtxGet=function(n){return n._3xDomEvent};J.prototype.camera=function(n){return n&&(this._camera=n),this._camera};J.prototype.bind=function(n,e,t,i){console.assert(J.eventNames.indexOf(e)!==-1,"not available events:"+e),this._objectCtxIsInit(n)||this._objectCtxInit(n);var r=this._objectCtxGet(n);r[e+"Handlers"]||(r[e+"Handlers"]=[]),r[e+"Handlers"].push({callback:t,useCapture:i}),this._boundObjs[e]===void 0&&(this._boundObjs[e]=[]),this._boundObjs[e].push(n)};J.prototype.addEventListener=J.prototype.bind;J.prototype.unbind=function(n,e,t,i){console.assert(J.eventNames.indexOf(e)!==-1,"not available events:"+e),this._objectCtxIsInit(n)||this._objectCtxInit(n);var r=this._objectCtxGet(n);r[e+"Handlers"]||(r[e+"Handlers"]=[]);for(var s=r[e+"Handlers"],o=0;o<s.length;o++){var a=s[o];if(t==a.callback&&i==a.useCapture){s.splice(o,1);break}}var l=this._boundObjs[e].indexOf(n);this._boundObjs[e].splice(l,1)};J.prototype.removeEventListener=J.prototype.unbind;J.prototype._bound=function(n,e){var t=this._objectCtxGet(e);return t?!!t[n+"Handlers"]:!1};J.prototype._isObjectVisible=function(n){for(var e=n;e;){if(e.visible===!1)return!1;e=e.parent}return!0};J.prototype._filterVisibleObjects=function(n){var e=this;return n.filter(function(t){return e._isObjectVisible(t)})};J.prototype._onMove=function(n,e,t,i){var r=this._boundObjs[n];if(!(r===void 0||r.length===0)){var s=this._filterVisibleObjects(r);if(s.length!==0){var o=new Nt;o.set(e,t),this._raycaster.setFromCamera(o,this._camera);var a=this._raycaster.intersectObjects(s),l=this;a=a.filter(function(M){return l._isObjectVisible(M.object)}),a.sort(function(M,k){var D=M.object.renderOrder||0,B=k.object.renderOrder||0;return D!==B?B-D:M.distance-k.distance});var d=this._selected;if(a.length>0){var f,g,v,w=a[0],x=w.object;this._selected=x,v=this._bound("mousemove",x),d!=x&&(f=this._bound("mouseover",x),g=d&&this._bound("mouseout",d))}else g=d&&this._bound("mouseout",d),this._selected=null;v&&this._notify("mousemove",x,i,w),f&&this._notify("mouseover",x,i,w),g&&this._notify("mouseout",d,i,w)}}};J.prototype._onEvent=function(n,e,t,i){var r=this._boundObjs[n];if(!(r===void 0||r.length===0)){var s=this._filterVisibleObjects(r);if(s.length!==0){var o=new Nt;o.set(e,t),this._raycaster.setFromCamera(o,this._camera);var a=this._raycaster.intersectObjects(s,!0),l=this;if(a=a.filter(function(w){return l._isObjectVisible(w.object)}),a.sort(function(w,x){var M=w.object.renderOrder||0,k=x.object.renderOrder||0;return M!==k?k-M:w.distance-x.distance}),a.length!==0){for(var d=a[0],f=d.object,g=this._objectCtxGet(f),v=f.parent;typeof g>"u"&&v;)g=this._objectCtxGet(v),v=v.parent;g&&this._notify(n,f,i,d)}}}};J.prototype._notify=function(n,e,t,i){var r=this._objectCtxGet(e),s=r?r[n+"Handlers"]:null;if(!r||!s||s.length===0){e.parent&&this._notify(n,e.parent,t,i);return}for(var s=r[n+"Handlers"],o=0;o<s.length;o++){var a=s[o],l=!0;a.callback({type:n,target:e,origDomEvent:t,intersect:i,stopPropagation:function(){l=!1}}),l&&a.useCapture===!1&&e.parent&&this._notify(n,e.parent,t,i)}};J.prototype._onMouseDown=function(n){return this._onMouseEvent("mousedown",n)};J.prototype._onMouseUp=function(n){return this._onMouseEvent("mouseup",n)};J.prototype._onMouseEvent=function(n,e){var t=this._getRelativeMouseXY(e);this._onEvent(n,t.x,t.y,e)};J.prototype._onMouseMove=function(n){var e=this._getRelativeMouseXY(n);this._onMove("mousemove",e.x,e.y,n),this._onMove("mouseover",e.x,e.y,n),this._onMove("mouseout",e.x,e.y,n)};J.prototype._onClick=function(n){this._onMouseEvent("click",n)};J.prototype._onDblClick=function(n){this._onMouseEvent("dblclick",n)};J.prototype._onContextmenu=function(n){this._onMouseEvent("contextmenu",n)};J.prototype._onTouchStart=function(n){return this._onTouchEvent("touchstart",n)};J.prototype._onTouchEnd=function(n){return this._onTouchEvent("touchend",n)};J.prototype._onTouchMove=function(n){if(n.touches.length==1){var e=Number(n.touches[0].pageX/window.innerWidth)*2-1,t=-(n.touches[0].pageY/window.innerHeight)*2+1;this._onMove("mousemove",e,t,n),this._onMove("mouseover",e,t,n),this._onMove("mouseout",e,t,n)}};J.prototype._onTouchEvent=function(n,e){var t=e.touches;if(t.length==0&&(t=e.changedTouches),t.length==1){var i=Number(t[0].pageX/window.innerWidth)*2-1,r=-(t[0].pageY/window.innerHeight)*2+1;this._onEvent(n,i,r,e)}};var Bm=Object.defineProperty,Nl=Object.getOwnPropertySymbols,Rm=Object.prototype.hasOwnProperty,Fm=Object.prototype.propertyIsEnumerable,Do=(n,e,t)=>e in n?Bm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Re=(n,e)=>{for(var t in e||(e={}))Rm.call(e,t)&&Do(n,t,e[t]);if(Nl)for(var t of Nl(e))Fm.call(e,t)&&Do(n,t,e[t]);return n},xn=(n,e,t)=>(Do(n,typeof e!="symbol"?e+"":e,t),t),Wl=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});const So="Object3DHelperPlugin",wa=So,Nm=()=>{console.error(`${wa} is disposed`)},Wm=()=>{console.warn(`${wa} is disabled`)},Xm=()=>{console.error(`${wa} is disabled`)};class Qm extends ap{constructor(e){super(e),xn(this,"name",So),xn(this,"state",{visible:!0,enabled:!0,disposed:!1}),xn(this,"objectHelperMap",new Map),xn(this,"css3DObjectParentMap",new Map),xn(this,"css3DObjectModeMap",new Map),xn(this,"css3DRender"),this.five=e,this.css3DRender=new Mc(this.five.scene),console.warn("Object3DHelper: 使用此插件，需要在初始化five时，设置five参数: { backgroundAlpha: 0, backgroundColor: 0x000000 }"),Object.assign(window,{[`__${So.toUpperCase()}_DEBUG__`]:this})}show(e){return Wl(this,null,function*(){this.setState({visible:!0},e)})}hide(e){return Wl(this,null,function*(){this.setState({visible:!1},e)})}enable(e){this.setState({enabled:!0},e)}disable(e){this.setState({enabled:!1},e)}dispose(){this.setState({disposed:!0})}setState(e,t){if(this.state.disposed)return Nm();if(!this.state.enabled&&e.enabled!==!0&&e.disposed!==!0)return Xm();const i=Re({},this.state);this.state=Re(Re({},this.state),e),e.disposed!==void 0&&e.disposed!==i.disposed&&e.disposed&&this.handleDispose(),e.visible!==void 0&&e.visible!==i.visible&&this.handleVisible(e.visible),e.enabled!==void 0&&e.enabled!==i.enabled&&this.handleEnable(e.enabled),this.hooks.emit("stateChange",{state:this.state,prevState:i})}getObject3DHelper(e){return this.objectHelperMap.get(e)}addObject3DHelper(e,t={}){var i;if(!e){console.error("Object3D is undefined");return}if(this.objectHelperMap.has(e)){console.warn(`Object3DHelperPlugin: object3D ${e.name} is already has helper`);return}const r=new fm,s=[],o=(i=this.five.getElement())==null?void 0:i.parentElement,a=this.five.camera,l=Re(Re({},{moveHelper:!0,rotateHelper:!0,scaleHelper:!0,boundingBoxHelper:!1,positionFrom:"objectPosition"}),t),{moveHelper:d,rotateHelper:f,scaleHelper:g,boundingBoxHelper:v}=l,w=r.hooks,x=new it,M=new J(this.five.camera,this.five.getElement()),k=D=>{if(D)return typeof D=="boolean"?D:D.enable};if(k(d)){const D=Re(Re({},this.getConfig(l.moveHelper)),l),B=new Og(e,Re({},D)),S=new oi(this.five,M,im,e,B,D,w,x);r.addControllers({moveController:S.helperController}),s.push(()=>S.dispose())}if(k(f)){const D=Re(Re({},this.getConfig(l.rotateHelper)),l),B=new zg(e,Re({container:o},D)),S=new oi(this.five,M,mm,e,B,D,w,x);r.addControllers({rotateController:S.helperController}),s.push(()=>S.dispose())}if(k(v)){const D=new Ug(e),B=new oi(this.five,M,Cm,e,D,void 0,w,x);r.addControllers({boundingBoxController:B.helperController}),s.push(()=>B.dispose())}if(k(g))if(e.isCSS3DObject&&o){const D=new $g(e,o,a,this.five.scene),B=new oi(this.five,M,Om,e,D,void 0,w,x);r.addControllers({scaleController:B.helperController}),s.push(()=>B.dispose()),xc(this.five).then(()=>{var S,C;if(e.isCSS3DObjectPlus){const W=e;if(!W||W.mode!=="front")return;const T=(S=this.css3DRender.behindModeCSS3DRenderer.wrapper)!=null?S:Oc(this.five);T&&(this.css3DObjectParentMap.set(W,W.parent),W.removeFromParent(),this.css3DRender.behindModeCSS3DRenderer.setWrapper(T),(C=this.css3DRender.getBehindCSS3DObjectGroup())==null||C.add(W),this.css3DRender.render(this.five.camera))}else e.isCSS3DObject&&(this.css3DObjectModeMap.set(e,e.mode),e.mode="behind")})}else{const D=Re(Re({},this.getConfig(l.scaleHelper)),l),B=new Sm(e,D),S=new oi(this.five,M,Tm,e,B,D,w,x);r.addControllers({scaleController:S.helperController}),s.push(()=>S.dispose())}return this.objectHelperMap.set(e,{helper:r,disposers:s}),r.controllers}removeObject3DHelper(e){if(!this.objectHelperMap.has(e))return;const{helper:t,disposers:i}=this.objectHelperMap.get(e);if(t){if(e.isCSS3DObjectPlus){const r=e,s=this.css3DObjectParentMap.get(r);s&&s.add(r),this.css3DRender.render(this.five.camera)}else if(e.isCSS3DObject){const r=this.css3DObjectModeMap.get(e);e.mode=r}this.objectHelperMap.delete(e),t.dispose(),i==null||i.forEach(r=>r==null?void 0:r())}}handleEnable(e,t=!0){e?(this.everyHelperDo(i=>i.enable()),this.hooks.emit("enable",{userAction:t})):(this.everyHelperDo(i=>i.disable()),this.hooks.emit("disable",{userAction:t})),this.state.enabled=e}handleVisible(e,t=!0){e?(this.everyHelperDo(i=>i.show()),this.actionIfStateIsEnabled(()=>this.hooks.emit("show",{userAction:t}))):(this.everyHelperDo(i=>i.hide()),this.actionIfStateIsEnabled(()=>this.hooks.emit("hide",{userAction:t}))),this.state.visible=e}handleDispose(){this.everyHelperDo((e,t)=>{e.dispose(),t==null||t.forEach(i=>i==null?void 0:i())})}everyHelperDo(e){this.objectHelperMap.forEach(({helper:t,disposers:i})=>{t&&e(t,i)})}actionIfStateIsEnabled(e,t){if(this.state.enabled)return e();t!=null&&t.warnLog&&Wm()}getConfig(e){if(e&&typeof e!="boolean"&&e.enable)return e}}var $m=Object.defineProperty,Gm=Object.defineProperties,_m=Object.getOwnPropertyDescriptors,Xl=Object.getOwnPropertySymbols,Um=Object.prototype.hasOwnProperty,Vm=Object.prototype.propertyIsEnumerable,ko=(n,e,t)=>e in n?$m(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ym=(n,e)=>{for(var t in e||(e={}))Um.call(e,t)&&ko(n,t,e[t]);if(Xl)for(var t of Xl(e))Vm.call(e,t)&&ko(n,t,e[t]);return n},qm=(n,e)=>Gm(n,_m(e)),Lt=(n,e,t)=>(ko(n,typeof e!="symbol"?e+"":e,t),t);let Jm=class{constructor(){Lt(this,"five"),Lt(this,"config"),Lt(this,"_cursor"),Lt(this,"_pointSelector"),Lt(this,"_fiveDomEvents"),Lt(this,"_object3DHelper"),Lt(this,"inited",!1),Lt(this,"init",(e,t)=>{this.inited=!0,this.five=e,this.config=t,this._cursor=void 0,this._pointSelector=void 0,this._fiveDomEvents=void 0,this._object3DHelper=void 0})}get cursor(){if(!this.inited)throw new Error("Global not inited");return this._cursor?this._cursor:(this._cursor=new Xf(this.five.getElement()),this._cursor)}get pointSelector(){var e,t;if(!this.inited)throw new Error("Global not inited");if(this._pointSelector)return this._pointSelector;const i=(e=this.config)==null?void 0:e.magnifier;let r=i===null||i===!1?{magnifier:null}:{magnifierParams:i};return(t=this.config)!=null&&t.hideCursorCircle&&(r=qm(Ym({},r),{pointHelper:null})),this._pointSelector=new Rd(this.five,{mode:"cursor",helper:r}),this._pointSelector}get fiveDomEvents(){if(!this.inited)throw new Error("Global not inited");return this._fiveDomEvents?this._fiveDomEvents:(this._fiveDomEvents=new lf(this.five,{noEmitWhenNotInScene:!0}),this._fiveDomEvents)}get object3DHelper(){if(!this.inited)throw new Error("Global not inited");return this._object3DHelper?this._object3DHelper:(this._object3DHelper=new Qm(this.five),this._object3DHelper)}};const bh=new Jm;window.globalModules=bh;function wh(n,e){return n?e(n)?n:n.parent?wh(n.parent,e):null:null}function Zm(n){const e=[...n];if(n.length<3)return n;const t=n[n.length-1],i=n[0];return t.equals(i)||e.push(i),e}var Km=Object.defineProperty,ey=Object.defineProperties,ty=Object.getOwnPropertyDescriptors,jr=Object.getOwnPropertySymbols,Ph=Object.prototype.hasOwnProperty,Ah=Object.prototype.propertyIsEnumerable,zo=(n,e,t)=>e in n?Km(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fi=(n,e)=>{for(var t in e||(e={}))Ph.call(e,t)&&zo(n,t,e[t]);if(jr)for(var t of jr(e))Ah.call(e,t)&&zo(n,t,e[t]);return n},Pa=(n,e)=>ey(n,ty(e)),ny=(n,e)=>{var t={};for(var i in n)Ph.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&jr)for(var i of jr(n))e.indexOf(i)<0&&Ah.call(n,i)&&(t[i]=n[i]);return t},Mn=(n,e,t)=>(zo(n,typeof e!="symbol"?e+"":e,t),t);let xh=class extends Et{constructor(e){super(),Mn(this,"name","PolylineBaseMesh"),Mn(this,"lines",[]),Mn(this,"withDots"),Mn(this,"paramsStyle");const t=e,{withDots:i,points:r}=t,s=ny(t,["withDots","points"]);this.withDots=i??!0,r&&this.setPoints(r),s&&this.setStyle(s)}get style(){var e;return{lineColor:this.lineColor,lineWidth:this.lineWidth,opacity:this.opacity,dashed:this.dashed,occlusionVisibility:this.occlusionVisibility,occlusionMode:this.occlusionMode,lengthEnable:(e=this.paramsStyle)==null?void 0:e.lengthEnable}}get opacity(){var e,t,i;return(i=(e=this.lines[0])==null?void 0:e.lineOpacity)!=null?i:(t=this.paramsStyle)==null?void 0:t.lineOpacity}get lineColor(){var e,t,i;return(i=(e=this.lines[0])==null?void 0:e.color)!=null?i:(t=this.paramsStyle)!=null&&t.lineColor?new ie(this.paramsStyle.lineColor):void 0}get lineWidth(){var e,t,i;return(i=(e=this.lines[0])==null?void 0:e.lineWidth)!=null?i:(t=this.paramsStyle)==null?void 0:t.lineWidth}get dashed(){var e,t,i;return(i=(e=this.lines[0])==null?void 0:e.dashed)!=null?i:(t=this.paramsStyle)==null?void 0:t.dashed}get occlusionVisibility(){var e,t,i;return(i=(e=this.lines[0])==null?void 0:e.occlusionVisibility)!=null?i:(t=this.paramsStyle)==null?void 0:t.occlusionVisibility}get occlusionMode(){var e,t,i;return(i=(e=this.lines[0])==null?void 0:e.occlusionMode)!=null?i:(t=this.paramsStyle)==null?void 0:t.occlusionMode}get points(){var e,t,i;return this.lines.map(r=>r.points[0]).concat((i=(t=this.lines)==null?void 0:t[((e=this.lines)==null?void 0:e.length)-1])==null?void 0:i.points[1]).filter(Boolean)}setPoints(e,t={closed:!1}){let i=e.map(he);t.closed&&(i=Zm(i)),i.forEach((r,s)=>{var o;const a=i[s+1];if(s!==0&&a===void 0)return;const l=(o=this.lines[s])!=null?o:(()=>{const d=new Po(Pa(fi({},this.style),{pointVisibility:this.withDots?{startPoint:s===0,endPoint:!0}:!1}));return this.lines[s]=d,this.add(d),d})();l.setStyle(this.style),l.setPoints([r,a])}),i.length===0?(this.lines.forEach(r=>r.removeFromParent()),this.lines=[]):i.length===1||this.lines.length>i.length-1&&this.lines.splice(i.length-1).forEach(r=>r.removeFromParent())}setStyle(e){this.paramsStyle=fi(fi({},this.paramsStyle),e),this.lines.forEach(t=>t.setStyle(this.paramsStyle))}highlight(){this.lines.forEach(e=>e.highlight())}unhighlight(){this.lines.forEach(e=>e.unhighlight())}},ln=class extends xh{constructor(...e){super(Pa(fi({},e[0]),{withDots:!1})),Mn(this,"name","PolylineMesh")}},Rt=class extends xh{constructor(...e){super(Pa(fi({},e[0]),{withDots:!0})),Mn(this,"name","PolylineWithDotsMesh")}};var iy=Object.defineProperty,ry=Object.defineProperties,sy=Object.getOwnPropertyDescriptors,Ql=Object.getOwnPropertySymbols,oy=Object.prototype.hasOwnProperty,ay=Object.prototype.propertyIsEnumerable,Lo=(n,e,t)=>e in n?iy(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Qs=(n,e)=>{for(var t in e||(e={}))oy.call(e,t)&&Lo(n,t,e[t]);if(Ql)for(var t of Ql(e))ay.call(e,t)&&Lo(n,t,e[t]);return n},$l=(n,e)=>ry(n,sy(e)),Pt=(n,e,t)=>(Lo(n,typeof e!="symbol"?e+"":e,t),t);const $s=new Map;let Mt=class Oh extends Et{constructor(e,t){var i,r;super(),Pt(this,"name","Sculpt"),Pt(this,"isSculptObject",!0),Pt(this,"draggable"),Pt(this,"selected"),Pt(this,"config"),Pt(this,"on",(s,o,a)=>pe.modules.fiveDomEvents.addEventListener(this,s,o,a)),Pt(this,"off",(...s)=>pe.modules.fiveDomEvents.removeEventListener(this,...s)),Pt(this,"applyObjectMatrixWorld",(s,o)=>{const a=o??this;return a.updateMatrixWorld(),Ec(a,s)}),Pt(this,"applyObjectReversalMatrixWorld",(s,o)=>{const a=o??this;return a.updateMatrixWorld(),Jh(a,s)}),e!=null&&e.id&&(this.uuid=e.id),this.config=Qs({defaultAction:!0,occlusionVisibility:!0,occlusionMode:"translucence"},t),e&&(xe((i=this.config)==null?void 0:i.occlusionMode)&&(e.style=$l(Qs({},e.style),{occlusionMode:this.config.occlusionMode})),xe((r=this.config)==null?void 0:r.occlusionVisibility)&&(e.style=$l(Qs({},e.style),{occlusionVisibility:this.config.occlusionVisibility}))),Ne("esc",()=>{this.stopCreating()}),this.config.defaultAction&&(Ne("backspace, delete",()=>{this.selected&&this.delete()}),this.on("click",()=>{var s;this.editing||(this.select({only:!0}),this.editor.enable(),(s=this.parent)==null||s.children.forEach(o=>{var a;o instanceof Oh&&o!==this&&((a=o._editor)==null||a.disable())}))}),Ne("esc",()=>{this.selected&&this.unselect()}))}get editing(){return this.pointSelector.enabled}get baseData(){return{id:this.uuid,type:this.type}}get pointSelector(){return pe.modules.pointSelector}undo(){throw new Error("Method not implemented.")}redo(){throw new Error("Method not implemented.")}canUndo(){throw new Error("Method not implemented.")}canRedo(){throw new Error("Method not implemented.")}stopCreating(){pe.modules.pointSelector.disable()}delete(){var e;this.stopCreating(),this.removeFromParent(),this.off(),(e=this.editor)==null||e.disable()}select(e={only:!1}){if(this.selected)return;this.selected=!0,this.highlight(),$s.has(this.parent.uuid)||$s.set(this.parent.uuid,[]);const t=$s.get(this.parent.uuid);t.push(this),e.only&&(t==null||t.forEach(i=>{i!==this&&i.unselect()}))}unselect(){var e;this.selected&&(this.selected=!1,this.unhighlight(),(e=this._editor)==null||e.disable())}highlight(){}unhighlight(){}showDeleteButton(e,t){pe.modules.cursor.showDeleteButton({clientX:e,clientY:t,container:document.body,onClick:()=>this.delete()}),pe.modules.five.once("cameraUpdate",()=>{pe.modules.cursor.removeDeleteButton()})}};var ly=Object.defineProperty,Gl=Object.getOwnPropertySymbols,cy=Object.prototype.hasOwnProperty,hy=Object.prototype.propertyIsEnumerable,Ho=(n,e,t)=>e in n?ly(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,uy=(n,e)=>{for(var t in e||(e={}))cy.call(e,t)&&Ho(n,t,e[t]);if(Gl)for(var t of Gl(e))hy.call(e,t)&&Ho(n,t,e[t]);return n},Er=(n,e,t)=>(Ho(n,typeof e!="symbol"?e+"":e,t),t);let Aa=class extends Et{constructor(e){super(),Er(this,"hooks",new it),Er(this,"originObject"),this.originObject=e}enable(){this.originObject.add(this)}disable(){this.originObject.remove(this)}},Ii=class extends Aa{constructor(e,t){super(e),Er(this,"objectHelperConfig"),Er(this,"onObjectUpdate",()=>{this.hooks.emit("objectUpdate")}),this.objectHelperConfig=t}get helper(){var e;return(e=pe.modules.object3DHelper.getObject3DHelper(this.originObject))==null?void 0:e.helper}enable(){super.enable();const e=typeof this.objectHelperConfig=="function"?this.objectHelperConfig():this.objectHelperConfig;pe.modules.object3DHelper.addObject3DHelper(this.originObject,uy({positionFrom:"boundingBox"},e));const t=pe.modules.object3DHelper.getObject3DHelper(this.originObject).helper;t.hooks.on("move",this.onObjectUpdate),t.hooks.on("rotate",this.onObjectUpdate),t.hooks.on("scale",this.onObjectUpdate)}disable(){var e,t,i;super.disable(),(e=this.helper)==null||e.hooks.off("move",this.onObjectUpdate),(t=this.helper)==null||t.hooks.off("rotate",this.onObjectUpdate),(i=this.helper)==null||i.hooks.off("scale",this.onObjectUpdate),pe.modules.object3DHelper.removeObject3DHelper(this.originObject)}initialHelperMatrix(){var e;(e=this.helper)==null||e.initialHelperMatrix()}};var dy=Object.defineProperty,py=(n,e,t)=>e in n?dy(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ur=(n,e,t)=>(py(n,typeof e!="symbol"?e+"":e,t),t);let xa=class extends Aa{constructor(e){super(e),ur(this,"draggingPoints",[]),ur(this,"onDragstart",t=>{const i=t.target;this.draggingPoints=this.pointMeshes.filter(r=>r.position.equals(i.position))}),ur(this,"onDragend",t=>{this.draggingPoints=[]})}get pointMeshes(){return this.children.filter(e=>e instanceof Dn)}get pointHandles(){return this.children}enable(){super.enable(),this.points.filter(xe).forEach(e=>{const t=new Dn;t.visible=!1,t.position.copy(e),t.draggable=!0,pe.modules.fiveDomEvents.addEventListener(t,"drag",this.onDrag),pe.modules.fiveDomEvents.addEventListener(t,"dragstart",this.onDragstart),pe.modules.fiveDomEvents.addEventListener(t,"dragend",this.onDragend),this.add(t)})}disable(){super.disable(),this.removeChildren()}},fy=class extends xa{constructor(e){super(e),ur(this,"onDrag",t=>{if(!this.draggingPoints||this.draggingPoints.length===0)return;const i=ji(pe.modules.five,t.raycaster);this.draggingPoints.forEach(r=>r.position.copy(i.point)),this.originObject.lineMesh.setPoints(this.pointMeshes.map(r=>r.position))})}get points(){return this.originObject.lineMesh.points}};var vy=Object.defineProperty,gy=(n,e,t)=>e in n?vy(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,my=(n,e,t)=>(gy(n,typeof e!="symbol"?e+"":e,t),t);let yy=class extends xa{constructor(e){super(e),my(this,"onDrag",t=>{if(!this.draggingPoints||this.draggingPoints.length===0)return;const i=ji(pe.modules.five,t.raycaster);this.draggingPoints.forEach(r=>r.position.copy(i.point)),this.originObject.polyLineMesh.setPoints(this.pointMeshes.map(r=>r.position))})}get points(){return this.originObject.polyLineMesh.points}};var by=Object.defineProperty,wy=Object.defineProperties,Py=Object.getOwnPropertyDescriptors,_l=Object.getOwnPropertySymbols,Ay=Object.prototype.hasOwnProperty,xy=Object.prototype.propertyIsEnumerable,To=(n,e,t)=>e in n?by(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dr=(n,e)=>{for(var t in e||(e={}))Ay.call(e,t)&&To(n,t,e[t]);if(_l)for(var t of _l(e))xy.call(e,t)&&To(n,t,e[t]);return n},jh=(n,e)=>wy(n,Py(e)),rr=(n,e,t)=>(To(n,typeof e!="symbol"?e+"":e,t),t),Oy=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});let Ul=class extends Mt{constructor(e,t){super(e,t),rr(this,"type","Polyline"),rr(this,"polyLineMesh"),rr(this,"_editor"),rr(this,"creatingObject"),e&&(this.polyLineMesh=new Rt(dr(dr({},e.style),e)),this.add(this.polyLineMesh))}get editor(){return this._editor||(this._editor=new yy(this)),this._editor}get data(){return jh(dr({},this.baseData),{points:Qe(this.applyObjectMatrixWorld(this.polyLineMesh.points)),style:{lineColor:new ie(this.polyLineMesh.lineColor).getHex(),lineWidth:this.polyLineMesh.lineWidth,dashed:this.polyLineMesh.dashed}})}setData(e){e.points&&this.polyLineMesh.setPoints(this.applyObjectReversalMatrixWorld(e.points.map(he))),this.polyLineMesh.setStyle(e.style)}highlight(){var e;(e=this.polyLineMesh)==null||e.highlight()}unhighlight(){var e;(e=this.polyLineMesh)==null||e.unhighlight()}canUndo(){var e;(e=this.creatingObject)==null||e.canUndo()}canRedo(){var e;(e=this.creatingObject)==null||e.canRedo()}undo(){var e;(e=this.creatingObject)==null||e.undo()}redo(){var e;(e=this.creatingObject)==null||e.redo()}create(e){return Oy(this,null,function*(){this.removeChildren();const t=new Rt(e);this.polyLineMesh=t,this.add(this.polyLineMesh),this.creatingObject=jy(t,this.pointSelector,e),yield this.creatingObject.finished,this.config.defaultAction&&this.editor.enable()})}};function jy(n,e,t){var i;const r=n.parent;if(!r)return;const{promise:s,resolve:o,reject:a}=zn(),l=(i=t==null?void 0:t.limit)!=null?i:"none",d=new ln(n.style);r.add(d);const f=new ln(jh(dr({},n.style),{dashed:!0,lengthEnable:!1}));r.add(f),e.enable();const g=[];let v,w,x;const M=[],k=()=>g.length>0,D=()=>M.length>0,B=()=>{k()&&(M.push(g.pop()),n.setPoints(g),W(x),e.pointSelectorHelper.magnifier.render())},S=()=>{D()&&(g.push(M.pop()),n.setPoints(g),W(x),e.pointSelectorHelper.magnifier.render())},C=T=>{M.length=0;const R=g.length===0?T.point:v.clone();g.push(R),n.setPoints(g)},W=T=>{const R=()=>{d.setPoints([]),f.setPoints([]),v=null};if(!T||(x=T,!(g!=null&&g.length)))return R();const N=g.at(-1).clone();l==="none"?(v=T.point,d.setPoints([N,v])):l==="xoz"?(w=w??new Xe().setFromNormalAndCoplanarPoint(new O(0,1,0),g[0]),e.plane=w,v=w.projectPoint(T.point,new O),d.setPoints([N,v]),f.setPoints([v,T.point])):l==="y"&&(g.length===1?(v=T.point,d.setPoints([N,v])):(w=w??new Xe().setFromCoplanarPoints(g[0],g[1],new O(0,1,0).add(g[0])),e.plane=w,v=w.projectPoint(T.point,new O),d.setPoints([N,v]),f.setPoints([v,T.point])))};return e.on("select",C),e.on("intersectionUpdate",W),e.on("disable",()=>{if(e.off("select",C),e.off("intersectionUpdate",W),e.plane=null,r.remove(d),r.remove(f),g.length<2)return r.remove(n),a(new Error("Cancelled"));o()}),{finished:s,canUndo:k,canRedo:D,undo:B,redo:S}}var Ey=Object.defineProperty,My=(n,e,t)=>e in n?Ey(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Cy=(n,e,t)=>(My(n,typeof e!="symbol"?e+"":e,t),t);let Iy=class extends Aa{constructor(e){super(e),Cy(this,"onDrag",t=>{var i;const r=ji(pe.modules.five,t.raycaster);(i=this.originObject.pointMesh)==null||i.position.copy(r.point)})}enable(){super.enable(),this.originObject.draggable=!0,this.originObject.on("drag",this.onDrag)}disable(){super.disable(),this.originObject.draggable=!1,this.originObject.off("drag",this.onDrag)}};var Dy=Object.defineProperty,Sy=Object.defineProperties,ky=Object.getOwnPropertyDescriptors,Vl=Object.getOwnPropertySymbols,zy=Object.prototype.hasOwnProperty,Ly=Object.prototype.propertyIsEnumerable,Bo=(n,e,t)=>e in n?Dy(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Gs=(n,e)=>{for(var t in e||(e={}))zy.call(e,t)&&Bo(n,t,e[t]);if(Vl)for(var t of Vl(e))Ly.call(e,t)&&Bo(n,t,e[t]);return n},Hy=(n,e)=>Sy(n,ky(e)),_s=(n,e,t)=>(Bo(n,typeof e!="symbol"?e+"":e,t),t),Ty=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});let Yl=class extends Mt{constructor(e,t){super(e,t),_s(this,"type","Point"),_s(this,"pointMesh"),_s(this,"_editor"),e&&(this.pointMesh=new Dn(Gs(Gs({},e.style),e)),this.add(this.pointMesh))}get editor(){return this._editor||(this._editor=new Iy(this)),this._editor}get data(){return Hy(Gs({},this.baseData),{point:Qe(this.applyObjectMatrixWorld(this.pointMesh.position)),style:{color:this.pointMesh.color.getHex(),size:this.pointMesh.size}})}setData(e){e.point&&this.pointMesh.position.copy(he(e.point)),this.pointMesh.setStyle(e.style)}highlight(){var e;(e=this.pointMesh)==null||e.highlight()}unhighlight(){var e;(e=this.pointMesh)==null||e.unhighlight()}setStyle(e){this.pointMesh.setStyle(e)}create(e){return Ty(this,null,function*(){this.pointMesh&&this.remove(this.pointMesh),this.add(this.pointMesh=new Dn(e)),yield By(this.pointMesh,this.pointSelector),this.config.defaultAction&&this.editor.enable()})}};function By(n,e){return new Promise((t,i)=>{e.enable(),n.visible=!1;const r=l=>{l&&(n.visible=!0,n.position.copy(l.point))},s=l=>{l&&(n.visible=!0,n.position.copy(l.point),o())},o=()=>{e.off("select",s),e.off("disable",a),e.off("intersectionUpdate",r),e.disable(),t()},a=()=>{e.off("select",s),e.off("disable",a),e.off("intersectionUpdate",r),n.removeFromParent(),i(new Error("Cancelled"))};e.on("intersectionUpdate",r),e.on("disable",a),e.once("select",s)})}var Ry=Object.defineProperty,Fy=Object.defineProperties,Ny=Object.getOwnPropertyDescriptors,Mr=Object.getOwnPropertySymbols,Eh=Object.prototype.hasOwnProperty,Mh=Object.prototype.propertyIsEnumerable,Ro=(n,e,t)=>e in n?Ry(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,sr=(n,e)=>{for(var t in e||(e={}))Eh.call(e,t)&&Ro(n,t,e[t]);if(Mr)for(var t of Mr(e))Mh.call(e,t)&&Ro(n,t,e[t]);return n},ql=(n,e)=>Fy(n,Ny(e)),Wy=(n,e)=>{var t={};for(var i in n)Eh.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&Mr)for(var i of Mr(n))e.indexOf(i)<0&&Mh.call(n,i)&&(t[i]=n[i]);return t},Jl=(n,e,t)=>(Ro(n,typeof e!="symbol"?e+"":e,t),t);let Xy=class extends ca{constructor(e){const t=e??{},{points:i}=t,r=Wy(t,["points"]);super(),Jl(this,"name","PolygonWithEdgeMesh"),Jl(this,"line",new ln),i&&this.setPoints(i),r&&this.setStyle(r)}get style(){return ql(sr({},super.style),{lineWidth:this.lineWidth,lineColor:this.lineColor})}get lineWidth(){return this.line.lineWidth}get lineColor(){return this.line.lineColor}raycast(e,t){return this.children.forEach(i=>{Cc(i,e,t,!0)}),!1}setPoints(e,t){super.setPoints(e,sr({closed:!0},t)),this.points&&(this.line.setPoints(this.points,sr({closed:!0},t)),this.addIfNotExists(this.line))}setStyle(e){super.setStyle(e),e.lineOpacity!==void 0?this.line.setStyle(ql(sr({},e),{lineOpacity:e.lineOpacity})):this.line.setStyle(e),this.needsRender=!0}highlight(){super.highlight(),this.line.highlight()}unhighlight(){super.unhighlight(),this.line.unhighlight()}};var Qy=Object.defineProperty,$y=(n,e,t)=>e in n?Qy(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Gy=(n,e,t)=>($y(n,typeof e!="symbol"?e+"":e,t),t);class Fo extends Xy{constructor(){super(...arguments),Gy(this,"name","AreaMesh")}}var _y=Object.defineProperty,Uy=(n,e,t)=>e in n?_y(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Vy=(n,e,t)=>(Uy(n,typeof e!="symbol"?e+"":e,t),t);let Yy=class extends xa{constructor(e){super(e),Vy(this,"onDrag",t=>{if(!this.draggingPoints||this.draggingPoints.length===0)return;const i=ji(pe.modules.five,t.raycaster),r=this.originObject.areaMesh.projectPoint(i.point);this.draggingPoints.forEach(s=>s.position.copy(r)),this.originObject.areaMesh.setPoints(this.pointMeshes.map(s=>s.position))})}get points(){return this.originObject.areaMesh.points}};var qy=Object.defineProperty,Jy=Object.defineProperties,Zy=Object.getOwnPropertyDescriptors,Zl=Object.getOwnPropertySymbols,Ky=Object.prototype.hasOwnProperty,eb=Object.prototype.propertyIsEnumerable,or=Math.pow,No=(n,e,t)=>e in n?qy(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vi=(n,e)=>{for(var t in e||(e={}))Ky.call(e,t)&&No(n,t,e[t]);if(Zl)for(var t of Zl(e))eb.call(e,t)&&No(n,t,e[t]);return n},Wo=(n,e)=>Jy(n,Zy(e)),ar=(n,e,t)=>(No(n,typeof e!="symbol"?e+"":e,t),t),tb=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});class Kl extends Mt{constructor(e,t){super(e,t),ar(this,"type","Polygon"),ar(this,"areaMesh"),ar(this,"_editor"),ar(this,"creatingObject"),e&&(this.areaMesh=new Fo(vi(vi({},e.style),e)),this.add(this.areaMesh))}get editor(){return this._editor||(this._editor=new Yy(this)),this._editor}get data(){return this.updateMatrixWorld(),Wo(vi({},this.baseData),{points:Qe(this.applyObjectMatrixWorld(this.areaMesh.points)),style:{color:this.areaMesh.color.getHex(),lineColor:this.areaMesh.lineColor.getHex(),lineWidth:this.areaMesh.lineWidth}})}setData(e){e.points&&this.areaMesh.setPoints(this.applyObjectReversalMatrixWorld(e.points.map(he))),this.areaMesh.setStyle(e.style)}highlight(){var e;(e=this.areaMesh)==null||e.highlight()}unhighlight(){var e;(e=this.areaMesh)==null||e.unhighlight()}canUndo(){var e,t,i;return(i=(t=(e=this.creatingObject)==null?void 0:e.canUndo)==null?void 0:t.call(e))!=null?i:!1}canRedo(){var e,t,i;return(i=(t=(e=this.creatingObject)==null?void 0:e.canRedo)==null?void 0:t.call(e))!=null?i:!1}undo(){var e,t;return(t=(e=this.creatingObject)==null?void 0:e.undo)==null?void 0:t.call(e)}redo(){var e,t;return(t=(e=this.creatingObject)==null?void 0:e.redo)==null?void 0:t.call(e)}create(e){return tb(this,null,function*(){var t;this.children.forEach(r=>{r.parent===this&&this.remove(r)}),this.children.length=0;const i=new Fo(e);this.areaMesh=i,this.add(this.areaMesh),this.creatingObject=Ch(this.areaMesh,this.pointSelector,e),yield(t=this.creatingObject)==null?void 0:t.finished,this.config.defaultAction&&this.editor.enable()})}}function Ch(n,e,t){var i,r,s,o,a,l,d;const{promise:f,resolve:g,reject:v}=zn(),w=n.parent;if(!w){v(new Error("No container"));return}const x=(i=t==null?void 0:t.limit)!=null?i:"none",M=t==null?void 0:t.simpleMode,k=(l=(a=(s=n.five)!=null?s:(r=n.get)==null?void 0:r.call(n,"five"))!=null?a:(o=window.globalModules)==null?void 0:o.five)!=null?l:window.$five;(t==null?void 0:t.autoClosePixelDistance)!=null;let D=0;M&&k&&k.model&&k.model.bounding&&typeof((d=k.model.bounding.max)==null?void 0:d.y)=="number"&&(D=k.model.bounding.max.y+1);const B=new ln(n.style);w==null||w.add(B);const S=new ln(Wo(vi({},n.style),{dashed:!0,lengthEnable:!1}));w==null||w.add(S);let C=[];function W(){var H,X;C.forEach(q=>{var $;return($=q.parent)==null?void 0:$.remove(q)});const _=(X=(H=n.line)==null?void 0:H.style)!=null?X:n.style;C=R.map((q,$)=>{var ee;const le=new Dn(Wo(vi({},_),{color:(ee=_.pointColor)!=null?ee:_.lineColor,tip:void 0,point:q}));return le.name=`PolygonPointMesh_${$}`,w==null||w.add(le),le})}function T(){C.forEach(H=>{var X;return(X=H.parent)==null?void 0:X.remove(H)}),C=[]}e.enable(),M&&e.setAdherePoints([]);const R=[];let N,Q,h=!1,u;const p=[],y=()=>R.length>0,b=()=>p.length>0,A=()=>{var H;y()&&(p.push(R.pop()),L(u),W(),(H=t==null?void 0:t.onUndo)==null||H.call(t),e.pointSelectorHelper&&e.pointSelectorHelper.magnifier&&e.pointSelectorHelper.magnifier.render())},j=()=>{var H;b()&&(R.push(p.pop()),L(u),W(),(H=t==null?void 0:t.onRedo)==null||H.call(t),e.pointSelectorHelper&&e.pointSelectorHelper.magnifier&&e.pointSelectorHelper.magnifier.render())},E=H=>{var X;p.length=0;let _=R.length===0?H.point:N.clone();M&&(_=_.clone().setY(D)),R.push(_),n.setPoints(R,{closed:!1}),W(),(X=t==null?void 0:t.onPointPlaced)==null||X.call(t,R),h&&(F(),g())},L=H=>{const X=()=>{B.setPoints([]),S.setPoints([]),n.setPoints(R),e.pointSelectorHelper&&e.pointSelectorHelper.magnifier&&e.pointSelectorHelper.magnifier.render()};if(!H){X(),W();return}if(u=H,!(R!=null&&R.length))return X();const _=R.at(-1).clone();if(R.length<3&&(M?(N=H.point.clone().setY(D),B.setPoints([_,N]),S.setPoints([])):x==="none"?(N=H.point,B.setPoints([_,N]),S.setPoints([])):x==="xoz"?(Q=Q??new Xe().setFromNormalAndCoplanarPoint(new O(0,1,0),R[0]),e.plane=Q,N=Q.projectPoint(H.point,new O),B.setPoints([_,N]),S.setPoints([N,H.point])):x==="y"&&(R.length===1?(N=H.point,B.setPoints([_,N]),S.setPoints([])):(Q=Q??new Xe().setFromCoplanarPoints(R[0],R[1],new O(0,1,0).add(R[0])),e.plane=Q,N=Q.projectPoint(H.point,new O),B.setPoints([_,N]),S.setPoints([N,H.point])))),R.length>=3){M?N=H.point.clone().setY(D):N=n.projectPoint(H.point);const q=R[0];let $=!1;if(typeof(t==null?void 0:t.autoClosePixelDistance)=="number"){if(k&&k.camera&&k.getElement){const ee=k.getElement(),le=ee.clientWidth,ce=ee.clientHeight,De=qe=>{const Je=qe.clone().project(k.camera);return{x:(Je.x*.5+.5)*le,y:(1-(Je.y*.5+.5))*ce}},Oe=De(q),$e=De(N),be=De(H.point),ye=Math.sqrt(or(Oe.x-$e.x,2)+or(Oe.y-$e.y,2)),je=Math.sqrt(or(Oe.x-be.x,2)+or(Oe.y-be.y,2));(ye<t.autoClosePixelDistance||je<t.autoClosePixelDistance)&&($=!0)}}else(q.distanceTo(N)<.2||q.distanceTo(H.point)<.2)&&($=!0);$?(N=q,H.point.copy(q),e.pointSelectorHelper.updateWithIntersect(H,{emitEvent:!1}),h=!0):h=!1,B.setPoints([_,N]),S.setPoints([N,H.point])}R.length>=2?(n.setPoints([...R,N],{closed:!1}),n.line.setPoints(n.points.slice(0,-1)),n.isBlank?(e.cursorError=!0,B.setStyle({lineColor:16734553}),S.setStyle({lineColor:16734553})):(e.cursorError=!1,B.setStyle({lineColor:n.lineColor}),S.setStyle({lineColor:n.lineColor}))):n.setPoints([]),W()},F=()=>{e.off("select",E),e.off("intersectionUpdate",L),e.off("disable",I),e.plane=null,e.disable(),w==null||w.remove(B,S),T()},I=()=>{F(),w==null||w.remove(n,S,B),T(),v(new Error("Cancelled"))};return e.on("select",E),e.on("intersectionUpdate",L),e.on("disable",I),{finished:f,canUndo:y,canRedo:b,undo:A,redo:j}}function nb(n){const e=[...n],t=[];for(let i=0;i<e.length-2;i++)t.push(0,i+1,i+2);return t}function ib(n){const e=n.map(t=>new O(t[0],t[1],t[2]));return Zc(e)}var rb=Object.defineProperty,sb=(n,e,t)=>e in n?rb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Us=(n,e,t)=>(sb(n,typeof e!="symbol"?e+"":e,t),t);let ob=class extends ze{constructor(e){super(),Us(this,"bottomPositions",[]),Us(this,"topPosition",[]),Us(this,"_type","Concave"),e&&this.setPosition(e)}setPosition(e){var t,i,r;const s=(t=e.bottomPositions)!=null?t:this.bottomPositions,o=(i=e.topPosition)!=null?i:this.topPosition;if(this._type=(r=e.type)!=null?r:this._type,this.bottomPositions=s,this.topPosition=o,!s||s.length<3){console.error("PrismGeometry: Invalid parameters",s,o,e),this.bottomPositions=[],this.setAttribute("position",new Ve(new Float32Array([]),3));return}const a=[],l=[];l.push(...s),l[0][0]===l.at(-1)[0]&&l[0][1]===l.at(-1)[1]&&l[0][2]===l.at(-1)[2]&&(l.length-=1);const d=this._type==="Concave"?ib(l):nb(l);if(a.push(...d),o&&o.length===3){const f=[o[0]-s[0][0],o[1]-s[0][1],o[2]-s[0][2]],g=l.map(w=>[w[0]+f[0],w[1]+f[1],w[2]+f[2]]);l.push(...g);const v=a.map(w=>w+l.length/2);a.push(...v);for(let w=0;w<l.length/2-1;w++)a.push(w,w+1,w+l.length/2),a.push(w+1,w+l.length/2+1,w+l.length/2);a.push(0,l.length/2,l.length/2-1),a.push(l.length/2,l.length-1,l.length/2-1)}this.setAttribute("position",new Bt(l.flat(),3)),this.setIndex(a),this.computeBoundingSphere()}};var ab=Object.defineProperty,ec=Object.getOwnPropertySymbols,lb=Object.prototype.hasOwnProperty,cb=Object.prototype.propertyIsEnumerable,Xo=(n,e,t)=>e in n?ab(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,tc=(n,e)=>{for(var t in e||(e={}))lb.call(e,t)&&Xo(n,t,e[t]);if(ec)for(var t of ec(e))cb.call(e,t)&&Xo(n,t,e[t]);return n},At=(n,e,t)=>(Xo(n,typeof e!="symbol"?e+"":e,t),t);class Qo extends Et{constructor(e){super(),At(this,"name","PrismMesh"),At(this,"five"),At(this,"activeAnimations",new Map),At(this,"activeEaseInAnimations",new Map),At(this,"_geometryInfoCache"),At(this,"geometryInfoNeedUpdate",!0),At(this,"edgeMesh",new ft),At(this,"prismMesh",new Tr),At(this,"paramStyle"),this.five=e==null?void 0:e.five,this.prismMesh.name="PrismMesh",this.prismMesh.geometry=new ob,this.edgeMesh.name="EdgeMesh",this.addIfNotExists(this.prismMesh,this.edgeMesh),e&&Object.keys(e).some(t=>t!=="five")&&this.setPoints(e),this.setStyle(e)}get topPosition(){return new O().fromArray(this.prismMesh.geometry.topPosition)}get bottomPositions(){return this.prismMesh.geometry.bottomPositions.map(e=>new O().fromArray(e))}get topPositions(){const e=this.bottomPositions[0].clone().sub(this.topPosition);return this.bottomPositions.map(t=>t.clone().sub(e))}get style(){return{color:this.color,lineColor:this.lineColor,lineWidth:this.lineWidth,opacity:this.opacity,occlusionVisibility:this.occlusionVisibility,occlusionMode:this.occlusionMode}}get opacity(){return this.prismMesh.opacity}get occlusionVisibility(){return this.prismMesh.occlusionVisibility}get occlusionMode(){return this.prismMesh.occlusionMode}get center(){return this.localCenter.clone()}get localCenter(){var e;return(e=this.geometryInfo.center.clone())!=null?e:new O(9999,9999,9999)}get geometryInfo(){if(this.geometryInfoNeedUpdate){this.geometryInfoNeedUpdate=!1;const e=this.prismMesh.geometry.bottomPositions,t=this.prismMesh.geometry.topPosition;if(!e||e.length<3||!t){this._geometryInfoCache=void 0;return}const i=e.map((l,d)=>d>=e.length-2?null:[new O().fromArray(e[0]),new O().fromArray(e[d+1]),new O().fromArray(e[d+2])]).filter(Boolean);if(i.length===0){this._geometryInfoCache=void 0;return}let r=0,s=new O;for(const[l,d,f]of i){const g=aa(l,d,f),v=Kc(l,d,f,g);r+=g,s.add(v)}s=s.divideScalar(r);const o=new O().fromArray(t).sub(new O().fromArray(e[0])),a=s.clone().add(o.divideScalar(2));this._geometryInfoCache={center:a}}return this._geometryInfoCache}get worldCenter(){return this.updateMatrixWorld(),this.localToWorld(this.localCenter)}get color(){return this.prismMesh.color}get lineWidth(){return this.edgeMesh.style.lineWidth}get lineColor(){return this.edgeMesh.color}setStyle(e={}){this.paramStyle=tc(tc({},this.paramStyle),e),this.prismMesh.setStyle(this.paramStyle),this.edgeMesh.setStyle(this.paramStyle)}isBox(){const e=this.prismMesh.geometry.bottomPositions;return e&&e.length===4}setPoints(e){var t;this.prismMesh.geometry.setPosition({bottomPositions:(t=e.points)==null?void 0:t.map(he).map(i=>i.toArray()),topPosition:e.heightPoint?he(e.heightPoint).toArray():void 0}),this.edgeMesh.geometry=new Zh().fromEdgesGeometry(new Cu(this.prismMesh.geometry)),this.geometryInfoNeedUpdate=!0}highlight(){this.prismMesh.highlight()}unhighlight(){this.prismMesh.unhighlight()}raycast(e,t){return this.children.forEach(i=>Cc(i,e,t,!0)),!1}setFive(e){this.five=e}playBoxAnimation(e){return this.five?this.isBox()?(this.activeAnimations.has(e)&&this.forceFinishBoxAnimation(e),new Promise(t=>{this.prismMesh.visible=!1,this.edgeMesh.visible=!1;const i=new O(1/0,1/0,1/0),r=new O(-1/0,-1/0,-1/0),s=this.bottomPositions;for(const C of s)i.min(C),r.max(C);const o=this.topPositions;for(const C of o)i.min(C),r.max(C);const a=r.clone().sub(i),l=new Lc(a.x,a.y,a.z),d=`
      varying vec2 vUV;
      varying vec3 vPosition;
      #include <common>
      void main() {
        vUV = uv;
        vPosition = position;
        vec4 transformed = vec4(position, 1.0);
        gl_Position = projectionMatrix * modelViewMatrix * transformed;
      }
      `,f=`
      #include <common>
      uniform vec3 color;
      uniform vec3 size;
      uniform vec2 faceSize;
      uniform float opacity;
      uniform float progress;
      uniform float spread;
      varying vec2 vUV;
      varying vec3 vPosition;
      void main() {

        float u = vUV.x;
        float v = vUV.y;
        float r = 0.1 + sqrt(u * u + v * v) * 0.3;

        // 边缘线
        if (size.y * v < 0.003 || size.y * (1.0 - v) < 0.003) {
          r += 0.8 * (1.0 - abs(u - 0.5) * 2.0);
        }
        if (size.x * u < 0.003 || size.x * (1.0 - u) < 0.003) {
          r += 0.8 * (1.0 - abs(v - 0.5) * 2.0);
        }

        // 扫光动画
        vec3 p = (vPosition + size / 2.0) / size;
        r = r * pow(clamp(1.0 - abs(p.y - progress) / spread, 0.0, 1.0), 2.0);

        gl_FragColor = vec4(color, clamp(r * opacity, 0.0, 1.0));
      }
      `,g=new ta({vertexShader:d,fragmentShader:f,uniforms:{color:{value:new ie(77/255,240/255,1)},size:{value:a},faceSize:{value:new Nt(1,1)},opacity:{value:.8},progress:{value:.5},spread:{value:.5}},depthTest:!1,side:We,transparent:!0});g.polygonOffset=!0,g.polygonOffsetFactor=1,g.polygonOffsetUnits=1;const v=new ue(l,[g.clone(),g.clone(),g.clone(),g.clone(),g.clone(),g.clone()]),w=this.localCenter.clone();w.applyMatrix4(this.matrixWorld);const x=new O,M=new re,k=new O;this.matrixWorld.decompose(x,M,k),v.position.copy(w),v.quaternion.copy(M),v.onBeforeRender=()=>{l.boundingBox||l.computeBoundingBox();const C=l.boundingBox.getSize(new O);for(let W=0;W<6;W++){const T=v.material[W];W===0||W===1?T.uniforms.faceSize.value.set(C.z,C.y):W===2||W===3?T.uniforms.faceSize.value.set(C.x,C.z):T.uniforms.faceSize.value.set(C.x,C.y)}for(const W of v.material)W.uniforms.size.value.copy(C);this.five.needsRender=!0};const D=3e3;let B=0;const S=Iu.shared.add((C,W)=>{B+=W;let T=B/D;T>1&&(T=1);let R=Math.abs((T-.5)*2);R=R*2-.5;for(const N of v.material)N.uniforms.progress.value=R;T===1&&(S(),v.visible=!1,this.playEaseInAnimation(e,()=>{this.activeAnimations.delete(e),t()})),this.five.needsRender=!0});this.activeAnimations.set(e,{animatedBoxMesh:v,remove:S}),this.five.scene.add(v)})):(console.warn("Animation only available for box shapes"),Promise.resolve()):(console.warn("Five instance not available for box animation"),Promise.resolve())}forceFinishBoxAnimation(e){if(!this.five){console.warn("Five instance not available for finishing box animation");return}(e?[e]:Array.from(this.activeAnimations.keys())).forEach(t=>{const i=this.activeAnimations.get(t);i&&(i.remove(),i.animatedBoxMesh.visible=!1,this.activeAnimations.delete(t));const r=this.activeEaseInAnimations.get(t);r&&(clearInterval(r.interval),this.activeEaseInAnimations.delete(t))}),this.showBoxFinalState(),this.five.needsRender=!0}playEaseInAnimation(e,t){if(!this.five)return;this.prismMesh.visible=!0,this.edgeMesh.visible=!0;let i=0;const r=this.prismMesh.style.opacity;this.prismMesh.setStyle({opacity:0}),this.edgeMesh.setStyle({lineOpacity:0});const s=setInterval(()=>{i===61&&(clearInterval(s),this.activeEaseInAnimations.delete(e),this.showBoxFinalState(),t()),this.edgeMesh.setStyle({lineOpacity:i/60}),this.prismMesh.setStyle({opacity:i/60*r}),this.five.needsRender=!0,i++},16);this.activeEaseInAnimations.set(e,{interval:s,model:this})}showBoxFinalState(){this.prismMesh.visible=!0,this.edgeMesh.visible=!0,this.prismMesh.setStyle({opacity:this.prismMesh.style.opacity}),this.edgeMesh.setStyle({lineOpacity:1})}}let hb=class extends Ii{constructor(e){super(e,()=>({positionFrom:()=>e.worldCenter,yAxis:()=>e.up,scaleHelper:{enable:!0,positions:()=>{const t=e.bottomPositions,i=e.topPosition,r=new O().subVectors(i,t[0]),s=e.geometryInfo.center,o=s.clone().sub(r.clone().divideScalar(2)),a=s.clone().add(r.clone().divideScalar(2));return[{id:"top",handlePosition:a,basePosition:o},{id:"bottom",handlePosition:o,basePosition:a}]},scaleCallback:t=>{const{intersectPoint:i,scalePosition:r}=t,{id:s,basePosition:o,handlePosition:a}=r;if(s==="top"){const l=i.clone().sub(o);e.setPoints({heightPoint:e.bottomPositions[0].clone().add(l)})}else if(s==="bottom"){const l=i.clone().sub(o);e.setPoints({points:e.topPositions.map(d=>d.clone().add(l))})}}}}))}};var ub=Object.defineProperty,db=Object.defineProperties,pb=Object.getOwnPropertyDescriptors,nc=Object.getOwnPropertySymbols,fb=Object.prototype.hasOwnProperty,vb=Object.prototype.propertyIsEnumerable,$o=(n,e,t)=>e in n?ub(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Vs=(n,e)=>{for(var t in e||(e={}))fb.call(e,t)&&$o(n,t,e[t]);if(nc)for(var t of nc(e))vb.call(e,t)&&$o(n,t,e[t]);return n},gb=(n,e)=>db(n,pb(e)),Ys=(n,e,t)=>($o(n,typeof e!="symbol"?e+"":e,t),t),Ih=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});class ic extends Mt{constructor(e,t){super(e,t),Ys(this,"type","Prism"),Ys(this,"prismMesh"),Ys(this,"_editor"),e&&(this.prismMesh=new Qo(Vs(Vs({},e.style),e)),this.add(this.prismMesh))}get editor(){return this._editor||(this._editor=new hb(this.prismMesh)),this._editor}get data(){return gb(Vs({},this.baseData),{points:Qe(this.applyObjectMatrixWorld(this.prismMesh.bottomPositions,this.prismMesh)),heightPoint:Qe(this.applyObjectMatrixWorld(this.prismMesh.topPosition,this.prismMesh)),style:{color:this.prismMesh.color.getHex(),lineWidth:this.prismMesh.lineWidth,lineColor:this.prismMesh.lineColor.getHex()}})}setData(e){this.prismMesh.setPoints({points:e.points?this.applyObjectReversalMatrixWorld(e.points.map(he),this.prismMesh):void 0,heightPoint:e.heightPoint?this.applyObjectReversalMatrixWorld(he(e.heightPoint),this.prismMesh):void 0}),this.prismMesh.setStyle(e.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var e;(e=this.prismMesh)==null||e.highlight()}unhighlight(){var e;(e=this.prismMesh)==null||e.unhighlight()}create(e){return Ih(this,null,function*(){this.prismMesh=new Qo(e),this.add(this.prismMesh),yield mb(this.prismMesh,this.pointSelector),this.config.defaultAction&&this.editor.enable()})}}function mb(n,e){return Ih(this,null,function*(){const t=n.parent,i=new Fo(n.style);t.add(i),yield Ch(i,e).finished,t.remove(i),n.setPoints({points:i.points});const r=new ft;r.name="LineHelper",t.add(r);const s=i.points.at(-1),o=kn(i.points),a=s.clone().add(o.clone().multiplyScalar(100)),l=s.clone().sub(o.clone().multiplyScalar(100));return r.setPoints([a,l]),e.enable(),new Promise((d,f)=>{const g=M=>{w(),d()},v=M=>{if(!(M!=null&&M.raycaster))return;const k=Ft({raycaster:M.raycaster,line:new Ye(a,l)});k&&n.setPoints({heightPoint:k})},w=()=>{e.off("select",g),e.off("intersectionUpdate",v),e.off("disable",x),t.remove(r),e.disable()},x=()=>{w(),t.remove(n),f(new Error("Cancelled"))};e.on("select",g),e.on("intersectionUpdate",v),e.on("disable",x)})})}let yb=class extends Ii{constructor(e){super(e,()=>({yAxis:()=>{const t=e.points;return kn(t).normalize()},zAxis:()=>{const t=e.points;return t[0].clone().sub(t[1]).normalize()},scaleHelper:{enable:!0,positions:()=>{const t=e.points,i=t[0].clone().lerp(t[3],.5),r=t[1].clone().lerp(t[2],.5),s=t[0].clone().lerp(t[1],.5),o=t[3].clone().lerp(t[2],.5);return[{id:"left",handlePosition:i,basePosition:r},{id:"right",handlePosition:r,basePosition:i},{id:"top",handlePosition:s,basePosition:o},{id:"bottom",handlePosition:o,basePosition:s}]},scaleCallback:t=>{const{intersectPoint:i,scalePosition:r}=t,{id:s,basePosition:o}=r,a=i.clone().sub(o),l=e.points;s==="top"?e.setPoints([l[3].clone().add(a),l[2].clone().add(a),l[2],l[3]]):s==="bottom"?e.setPoints([l[0],l[1],l[1].clone().add(a),l[0].clone().add(a)]):s==="left"?e.setPoints([l[1].clone().add(a),l[1],l[2],l[2].clone().add(a)]):s==="right"&&e.setPoints([l[0],l[0].clone().add(a),l[3].clone().add(a),l[3]])}}}))}};var bb=Object.defineProperty,wb=(n,e,t)=>e in n?bb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,rc=(n,e,t)=>(wb(n,typeof e!="symbol"?e+"":e,t),t);let Pb=class extends ze{constructor(e){if(super(),rc(this,"name","RectangleGeometry"),rc(this,"points"),e.length!==4){console.error("Invalid number of points, it's not a rectangle");return}this.points=e.slice(0,4),this.setAttribute("position",new Ve(new Float32Array(this.points.flatMap(t=>t.toArray())),3)),this.setIndex(new Ve(new Uint16Array([0,1,2,0,2,3]),1))}};var Ab=Object.defineProperty,xb=(n,e,t)=>e in n?Ab(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ob=(n,e,t)=>(xb(n,typeof e!="symbol"?e+"":e,t),t);let Dh=class extends ca{constructor(e){super(e),Ob(this,"name","RectangleMesh")}get color(){return this.meshFont.material.color}setPoints(e){const t=e.map(he).filter(xe);if(t.length<3){console.error("Invalid position");return}if(e.length===3){const[i,r,s]=t,o=i.clone().add(s).sub(r);t.push(o)}this.points=t,this.geometry=new Pb(t),this.planeHelperNeedUpdate=!0,this.geometryInfoNeedUpdate=!0}};var jb=Object.defineProperty,Cr=Object.getOwnPropertySymbols,Sh=Object.prototype.hasOwnProperty,kh=Object.prototype.propertyIsEnumerable,Go=(n,e,t)=>e in n?jb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,sc=(n,e)=>{for(var t in e||(e={}))Sh.call(e,t)&&Go(n,t,e[t]);if(Cr)for(var t of Cr(e))kh.call(e,t)&&Go(n,t,e[t]);return n},Eb=(n,e)=>{var t={};for(var i in n)Sh.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&Cr)for(var i of Cr(n))e.indexOf(i)<0&&kh.call(n,i)&&(t[i]=n[i]);return t},oc=(n,e,t)=>(Go(n,typeof e!="symbol"?e+"":e,t),t);let _o=class extends Dh{constructor(e){const t=e??{},{points:i}=t,r=Eb(t,["points"]);super(),oc(this,"name","RectangleWithEdgeMesh"),oc(this,"line",new ln),i&&this.setPoints(i),r&&this.setStyle(r)}get style(){return sc(sc({},super.style),this.line.style)}get lineWidth(){return this.line.lineWidth}get lineColor(){return this.line.lineColor}setPoints(e){super.setPoints(e),this.points&&(this.line.setPoints([this.points[0],this.points[1],this.points[2],this.points[3],this.points[0]]),this.addIfNotExists(this.line))}setStyle(e){super.setStyle(e),this.line.setStyle(e)}highlight(){super.highlight(),this.line.highlight()}unhighlight(){super.unhighlight(),this.line.unhighlight()}};function zh(n,e){const t=kn(n),i=xi(...n),r=e.clone().sub(i);return t.dot(r)>=0?n:n.slice().reverse()}var Mb=Object.defineProperty,Cb=Object.defineProperties,Ib=Object.getOwnPropertyDescriptors,ac=Object.getOwnPropertySymbols,Db=Object.prototype.hasOwnProperty,Sb=Object.prototype.propertyIsEnumerable,Uo=(n,e,t)=>e in n?Mb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ot=(n,e)=>{for(var t in e||(e={}))Db.call(e,t)&&Uo(n,t,e[t]);if(ac)for(var t of ac(e))Sb.call(e,t)&&Uo(n,t,e[t]);return n},rn=(n,e)=>Cb(n,Ib(e)),qs=(n,e,t)=>(Uo(n,typeof e!="symbol"?e+"":e,t),t),kb=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});class lc extends Mt{constructor(e,t){super(e,t),qs(this,"type","Rectangle"),qs(this,"rectangleMesh"),qs(this,"_editor"),e&&(this.rectangleMesh=new _o(Ot(Ot({},e.style),e)),this.add(this.rectangleMesh))}get editor(){return this._editor||(this._editor=new yb(this.rectangleMesh)),this._editor}get data(){return rn(Ot({},this.baseData),{points:Qe(this.applyObjectMatrixWorld(this.rectangleMesh.points,this.rectangleMesh)),style:{color:this.rectangleMesh.color.getHex(),opacity:this.rectangleMesh.opacity,lineWidth:this.rectangleMesh.lineWidth,lineColor:this.rectangleMesh.lineColor.getHex()}})}setData(e){e.points&&this.rectangleMesh.setPoints(this.applyObjectReversalMatrixWorld(e.points.map(he),this.rectangleMesh)),this.rectangleMesh.setStyle(e.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var e;(e=this.rectangleMesh)==null||e.highlight()}unhighlight(){var e;(e=this.rectangleMesh)==null||e.unhighlight()}create(e){return kb(this,null,function*(){this.removeChildren();const t=new _o(e);this.rectangleMesh=t,this.add(this.rectangleMesh),yield Lh(this.rectangleMesh,this.pointSelector,e),this.config.defaultAction&&this.editor.enable()})}}function Lh(n,e,t){var i;return((i=t==null?void 0:t.drawMethod)!=null?i:"diagonal")==="diagonal"?Lb(n,e,t):Hb(n,e,t)}function zb(n,e){const t=[];return n.scene.traverse(i=>{var r;if(i.visible&&!((r=e==null?void 0:e.excludes)!=null&&r.includes(i))&&(i instanceof Dh||i instanceof ca)){const s=i.points.map(o=>{const a=new pt(o.x,o.y,o.z,i.normal);return i.style.occlusionVisibility&&(a.IsAlwaysVisible=!0),a});t.push(...s)}}),t}function Lb(n,e,t){var i;const{promise:r,reject:s,resolve:o}=zn(),a=n.parent;if(!a)return s(new Error("No container"));const l=(i=t==null?void 0:t.limit)!=null?i:"none",d=new Rt(rn(Ot({},n.style),{dashed:!0})),f=new Rt(rn(Ot({},n.style),{dashed:!0,lengthEnable:!1})),g=new Rt(rn(Ot({},n.style),{dashed:!1,lengthEnable:!1}));a.add(d,g,f),e.enable();const v=[];let w=new O,x=new O;const M=new Xe,k=()=>{v.push(w.clone()),v.length===1?(l==="xoz"&&M.setFromNormalAndCoplanarPoint(new O(0,1,0),v[0]),l==="none"&&M.setFromNormalAndCoplanarPoint(x,v[0])):v.length===2?l==="y"||l==="xoz"?(B(),o()):g.setPoints([v[0],v[1]]):v.length===3&&(B(),o())},D=C=>{var W,T;if(!(C!=null&&C.raycaster))return;const R=(W=v.at(-1))==null?void 0:W.clone();if(v.length===0){w=C.point.clone(),x=(T=C.face)==null?void 0:T.normal;return}if(v.length===1&&l==="y"){const N=new Ye(new O(0,1,0).add(v[0]),new O(0,-1,0).add(v[0])).closestPointToPoint(C.point,!1,new O);n.setPoints([v[0],N,C.point]);return}if(v.length===1&&l==="xoz"){const N=new Ye(new O(1,0,0).add(v[0]),new O(-1,0,0).add(v[0])),Q=C.raycaster.ray.intersectPlane(M,new O),h=N.closestPointToPoint(Q,!1,new O);n.setPoints([v[0],h,Q]);return}if(v.length===1&&l==="none"){M?(w=C.raycaster.ray.intersectPlane(M,new O),f.setPoints([w,C.point])):w=C.point.clone(),d.setPoints([R,w]);return}if(v.length===2&&l==="none"){a.remove(d);const N=C.raycaster.ray.intersectPlane(M,new O),Q=v[0].distanceTo(v[1])/2,h=new O().lerpVectors(v[0],v[1],.5),u=new O().subVectors(N,h).normalize();w=new O().addVectors(h,u.multiplyScalar(Q));const p=[v[0],w,v[1]],y=zh(p,pe.modules.five.camera.position);n.setPoints(y);return}},B=()=>{e.off("select",k),e.off("intersectionUpdate",D),e.off("disable",S),e.disable(),a==null||a.remove(d,g,f)},S=()=>{B(),a==null||a.remove(n),s(new Error("Cancelled"))};return e.on("select",k),e.on("intersectionUpdate",D),e.on("disable",S),r}function Hb(n,e,t){var i;const{promise:r,reject:s,resolve:o}=zn(),a=n.parent;if(!a)return s(new Error("No container"));const l=(i=t==null?void 0:t.limit)!=null?i:"none",d=new Rt(rn(Ot({},n.style),{dashed:!0})),f=new Rt(rn(Ot({},n.style),{dashed:!0,lengthEnable:!1})),g=new Rt(rn(Ot({},n.style),{dashed:!1,lengthEnable:!1}));a.add(d,g,f),e.enable(),e.setAdherePoints(zb(e.five,{excludes:[n]}));const v=[];let w=new O,x=new O;const M=new Xe,k=()=>{if(v.push(w.clone()),v.length===1)e.planeMode="onlyPlane",l==="y"&&(e.adhereLine=[new Ye(v[0],new O(0,1,0).add(v[0]))]),l==="xoz"&&(M.setFromNormalAndCoplanarPoint(new O(0,1,0),v[0]),e.plane=M),l==="none"&&(M.setFromNormalAndCoplanarPoint(x,v[0]),e.plane=M);else if(v.length===2){e.planeMode="vertical",l==="y"&&(e.adhereLine=[]);let C=!1;v[0].x===v[1].x&&v[0].z===v[1].z&&(C=!0),l==="y"&&!C&&(M.setFromCoplanarPoints(v[0],v[1],new O(0,1,0).add(v[0])),e.plane=M),g.setPoints([v[0],v[1]])}else v.length===3&&(B(),o())},D=C=>{var W,T,R,N;if(!C||!(C!=null&&C.raycaster))return;const Q=(W=v.at(-1))==null?void 0:W.clone();if(v.length===0){w=C.point.clone(),x=(T=C.face)==null?void 0:T.normal;return}if(v.length===1){w=C.point,f.setPoints([(R=C.originalPoint)!=null?R:C.point,C.point]),d.setPoints([Q,w]);return}if(v.length===2){if(!e.plane){const y=kn([v[0],v[1],C.point]);M.setFromNormalAndCoplanarPoint(y,v[0])}f.setPoints([(N=C.originalPoint)!=null?N:C.point,C.point]);const h=new O().crossVectors(v[0].clone().sub(v[1]),M.normal).normalize();w=new Ye(v[1].clone().add(h),v[1].clone().sub(h)).closestPointToPoint(C.point,!1,new O);const u=[v[0],v[1],w],p=zh(u,pe.modules.five.camera.position);n.setPoints(p);return}},B=()=>{e.setAdherePoints([]),e.adhereLine=[],e.adherePlane=[],e.plane=void 0,e.off("select",k),e.off("intersectionUpdate",D),e.off("disable",S),e.disable(),a==null||a.remove(d,g,f)},S=()=>{B(),a==null||a.remove(n),s(new Error("Cancelled"))};return e.on("select",k),e.on("intersectionUpdate",D),e.on("disable",S),r}class Tb extends Ii{constructor(e){super(e,()=>({yAxis:()=>e.normal}))}}function Hh(n){return Math.max(32,Math.min(128,Math.floor(n*40)))}var Bb=Object.defineProperty,Rb=(n,e,t)=>e in n?Bb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Js=(n,e,t)=>(Rb(n,typeof e!="symbol"?e+"":e,t),t);class Fb extends Tr{constructor(e){super(e),Js(this,"_normal"),Js(this,"_center"),Js(this,"_radius"),e!=null&&e.center&&e!=null&&e.normal&&e!=null&&e.radius&&this.setPoints(e)}get center(){return this.position.clone()}get normal(){return this._normal}set normal(e){this._normal=e}get radius(){var e,t;return(t=(e=this.meshFont.geometry)==null?void 0:e.parameters)==null?void 0:t.radius}setPoints(e){var t,i,r;if(this._center=(t=he(e.center))!=null?t:this._center,this._normal=((i=he(e.normal))!=null?i:this._normal).normalize(),this._radius=(r=e.radius)!=null?r:this._radius,xe(this._radius)&&this._radius!==this.radius){const s=Hh(this._radius);this.geometry=new en(this._radius,s)}this._center&&this.position.copy(this._center),this._normal&&(this.lookAt(this._normal.clone().add(this._center)),this.normal=this._normal.clone()),this.needsRender=!0}}var Nb=Object.defineProperty,cc=Object.getOwnPropertySymbols,Wb=Object.prototype.hasOwnProperty,Xb=Object.prototype.propertyIsEnumerable,Qb=(n,e,t)=>e in n?Nb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$b=(n,e)=>{var t={};for(var i in n)Wb.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&cc)for(var i of cc(n))e.indexOf(i)<0&&Xb.call(n,i)&&(t[i]=n[i]);return t},Gb=(n,e,t)=>(Qb(n,typeof e!="symbol"?e+"":e,t),t);let Ir=class extends Fb{constructor(e){const t=e??{},{normal:i,radius:r,center:s}=t,o=$b(t,["normal","radius","center"]);super(o),Gb(this,"edgeLine"),this.edgeLine=new ft(o),this.add(this.edgeLine),i&&r&&s&&this.setPoints({normal:i,radius:r,center:s})}setPoints(...e){super.setPoints(...e);const t=this.meshFont.geometry.vertices.slice(1);this.edgeLine.setPoints(t.concat(t[0]))}setStyle(e){super.setStyle(e),this.edgeLine.setStyle(e)}highlight(){super.highlight(),this.edgeLine.highlight()}unhighlight(){super.unhighlight(),this.edgeLine.unhighlight()}};var _b=Object.defineProperty,Ub=Object.defineProperties,Vb=Object.getOwnPropertyDescriptors,hc=Object.getOwnPropertySymbols,Yb=Object.prototype.hasOwnProperty,qb=Object.prototype.propertyIsEnumerable,Vo=(n,e,t)=>e in n?_b(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Zs=(n,e)=>{for(var t in e||(e={}))Yb.call(e,t)&&Vo(n,t,e[t]);if(hc)for(var t of hc(e))qb.call(e,t)&&Vo(n,t,e[t]);return n},Jb=(n,e)=>Ub(n,Vb(e)),Ks=(n,e,t)=>(Vo(n,typeof e!="symbol"?e+"":e,t),t),Zb=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});let uc=class extends Mt{constructor(e,t){super(e,t),Ks(this,"type","Circle"),Ks(this,"circleMesh"),Ks(this,"_editor"),e&&(this.circleMesh=new Ir(Zs(Zs({},e.style),e)),this.add(this.circleMesh))}get editor(){return this._editor||(this._editor=new Tb(this.circleMesh)),this._editor}get data(){return Jb(Zs({},this.baseData),{center:Qe(this.applyObjectMatrixWorld(this.circleMesh.center,this.circleMesh)),normal:Qe(this.circleMesh.normal.clone().applyQuaternion(this.circleMesh.quaternion)),radius:this.circleMesh.radius,style:{color:this.circleMesh.color.getHex()}})}setData(e){this.circleMesh.setPoints({center:e.center?this.applyObjectReversalMatrixWorld(he(e.center),this.circleMesh):void 0,normal:e.normal?he(e.normal):void 0,radius:e.radius}),this.circleMesh.setStyle(e.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var e;(e=this.circleMesh)==null||e.highlight()}unhighlight(){var e;(e=this.circleMesh)==null||e.unhighlight()}create(e){return Zb(this,null,function*(){this.children.forEach(i=>{i.parent===this&&this.remove(i)}),this.children.length=0;const t=new Ir(e);this.circleMesh=t,this.add(this.circleMesh),yield Th(this.circleMesh,this.pointSelector),this.config.defaultAction&&this.editor.enable()})}};function Th(n,e){return new Promise((t,i)=>{const r=n.parent;if(!r){i(new Error("No container"));return}const s=new ln({dashed:!0});r.add(s),e.enable();let o,a;const l=v=>{if(v){if(!o){o={point:v.point,normal:v.face.normal};return}o&&a&&(f(),t())}},d=v=>{if(!v||!o)return;const w=new Xe().setFromNormalAndCoplanarPoint(o.normal,o.point);if(a=v.raycaster.ray.intersectPlane(w,new O),a){const x=o.point.distanceTo(a);n.setPoints({center:o.point,normal:o.normal,radius:x})}},f=()=>{e.off("select",l),e.off("intersectionUpdate",d),e.off("disable",g),e.disable(),r==null||r.remove(s)},g=()=>{f(),r==null||r.remove(n,s),i(new Error("Cancelled"))};e.on("select",l),e.on("intersectionUpdate",d),e.on("disable",g)})}var Kb=Object.defineProperty,dc=Object.getOwnPropertySymbols,e0=Object.prototype.hasOwnProperty,t0=Object.prototype.propertyIsEnumerable,Yo=(n,e,t)=>e in n?Kb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pc=(n,e)=>{for(var t in e||(e={}))e0.call(e,t)&&Yo(n,t,e[t]);if(dc)for(var t of dc(e))t0.call(e,t)&&Yo(n,t,e[t]);return n},Ht=(n,e,t)=>(Yo(n,typeof e!="symbol"?e+"":e,t),t);class fc extends Et{constructor(e){super(),Ht(this,"bottomCircle"),Ht(this,"topCircle"),Ht(this,"edgeMesh"),Ht(this,"highlighted",!1),Ht(this,"params"),Ht(this,"_topCenter"),Ht(this,"_bottomCenter"),Ht(this,"_radius"),this.params=e,this.bottomCircle=new Ir(e),this.bottomCircle.name="bottomCircle",this.topCircle=new Ir(e),this.topCircle.name="topCircle",this.edgeMesh=new Tr(e),e!=null&&e.bottomCenter&&e!=null&&e.topCenter&&e!=null&&e.radius&&this.setPoints(e),this.addIfNotExists(this.bottomCircle)}get bottomCenter(){return this.bottomCircle.center}get topCenter(){return this.topCircle.center}get normal(){return this.bottomCircle.normal}get radius(){return this.bottomCircle.radius}get color(){return this.bottomCircle.color}setPoints(e){var t,i;if(this._topCenter=(t=he(e.topCenter))!=null?t:this.topCenter,this._bottomCenter=(i=he(e.bottomCenter))!=null?i:this.bottomCenter,this._radius=xe(e.radius)?e.radius:this.radius,this._topCenter&&this._bottomCenter){const r=this._topCenter.clone().sub(this._bottomCenter).normalize();this.bottomCircle.setPoints({center:this._bottomCenter,normal:r,radius:this._radius}),this.setTopCenter(this._topCenter)}this.needsRender=!0}setTopCenter(e){this.addIfNotExists(this.topCircle),this.topCircle.setPoints({center:e,normal:this.normal,radius:this.radius}),this.setEdgeMesh()}setBottomCenter(e){this.addIfNotExists(this.bottomCircle),this.bottomCircle.setPoints({center:e,normal:this.normal,radius:this.radius}),this.setEdgeMesh()}setStyle(e){this.params=pc(pc({},this.params),e),this.bottomCircle.setStyle(this.params),this.topCircle.setStyle(this.params)}highlight(){this.highlighted||(this.highlighted=!0,this.edgeMesh.highlight(),this.bottomCircle.highlight(),this.topCircle.highlight(),this.needsRender=!0)}unhighlight(){this.highlighted&&(this.highlighted=!1,this.edgeMesh.unhighlight(),this.bottomCircle.unhighlight(),this.topCircle.unhighlight(),this.needsRender=!0)}setEdgeMesh(){this.addIfNotExists(this.edgeMesh);const e=this.topCircle.center,t=this.bottomCircle.center;this.edgeMesh.geometry.dispose(),this.edgeMesh.geometry=new zc(this.radius,this.radius,e.distanceTo(t),Hh(this.radius),1,!0);const i=new re().setFromUnitVectors(new O(0,1,0),this.normal.clone().normalize());this.edgeMesh.position.copy(new O().lerpVectors(t,e,.5)),this.edgeMesh.quaternion.copy(i)}}class n0 extends Ii{constructor(e){super(e,()=>{const t=()=>{const i=e.topCenter,r=e.bottomCenter,s=new O().lerpVectors(i,r,.5);return{topCenter:i,bottomCenter:r,boxCenter:s}};return{positionFrom:"boundingBox",yAxis:()=>e.normal,scaleHelper:{enable:!0,positions:()=>{const i=t();return[{id:"top",handlePosition:i.topCenter,basePosition:i.bottomCenter},{id:"bottom",handlePosition:i.bottomCenter,basePosition:i.topCenter}]},scaleCallback:i=>{const{intersectPoint:r,scalePosition:s}=i,{id:o}=s;o==="top"?e.setTopCenter(r):o==="bottom"&&e.setBottomCenter(r)}}}})}}var i0=Object.defineProperty,r0=Object.defineProperties,s0=Object.getOwnPropertyDescriptors,vc=Object.getOwnPropertySymbols,o0=Object.prototype.hasOwnProperty,a0=Object.prototype.propertyIsEnumerable,qo=(n,e,t)=>e in n?i0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,eo=(n,e)=>{for(var t in e||(e={}))o0.call(e,t)&&qo(n,t,e[t]);if(vc)for(var t of vc(e))a0.call(e,t)&&qo(n,t,e[t]);return n},l0=(n,e)=>r0(n,s0(e)),to=(n,e,t)=>(qo(n,typeof e!="symbol"?e+"":e,t),t),Bh=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});class gc extends Mt{constructor(e,t){super(e,t),to(this,"type","Cylinder"),to(this,"cylinderMesh"),to(this,"_editor"),e&&(this.cylinderMesh=new fc(eo(eo({},e.style),e)),this.add(this.cylinderMesh))}get editor(){return this._editor||(this._editor=new n0(this.cylinderMesh)),this._editor}get data(){return l0(eo({},this.baseData),{bottomCenter:Qe(this.applyObjectMatrixWorld(this.cylinderMesh.bottomCenter,this.cylinderMesh)),topCenter:Qe(this.applyObjectMatrixWorld(this.cylinderMesh.topCenter,this.cylinderMesh)),radius:this.cylinderMesh.radius,style:{color:this.cylinderMesh.color.getHex()}})}setData(e){this.cylinderMesh.setPoints({bottomCenter:e.bottomCenter?this.applyObjectReversalMatrixWorld(he(e.bottomCenter),this.cylinderMesh):void 0,topCenter:e.topCenter?this.applyObjectReversalMatrixWorld(he(e.topCenter),this.cylinderMesh):void 0}),this.cylinderMesh.setStyle(e.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var e;(e=this.cylinderMesh)==null||e.highlight()}unhighlight(){var e;(e=this.cylinderMesh)==null||e.unhighlight()}create(e){return Bh(this,null,function*(){this.cylinderMesh=new fc(e),this.add(this.cylinderMesh),yield c0(this.cylinderMesh,this.pointSelector),this.config.defaultAction&&this.editor.enable()})}}function c0(n,e){return Bh(this,null,function*(){const t=n.parent;yield Th(n.bottomCircle,e);const i=new ft;i.name="LineHelper",t.add(i);const r=e.position.point,s=n.normal.clone().normalize(),o=r.clone().add(s.clone().multiplyScalar(100)),a=r.clone().sub(s.clone().multiplyScalar(100));return i.setPoints([o,a]),e.enable(),new Promise((l,d)=>{const f=x=>{v(),l()},g=x=>{if(!(x!=null&&x.raycaster))return;const M=Ft({raycaster:x.raycaster,line:new Ye(o,a)}),k=new Xe().setFromNormalAndCoplanarPoint(n.normal,n.bottomCenter).projectPoint(M,new O),D=M.clone().sub(k),B=n.bottomCenter.clone().add(D);M&&n.setTopCenter(B)},v=()=>{e.off("select",f),e.off("intersectionUpdate",g),e.off("disable",w),t.remove(i),e.disable()},w=()=>{v(),t.remove(n),d(new Error("Cancelled"))};e.on("select",f),e.on("intersectionUpdate",g),e.on("disable",w)})})}class h0 extends Ii{constructor(e){super(e,()=>({positionFrom:()=>e.worldCenter,yAxis:()=>new O().subVectors(e.topPosition,e.bottomPositions[0]).normalize(),zAxis:()=>new O().subVectors(e.bottomPositions[0],e.bottomPositions[1]).normalize(),scaleHelper:{enable:!0,positions:()=>{const t=e.bottomPositions,i=e.topPosition,r=new O().subVectors(i,t[0]),s=new O().subVectors(t[1],t[0]),o=new O().subVectors(t[2],t[1]),a=e.geometryInfo.center,l=a.clone().sub(r.clone().divideScalar(2)),d=a.clone().add(r.clone().divideScalar(2)),f=a.clone().sub(s.clone().divideScalar(2)),g=a.clone().add(s.clone().divideScalar(2)),v=a.clone().sub(o.clone().divideScalar(2)),w=a.clone().add(o.clone().divideScalar(2));return[{id:"top",handlePosition:d,basePosition:l},{id:"bottom",handlePosition:l,basePosition:d},{id:"left",handlePosition:f,basePosition:g},{id:"right",handlePosition:g,basePosition:f},{id:"front",handlePosition:v,basePosition:w},{id:"back",handlePosition:w,basePosition:v}]},scaleCallback:t=>{const{intersectPoint:i,scalePosition:r}=t,{id:s,basePosition:o}=r,a=e.bottomPositions,l=e.topPositions;let d=new O().subVectors(e.topPosition,a[0]),f;if(s==="top")d=i.clone().sub(o),f=a;else if(s==="bottom"){const g=i.clone().sub(o);f=l.map(v=>v.clone().add(g)),d=void 0}else if(s==="left"){const g=i.clone().sub(o);f=[a[1].clone().add(g),a[1],a[2],a[2].clone().add(g)]}else if(s==="right"){const g=i.clone().sub(o);f=[a[0],a[0].clone().add(g),a[3].clone().add(g),a[3]]}else if(s==="front"){const g=i.clone().sub(o);f=[a[3].clone().add(g),a[2].clone().add(g),a[2],a[3]]}else if(s==="back"){const g=i.clone().sub(o);f=[a[0],a[1],a[1].clone().add(g),a[0].clone().add(g)]}e.setPoints({points:f,heightPoint:d?f[0].clone().add(d):void 0})}}}))}}var u0=Object.defineProperty,d0=(n,e,t)=>e in n?u0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,p0=(n,e,t)=>(d0(n,typeof e!="symbol"?e+"":e,t),t);let mc=class extends Qo{constructor(){super(...arguments),p0(this,"name","BoxMesh")}get geometryInfo(){if(this.geometryInfoNeedUpdate){this.geometryInfoNeedUpdate=!1;const e=this.bottomPositions,t=this.topPosition;if(!e||e.length<3||!t){this._geometryInfoCache=void 0;return}const i=xi(...e),r=t.clone().sub(e[0]),s=i.clone().add(r.clone().divideScalar(2));this._geometryInfoCache={center:s}}return this._geometryInfoCache}};var f0=Object.defineProperty,v0=Object.defineProperties,g0=Object.getOwnPropertyDescriptors,yc=Object.getOwnPropertySymbols,m0=Object.prototype.hasOwnProperty,y0=Object.prototype.propertyIsEnumerable,Jo=(n,e,t)=>e in n?f0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,no=(n,e)=>{for(var t in e||(e={}))m0.call(e,t)&&Jo(n,t,e[t]);if(yc)for(var t of yc(e))y0.call(e,t)&&Jo(n,t,e[t]);return n},b0=(n,e)=>v0(n,g0(e)),io=(n,e,t)=>(Jo(n,typeof e!="symbol"?e+"":e,t),t),Zo=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});class bc extends Mt{constructor(e,t){super(e,t),io(this,"type","Box"),io(this,"boxMesh"),io(this,"_editor"),e&&(this.boxMesh=new mc(no(no({},e.style),e)),this.add(this.boxMesh))}get editor(){return this._editor||(this._editor=new h0(this.boxMesh)),this._editor}get data(){return b0(no({},this.baseData),{points:Qe(this.applyObjectMatrixWorld(this.boxMesh.bottomPositions,this.boxMesh)),heightPoint:Qe(this.applyObjectMatrixWorld(this.boxMesh.topPosition,this.boxMesh)),style:{color:this.boxMesh.color.getHex(),opacity:this.boxMesh.opacity,lineWidth:this.boxMesh.lineWidth,lineColor:this.boxMesh.lineColor.getHex()}})}setData(e){this.boxMesh.setPoints({points:e.points?this.applyObjectReversalMatrixWorld(e.points.map(he),this.boxMesh):void 0,heightPoint:e.heightPoint?this.applyObjectReversalMatrixWorld(he(e.heightPoint),this.boxMesh):void 0}),this.boxMesh.setStyle(e.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var e;(e=this.boxMesh)==null||e.highlight()}unhighlight(){var e;(e=this.boxMesh)==null||e.unhighlight()}create(e){return Zo(this,null,function*(){this.removeChildren(),this.boxMesh=new mc(e),this.add(this.boxMesh),yield w0(this.boxMesh,this.pointSelector,e),this.config.defaultAction&&this.editor.enable()})}getWorldFacesGeometry(){if(!this.boxMesh)return[];const e=this.applyObjectMatrixWorld(this.boxMesh.bottomPositions,this.boxMesh),t=this.applyObjectMatrixWorld(this.boxMesh.topPositions,this.boxMesh);if(!e||!t||e.length!==4||t.length!==4)return[];const i=[],r=(s,o)=>{const a=new Du(o[0],o[1],o[2]).getNormal(new O),l=xi(...o);i.push({name:s,vertices:o,center:l,normal:a})};r("bottom",[e[0],e[1],e[2],e[3]]),r("top",[t[0],t[1],t[2],t[3]]);for(let s=0;s<4;s++){const o=(s+1)%4;r(`side${s}`,[e[s],e[o],t[o],t[s]])}return i}}function w0(n,e,t){return Zo(this,null,function*(){return new Promise((i,r)=>Zo(this,null,function*(){const s=n.parent;if(!s){r(new Error("No container"));return}const o=new _o(n.style);s.add(o),yield Lh(o,e,t),s.remove(o),n.setPoints({points:o.points});const a=new ft,l=kn(n.bottomPositions),d=xi(...n.bottomPositions),f=d.clone().add(l.clone().multiplyScalar(100)),g=d.clone().sub(l.clone().multiplyScalar(100));a.setPoints([f,g]),s.add(a),e.enable();const v=k=>{x(),i()},w=k=>{if(!(k!=null&&k.raycaster))return;const D=Ft({raycaster:k.raycaster,line:new Ye(f,g)});if(D){const B=D.clone().sub(d);n.setPoints({heightPoint:n.bottomPositions[0].clone().add(B)})}},x=()=>{e.off("select",v),e.off("intersectionUpdate",w),e.off("disable",M),e.disable(),s==null||s.remove(a)},M=()=>{x(),s==null||s.remove(n),r(new Error("Cancelled"))};e.on("select",v),e.on("intersectionUpdate",w),e.on("disable",M)}))})}function P0(n,e){for(let t=n.length-1;t>=0;t--)e(n[t])}var A0=Object.defineProperty,x0=Object.defineProperties,O0=Object.getOwnPropertyDescriptors,wc=Object.getOwnPropertySymbols,j0=Object.prototype.hasOwnProperty,E0=Object.prototype.propertyIsEnumerable,Ko=(n,e,t)=>e in n?A0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pr=(n,e)=>{for(var t in e||(e={}))j0.call(e,t)&&Ko(n,t,e[t]);if(wc)for(var t of wc(e))E0.call(e,t)&&Ko(n,t,e[t]);return n},Rh=(n,e)=>x0(n,O0(e)),lr=(n,e,t)=>(Ko(n,typeof e!="symbol"?e+"":e,t),t),M0=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});class Pc extends Mt{constructor(e,t){super(e,t),lr(this,"type","Line"),lr(this,"lineMesh"),lr(this,"_editor"),lr(this,"creatingObject"),e&&(this.lineMesh=new Po(pr(pr({},e.style),e)),this.add(this.lineMesh))}get editor(){return this._editor||(this._editor=new fy(this)),this._editor}get data(){return Rh(pr({},this.baseData),{points:Qe(this.applyObjectMatrixWorld(this.lineMesh.points)),style:{lineColor:new ie(this.lineMesh.color).getHex(),lineWidth:this.lineMesh.lineWidth,dashed:this.lineMesh.dashed}})}setData(e){e.points&&this.lineMesh.setPoints(e.points),this.lineMesh.setStyle(e.style)}highlight(){var e;(e=this.lineMesh)==null||e.highlight()}unhighlight(){var e;(e=this.lineMesh)==null||e.unhighlight()}canUndo(){var e;(e=this.creatingObject)==null||e.canUndo()}canRedo(){var e;(e=this.creatingObject)==null||e.canRedo()}undo(){var e;(e=this.creatingObject)==null||e.undo()}redo(){var e;(e=this.creatingObject)==null||e.redo()}create(e){return M0(this,null,function*(){this.removeChildren();const t=new Po(e);this.lineMesh=t,this.add(this.lineMesh),this.creatingObject=C0(t,this.pointSelector,e),yield this.creatingObject.finished,this.config.defaultAction&&this.editor.enable()})}}function C0(n,e,t){var i;const r=n.parent;if(!r)return;const{promise:s,resolve:o,reject:a}=zn(),l=(i=t==null?void 0:t.limit)!=null?i:"none",d=new ft(n.style);r.add(d);const f=new ft(Rh(pr({},n.style),{dashed:!0,lengthEnable:!1}));r.add(f),e.enable();const g=[];let v,w,x;const M=[],k=()=>g.length>0,D=()=>M.length>0,B=()=>{k()&&(M.push(g.pop()),n.setPoints(g),W(x),e.pointSelectorHelper.magnifier.render())},S=()=>{D()&&(g.push(M.pop()),n.setPoints(g),W(x),e.pointSelectorHelper.magnifier.render())},C=N=>{if(!N)return;M.length=0;const Q=g.length===0?N.point:v.clone();g.push(Q),n.setPoints(g),g.length===2&&(T(),o())},W=N=>{const Q=()=>{d.setPoints([]),f.setPoints([]),e.pointSelectorHelper.magnifier.render()};if(!(g!=null&&g.length)||!N)return Q();x=N;const h=g.at(-1).clone();l==="none"?(v=N.point,d.setPoints([h,v])):l==="xoz"?(e.plane=w,w=w??new Xe().setFromNormalAndCoplanarPoint(new O(0,1,0),g[0]),v=w.projectPoint(N.point,new O),d.setPoints([h,v]),f.setPoints([v,N.point])):l==="y"&&(N.isVirtual?(v=Ft({raycaster:N.raycaster,line:new Ye(g[0].clone(),new O(0,1,0).add(g[0])),clampToLine:!1}),f.setPoints([])):(v=new Ye(g[0].clone(),new O(0,1,0).add(g[0])).closestPointToPoint(N.point,!1,new O),f.setPoints([v,N.point])),d.setPoints([h,v]))},T=()=>{e.off("select",C),e.off("intersectionUpdate",W),e.off("disable",R),e.plane=null,e.disable(),r==null||r.remove(d,f)},R=()=>{T(),g.length!==2&&(r==null||r.remove(n)),a(new Error("Cancelled"))};return e.on("select",C),e.on("intersectionUpdate",W),e.on("disable",R),{finished:s,canUndo:k,canRedo:D,undo:B,redo:S}}var I0=Object.defineProperty,D0=Object.defineProperties,S0=Object.getOwnPropertyDescriptors,Ac=Object.getOwnPropertySymbols,k0=Object.prototype.hasOwnProperty,z0=Object.prototype.propertyIsEnumerable,ea=(n,e,t)=>e in n?I0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,cr=(n,e)=>{for(var t in e||(e={}))k0.call(e,t)&&ea(n,t,e[t]);if(Ac)for(var t of Ac(e))z0.call(e,t)&&ea(n,t,e[t]);return n},L0=(n,e)=>D0(n,S0(e)),Tt=(n,e,t)=>(ea(n,typeof e!="symbol"?e+"":e,t),t),tt=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});const ci=class extends it{constructor(n,e,t){super(),Tt(this,"group"),Tt(this,"theme"),Tt(this,"config"),Tt(this,"five"),Tt(this,"creatingItem",null),Tt(this,"undo",()=>{var i;(i=this.creatingItem)==null||i.undo(),this.five.needsRender=!0}),Tt(this,"redo",()=>{var i;console.log("redo"),(i=this.creatingItem)==null||i.redo(),this.five.needsRender=!0}),this.five=n,this.theme=e,this.config=cr({magnifier:{width:190,height:190,scale:2,dragEnabled:!0}},t),this.group=new Et,this.group.name="Sculpt",n.scene.add(this.group),ci.modules.init(n,this.config),Ne("ctrl+z, command+z",this.undo),Ne("ctrl+shift+z, command+shift+z",this.redo),ci.modules.fiveDomEvents.addEventListener(this.group,"click",({intersects:i,origDomEvent:r})=>{var s;const o=wh((s=i==null?void 0:i[0])==null?void 0:s.object,a=>a.isSculptObject);return o&&!o.editing?this.emit("click",r,o):!1}),window.__SCULPT_DEBUG__=this,window.__SCULPT_MODULES_DEBUG__=ci.modules}get data(){return{items:this.items.map(n=>{try{return n.data}catch(e){return console.error(e),null}}).filter(xe)}}get items(){return this.group.children}load(n,e){var t;this.clear();const i=(t=n==null?void 0:n.items)==null?void 0:t.map(r=>{var s;const o=L0(cr({},r),{style:cr(cr({},(s=this.theme)==null?void 0:s[r.type.toLowerCase()]),r.style)});return r.type==="Point"?new Yl(o,e):r.type==="line"?new Pc(o,e):r.type==="Polyline"?new Ul(o,e):r.type==="Polygon"?new Kl(o,e):r.type==="Prism"?new ic(o,e):r.type==="Rectangle"?new lc(o,e):r.type==="Circle"?new uc(o,e):r.type==="Cylinder"?new gc(o,e):r.type==="Box"?new bc(o,e):null});this.group.add(...i),this.five.needsRender=!0}getItemById(n){return this.items.find(e=>e.uuid===n)}putObject(n){var e;this.group.add(n);const t=ci.modules.object3DHelper,i=t.addObject3DHelper(n);return(e=i==null?void 0:i.moveController)==null||e.moveByMouse(),t}createPoint(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.point,n[0]),this.createItem(Yl,...n)})}createLine(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.line,n[0]),this.createItem(Pc,...n)})}createline(...n){return tt(this,null,function*(){this.createLine(...n)})}createPolyline(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.polyline,n[0]),this.createItem(Ul,...n)})}createPolygon(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.polygon,n[0]),this.createItem(Kl,...n)})}createPrism(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.prism,n[0]),this.createItem(ic,...n)})}createRectangle(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.rectangle,n[0]),this.createItem(lc,...n)})}createCircle(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.circle,n[0]),this.createItem(uc,...n)})}createCylinder(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.cylinder,n[0]),this.createItem(gc,...n)})}createBox(...n){return tt(this,null,function*(){var e,t;return Object.assign((e=n[0])!=null?e:{},(t=this.theme)==null?void 0:t.box,n[0]),this.createItem(bc,...n)})}canUndo(){var n;return this.creatingItem?(n=this.creatingItem)==null?void 0:n.canUndo():!1}canRedo(){var n;return this.creatingItem?(n=this.creatingItem)==null?void 0:n.canRedo():!1}clear(){P0(this.items,n=>n.delete()),this.five.needsRender=!0}createItem(n,...e){return tt(this,null,function*(){this.creatingItem&&(this.creatingItem.stopCreating(),this.creatingItem=null);const t=new n;this.creatingItem=t,this.group.add(t);const{promise:i,resolve:r,reject:s}=zn();return yield t.create(...e).then((...o)=>(this.creatingItem=null,r(t),o)).catch(o=>{s(o),this.group.remove(t)}),i})}};let pe=ci;Tt(pe,"modules",bh);ku();Su();export{ap as A,W0 as B,B0 as C,zu as D,t1 as E,F0 as F,Wd as G,J0 as H,n1 as I,ht as J,lp as K,b1 as L,lf as Q,ia as R,v1 as T,K0 as _,u1 as a,Z0 as b,Pr as c,Al as d,zn as e,w1 as f,g1 as g,Hc as h,ua as i,p1 as j,Qe as k,kn as l,Y0 as m,d1 as n,rv as o,pp as p,q0 as q,co as r,r1 as s,f1 as t,s1 as u,e1 as v,m1 as w,R0 as x,N0 as y,Hu as z};
